<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>NSSCTFé¢˜è§£ï¼ˆä¸€ï¼‰ | Chemtrails</title><meta name="keywords" content="RSA"><meta name="author" content="Chemtrails"><meta name="copyright" content="Chemtrails"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#f7f9fe"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-title" content="NSSCTFé¢˜è§£ï¼ˆä¸€ï¼‰"><meta name="application-name" content="NSSCTFé¢˜è§£ï¼ˆä¸€ï¼‰"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="default"><link rel="bookmark" href="/img/siteicon/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" sizes="180x180" href="/img/siteicon/apple-touch-icon.png"><link rel="apple-touch-icon" sizes="192x192" href="/img/siteicon/apple-touch-icon.png"><link rel="apple-touch-icon" sizes="512x512" href="/img/siteicon/apple-touch-icon.png"><link rel="apple-touch-startup-image" media="screen and (device-width:320px) and (device-height:568px) and (-webkit-device-pixel-ratio:2) and (orientation:landscape)" href="/img/siteicon/splashIcons/icon_1136x640.png"><link rel="apple-touch-startup-image" media="screen and (device-width:320px) and (device-height:568px) and (-webkit-device-pixel-ratio:2) and (orientation:portrait)" href="/img/siteicon/splashIcons/icon_640x1136.png"><link rel="apple-touch-startup-image" media="screen and (device-width:414px) and (device-height:896px) and (-webkit-device-pixel-ratio:3) and (orientation:landscape)" href="/img/siteicon/splashIcons/icon_2688x1242.png"><link rel="apple-touch-startup-image" media="screen and (device-width:414px) and (device-height:896px) and (-webkit-device-pixel-ratio:2) and (orientation:landscape)" href="/img/siteicon/splashIcons/icon_1792x828.png"><link rel="apple-touch-startup-image" media="screen and (device-width:375px) and (device-height:812px) and (-webkit-device-pixel-ratio:3) and (orientation:portrait)" href="/img/siteicon/splashIcons/icon_1125x2436.png"><link rel="apple-touch-startup-image" media="screen and (device-width:414px) and (device-height:896px) and (-webkit-device-pixel-ratio:2) and (orientation:portrait)" href="/img/siteicon/splashIcons/icon_828x1792.png"><link rel="apple-touch-startup-image" media="screen and (device-width:375px) and (device-height:812px) and (-webkit-device-pixel-ratio:3) and (orientation:landscape)" href="/img/siteicon/splashIcons/icon_2436x1125.png"><link rel="apple-touch-startup-image" media="screen and (device-width:414px) and (device-height:736px) and (-webkit-device-pixel-ratio:3) and (orientation:portrait)" href="/img/siteicon/splashIcons/icon_1242x2208.png"><link rel="apple-touch-startup-image" media="screen and (device-width:414px) and (device-height:736px) and (-webkit-device-pixel-ratio:3) and (orientation:landscape)" href="/img/siteicon/splashIcons/icon_2208x1242.png"><link rel="apple-touch-startup-image" media="screen and (device-width:375px) and (device-height:667px) and (-webkit-device-pixel-ratio:2) and (orientation:landscape)" href="/img/siteicon/splashIcons/icon_1334x750.png"><link rel="apple-touch-startup-image" media="screen and (device-width:375px) and (device-height:667px) and (-webkit-device-pixel-ratio:2) and (orientation:portrait)" href="/img/siteicon/splashIcons/icon_750x1334.png"><link rel="apple-touch-startup-image" media="screen and (device-width:1024px) and (device-height:1366px) and (-webkit-device-pixel-ratio:2) and (orientation:landscape)" href="/img/siteicon/splashIcons/icon_2732x2048.png"><meta name="description" content="å¤ªç®€å•çš„é¢˜å°±ä¸å¾€ä¸Šå‘äº†ï¼Œåªå‘ä¸€äº›æˆ‘è§‰å¾—æœ‰äº›æ„æ€çš„é¢˜ã€‚ WEEK 1[SWPU 2020]happy1234(&amp;#x27;c&#x3D;&amp;#x27;, &amp;#x27;0x7a7e031f14f6b6c3292d11a41161d2491ce8bcdc67ef1baa9eL&amp;#x27;)(&amp;#x27;e&#x3D;&amp;#x27;, &amp;#x27;0x872a335&amp;#x27;)#q + q*p^3 &#x3D;1285367317452">
<meta property="og:type" content="article">
<meta property="og:title" content="NSSCTFé¢˜è§£ï¼ˆä¸€ï¼‰">
<meta property="og:url" content="http://example.com/2023/03/13/NSSCTF%E9%A2%98%E8%A7%A3%EF%BC%88%E4%B8%80%EF%BC%89/index.html">
<meta property="og:site_name" content="Chemtrails">
<meta property="og:description" content="å¤ªç®€å•çš„é¢˜å°±ä¸å¾€ä¸Šå‘äº†ï¼Œåªå‘ä¸€äº›æˆ‘è§‰å¾—æœ‰äº›æ„æ€çš„é¢˜ã€‚ WEEK 1[SWPU 2020]happy1234(&amp;#x27;c&#x3D;&amp;#x27;, &amp;#x27;0x7a7e031f14f6b6c3292d11a41161d2491ce8bcdc67ef1baa9eL&amp;#x27;)(&amp;#x27;e&#x3D;&amp;#x27;, &amp;#x27;0x872a335&amp;#x27;)#q + q*p^3 &#x3D;1285367317452">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://s2.loli.net/2023/03/17/1hDecotwCpH3rT7.png">
<meta property="article:published_time" content="2023-03-13T06:15:44.000Z">
<meta property="article:modified_time" content="2024-04-11T05:34:06.397Z">
<meta property="article:author" content="Chemtrails">
<meta property="article:tag" content="RSA">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://s2.loli.net/2023/03/17/1hDecotwCpH3rT7.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://example.com/2023/03/13/NSSCTF%E9%A2%98%E8%A7%A3%EF%BC%88%E4%B8%80%EF%BC%89/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="google-site-verification" content="xxx"/><meta name="baidu-site-verification" content="code-xxx"/><meta name="msvalidate.01" content="xxx"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://npm.elemecdn.com/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/@fancyapps/ui@4.0.31/dist/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  navMusic: true,
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"languages":{"hits_empty":"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹ï¼š${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"ç¹","msgToSimplifiedChinese":"ç®€"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":330},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶é”™è¯¯',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: 'å¤©',
  date_suffix: {
    just: 'åˆšåˆš',
    min: 'åˆ†é’Ÿå‰',
    hour: 'å°æ—¶å‰',
    day: 'å¤©å‰',
    month: 'ä¸ªæœˆå‰'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"ä½ å·²åˆ‡æ¢ä¸ºç¹ä½“","cht_to_chs":"ä½ å·²åˆ‡æ¢ä¸ºç®€ä½“","day_to_night":"ä½ å·²åˆ‡æ¢ä¸ºæ·±è‰²æ¨¡å¼","night_to_day":"ä½ å·²åˆ‡æ¢ä¸ºæµ…è‰²æ¨¡å¼","bgLight":"#3b70fc","bgDark":"#1f1f1f","position":"top-center"},
  source: {
    justifiedGallery: {
      js: 'https://npm.elemecdn.com/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js',
      css: 'https://npm.elemecdn.com/flickr-justified-gallery@2.1.2/dist/fjGallery.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'NSSCTFé¢˜è§£ï¼ˆä¸€ï¼‰',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-04-11 13:34:06'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#18171d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#f7f9fe')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"></head><body data-type="anzhiyu"><div id="web_bg"></div><div id="an_music_bg"></div><div class="post" id="body-wrap"><header class="not-top-img" id="page-header"><nav id="nav"><span id="blog_name"><a id="site-name" href="/"><div class="title">Chemtrails</div><i class="anzhiyufont anzhiyu-icon-house-chimney"></i></a></span><div class="mask-name-container"><center id="name-container"><a id="page-name" href="javascript:anzhiyu.scrollToDest(0, 500)">PAGE_NAME</a></center></div><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page faa-parent animated-hover" href="javascript:void(0);"><span> æ–‡ç« </span></a><ul class="menus_item_child" style="left:-79px;"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> å½’æ¡£</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> åˆ†ç±»</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> æ ‡ç­¾</span></a></li></ul></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="javascript:void(0);"><span> å‹é“¾</span></a><ul class="menus_item_child" style="left:17px;"><li><a class="site-page child faa-parent animated-hover" href="/link/"><i class="anzhiyufont anzhiyu-icon-link faa-tada" style="font-size: 0.9em;"></i><span> å‹äººå¸</span></a></li></ul></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="javascript:void(0);"><span> å…³äº</span></a><ul class="menus_item_child" style="left:-31px;"><li><a class="site-page child faa-parent animated-hover" href="/essay/"><i class="anzhiyufont anzhiyu-icon-lightbulb faa-tada" style="font-size: 0.9em;"></i><span> é—²è¨€ç¢è¯­</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()"><i class="anzhiyufont anzhiyu-icon-shoe-prints1 faa-tada" style="font-size: 0.9em;"></i><span> éšä¾¿é€›é€›</span></a></li></ul></div></div></div><div id="nav-right"><div class="nav-button" id="randomPost_button"><a class="site-page" onclick="toRandomPost()" title="éšæœºå‰å¾€ä¸€ä¸ªæ–‡ç« " href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-dice"></i></a></div><div class="nav-button" id="search-button"><a class="site-page social-icon search" href="javascript:void(0);" title="æœç´¢ğŸ”"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span> æœç´¢</span></a></div><div class="nav-button" id="darkmode_navswitch"><a class="darkmode_switchbutton" type="button" href="javascript:void(0);" title="æµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬æ¢" onclick="rm.switchDarkMode()"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke" style="font-size: 1.3rem"></i></a></div><div class="nav-button" id="nav-totop"><a class="totopbtn" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i><span id="percent" onclick="anzhiyu.scrollToDest(0,500)">0</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-bars"></i></a></div></div></nav></header><main class="layout" id="content-inner"><div id="post"><div id="post-info"><h1 class="post-title">NSSCTFé¢˜è§£ï¼ˆä¸€ï¼‰</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="anzhiyufont anzhiyu-icon-calendar-days post-meta-icon"></i><span class="post-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2023-03-13T06:15:44.000Z" title="å‘è¡¨äº 2023-03-13 14:15:44">2023-03-13</time><span class="post-meta-separator">|</span><i class="anzhiyufont anzhiyu-icon-history post-meta-icon"></i><span class="post-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2024-04-11T05:34:06.397Z" title="æ›´æ–°äº 2024-04-11 13:34:06">2024-04-11</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/CTF/">CTF</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="anzhiyufont anzhiyu-icon-file-word post-meta-icon"></i><span class="post-meta-label">å­—æ•°æ€»è®¡:</span><span class="word-count">878</span><span class="post-meta-separator">|</span><i class="anzhiyufont anzhiyu-icon-clock post-meta-icon"></i><span class="post-meta-label">é˜…è¯»æ—¶é•¿:</span><span>4åˆ†é’Ÿ</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="NSSCTFé¢˜è§£ï¼ˆä¸€ï¼‰"><i class="anzhiyufont anzhiyu-icon-fw-eye post-meta-icon"></i><span class="post-meta-label">é˜…è¯»é‡:</span><span id="busuanzi_value_page_pv"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-spin"></i></span></span></div></div></div><article class="post-content" id="article-container"><p><em>å¤ªç®€å•çš„é¢˜å°±ä¸å¾€ä¸Šå‘äº†ï¼Œåªå‘ä¸€äº›æˆ‘è§‰å¾—æœ‰äº›æ„æ€çš„é¢˜ã€‚</em></p>
<h1 id="WEEK-1"><a href="#WEEK-1" class="headerlink" title="WEEK 1"></a>WEEK 1</h1><h2 id="SWPU-2020-happy"><a href="#SWPU-2020-happy" class="headerlink" title="[SWPU 2020]happy"></a>[SWPU 2020]happy</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">(<span class="string">&#x27;c=&#x27;</span>, <span class="string">&#x27;0x7a7e031f14f6b6c3292d11a41161d2491ce8bcdc67ef1baa9eL&#x27;</span>)</span><br><span class="line">(<span class="string">&#x27;e=&#x27;</span>, <span class="string">&#x27;0x872a335&#x27;</span>)</span><br><span class="line"><span class="comment">#q + q*p^3 =1285367317452089980789441829580397855321901891350429414413655782431779727560841427444135440068248152908241981758331600586</span></span><br><span class="line"><span class="comment">#qp + q *p^2 = 1109691832903289208389283296592510864729403914873734836011311325874120780079555500202475594</span></span><br></pre></td></tr></table></figure>
<p>ä¸€é“æ•°å­¦é¢˜ã€‚</p>
<p>æå–ä¸¤å¼å…¬å› å¼ï¼š</p>
<script type="math/tex; mode=display">
\begin{cases}q(1+p^3)=x_1\\\\pq(1+p)=x_2\end{cases}</script><p>èƒ½çœ‹å‡ºå­˜åœ¨å…¬å› å­qï¼Œgcdæ±‚ä¸€ä¸‹å…¬å› å­æ”¾è¿›yafué‡Œåˆ†è§£ä¸€ä¸‹ï¼Œå¾—åˆ°å‡ ä¸ªå°å› å­ï¼š</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">P1 = <span class="number">2</span></span><br><span class="line">P1 = <span class="number">3</span></span><br><span class="line">P1 = <span class="number">3</span></span><br><span class="line">P1 = <span class="number">3</span></span><br><span class="line">P29 = <span class="number">21450188030183929729657414367</span></span><br><span class="line">P30 = <span class="number">827089796345539312201480770649</span></span><br></pre></td></tr></table></figure>
<p>é‡Œé¢åº”è¯¥å°±æœ‰ä¸€ä¸ªä¸ºqï¼Œå…¶ä»–çš„å› å­åº”è¯¥æ˜¯å‰©ä¸‹çš„éƒ¨åˆ†å«æœ‰çš„å…¬å› å­ï¼Œå…ˆè¯•ä¸€è¯•å“ªä¸€ä¸ªåå‘ä»£å…¥èƒ½æˆç«‹ï¼ˆ2,3çš„è‚¯å®šå…ˆæ’é™¤äº†ï¼‰ï¼Œè¿™é‡Œæˆ‘é€‰å–çš„æ˜¯æµ‹è¯•x1å¼æ‰€æ±‚pèƒ½å¦è¢«å¼€ä¸‰æ¬¡æ–¹ï¼š</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">q1=<span class="number">21450188030183929729657414367</span></span><br><span class="line">q2=<span class="number">827089796345539312201480770649</span></span><br><span class="line"><span class="built_in">print</span>(gmpy2.iroot((x1//q1-<span class="number">1</span>),<span class="number">3</span>)[<span class="number">1</span>])<span class="comment">#False</span></span><br><span class="line"><span class="built_in">print</span>(gmpy2.iroot((x1//q2-<span class="number">1</span>),<span class="number">3</span>)[<span class="number">1</span>])<span class="comment">#True</span></span><br></pre></td></tr></table></figure>
<p>å¾—åˆ°å› å­ï¼Œè§£å‡ºRSAï¼š</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c=<span class="built_in">int</span>(<span class="string">&#x27;0x7a7e031f14f6b6c3292d11a41161d2491ce8bcdc67ef1baa9e&#x27;</span>,<span class="number">16</span>)</span><br><span class="line">e=<span class="built_in">int</span>(<span class="string">&#x27;0x872a335&#x27;</span>,<span class="number">16</span>)</span><br><span class="line">x1=<span class="number">1285367317452089980789441829580397855321901891350429414413655782431779727560841427444135440068248152908241981758331600586</span></span><br><span class="line">x2=<span class="number">1109691832903289208389283296592510864729403914873734836011311325874120780079555500202475594</span></span><br><span class="line"><span class="built_in">print</span>(gmpy2.gcd(x1,x2))</span><br><span class="line">q1=<span class="number">21450188030183929729657414367</span></span><br><span class="line">q2=<span class="number">827089796345539312201480770649</span></span><br><span class="line"><span class="keyword">if</span> gmpy2.iroot((x1//q2-<span class="number">1</span>),<span class="number">3</span>)[<span class="number">1</span>]==<span class="number">1</span>:</span><br><span class="line">    q=q2</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    q=q1</span><br><span class="line">p=gmpy2.iroot((x1//q2-<span class="number">1</span>),<span class="number">3</span>)[<span class="number">0</span>]</span><br><span class="line">n=p*q</span><br><span class="line">phi=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d=gmpy2.invert(e,phi)</span><br><span class="line">m=<span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>
<h2 id="SWPUCTF-2021-æ–°ç”Ÿèµ›-crypto1"><a href="#SWPUCTF-2021-æ–°ç”Ÿèµ›-crypto1" class="headerlink" title="[SWPUCTF 2021 æ–°ç”Ÿèµ›]crypto1"></a>[SWPUCTF 2021 æ–°ç”Ÿèµ›]crypto1</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">flag  = <span class="string">&#x27;****************************&#x27;</span></span><br><span class="line">flag = &#123;<span class="string">&quot;asfajgfbiagbwe&quot;</span>&#125;</span><br><span class="line">p = getPrime(<span class="number">2048</span>)</span><br><span class="line">q = getPrime(<span class="number">2048</span>)</span><br><span class="line">m1 = bytes_to_long(<span class="built_in">bytes</span>(flag.encode()))</span><br><span class="line"></span><br><span class="line">e1e2 = <span class="number">3087</span></span><br><span class="line">n = p*q</span><br><span class="line"><span class="built_in">print</span>()</span><br><span class="line"></span><br><span class="line">flag1 = <span class="built_in">pow</span>(m1,e1,n)</span><br><span class="line">flag2 = <span class="built_in">pow</span>(m1,e2,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;flag1= &#x27;</span>+<span class="built_in">str</span>(flag1))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;flag2= &#x27;</span>+<span class="built_in">str</span>(flag2))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;n= &#x27;</span>+<span class="built_in">str</span>(n))</span><br><span class="line"></span><br><span class="line"><span class="comment">#flag1= 463634070971821449698012827631572665302589213868521491855038966879005784397309389922926838028598122795187584361359142761652619958273094398420314927073008031088375892957173280915904309949716842152249806486027920136603248454946737961650252641668562626310035983343018705370077783879047584582817271215517599531278507300104564011142229942160380563527291388260832749808727470291331902902518196932928128107067117198707209620169906575791373793854773799564060536121390593687449884988936522369331738199522700261116496965863870682295858957952661531894477603953742494526632841396338388879198270913523572980574440793543571757278020533565628285714358815083303489096524318164071888139412436112963845619981511061231001617406815056986634680975142352197476024575809514978857034477688443230263761729039797859697947454810551009108031457294164840611157524719173343259485881089252938664456637673337362424443150013961181619441267926981848009107466576314685961478748352388452114042115892243272514245081604607798243817586737546663059737344687130881861357423084448027959893402445303299089606081931041217035955143939567456782107203447898345284731038150377722447329202078375870541529539840051415759436083384408203659613313535094343772238691393447475364806171594</span></span><br><span class="line"><span class="comment">#flag2= 130959534275704453216282334815034647265875632781798750901627773826812657339274362406246297925411291822193191483409847323315110393729020700526946712786793380991675008128561863631081095222226285788412970362518398757423705216112313533155390315204875516645459370629706277876211656753247984282379731850770447978537855070379324935282789327428625259945250066774049650951465043700088958965762054418615838049340724639373351248933494355591934236360506778496741051064156771092798005112534162050165095430065000827916096893408569751085550379620558282942254606978819033885539221416335848319082054806148859427713144286777516251724474319613960327799643723278205969253636514684757409059003348229151341200451785288395596484563480261212963114071064979559812327582474674812225260616757099890896900340007990585501470484762752362734968297532533654846190900571017635959385883945858334995884341767905619567505341752047589731815868489295690574109758825021386698440670611361127170896689015108432408490763723594673299472336065575301681055583084547847733168801030191262122130369687497236959760366874106043801542493392227424890925595734150487586757484304609945827925762382889592743709682485229267604771944535469557860120878491329984792448597107256325783346904408</span></span><br><span class="line"><span class="comment">#n= 609305637099654478882754880905638123124918364116173050874864700996165096776233155524277418132679727857702738043786588380577485490575591029930152718828075976000078971987922107645530323356525126496562423491563365836491753476840795804040219013880969539154444387313029522565456897962200817021423704204077133003361140660038327458057898764857872645377236870759691588009666047187685654297678987435769051762120388537868493789773766688347724903911796741124237476823452505450704989455260077833828660552130714794889208291939055406292476845194489525212129635173284301782141617878483740788532998492403101324795726865866661786740345862631916793208037250277376942046905892342213663197755010315060990871143919384283302925469309777769989798197913048813940747488087191697903624669415774198027063997058701217124640082074789591591494106726857376728759663074734040755438623372683762856958888826373151815914621262862750497078245369680378038995425628467728412953392359090775734440671874387905724083226246587924716226512631671786591611586774947156657178654343092123117255372954798131265566301316033414311712092913492774989048057650627801991277862963173961355088082419091848569675686058581383542877982979697235829206442087786927939745804017455244315305118437</span></span><br></pre></td></tr></table></figure>
<p>è¿™åªæ˜¯ä¸€é“å…±æ¨¡æ”»å‡»é¢˜ï¼Œä½†æ˜¯é‡Œé¢åŒ…å«äº†ä¸€ä¸ªä¸€ç›´ä»¥æ¥è¢«æˆ‘å¿½è§†çš„ä¸€ä¸ªé—®é¢˜ï¼Œå¯¼è‡´æˆ‘ä¸€ç›´æ²¡è§£å‡ºæ¥ã€‚</p>
<p>é¢˜ç›®ç»™äº†ä¸¤ä¸ªeçš„ä¹˜ç§¯ï¼Œåˆ†è§£å¾—åˆ°å› å­ä¸º3,3,7,7,7ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠe1æ‰€æœ‰çš„å¯èƒ½ç”¨æ•°ç»„åˆ—å‡ºæ¥ï¼Œç„¶åä¾æ¬¡è¿ç®—çœ‹çœ‹å“ªä¸ªå­˜åœ¨flagï¼š</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">c1= <span class="number">463634070971821449698012827631572665302589213868521491855038966879005784397309389922926838028598122795187584361359142761652619958273094398420314927073008031088375892957173280915904309949716842152249806486027920136603248454946737961650252641668562626310035983343018705370077783879047584582817271215517599531278507300104564011142229942160380563527291388260832749808727470291331902902518196932928128107067117198707209620169906575791373793854773799564060536121390593687449884988936522369331738199522700261116496965863870682295858957952661531894477603953742494526632841396338388879198270913523572980574440793543571757278020533565628285714358815083303489096524318164071888139412436112963845619981511061231001617406815056986634680975142352197476024575809514978857034477688443230263761729039797859697947454810551009108031457294164840611157524719173343259485881089252938664456637673337362424443150013961181619441267926981848009107466576314685961478748352388452114042115892243272514245081604607798243817586737546663059737344687130881861357423084448027959893402445303299089606081931041217035955143939567456782107203447898345284731038150377722447329202078375870541529539840051415759436083384408203659613313535094343772238691393447475364806171594</span></span><br><span class="line">c2= <span class="number">130959534275704453216282334815034647265875632781798750901627773826812657339274362406246297925411291822193191483409847323315110393729020700526946712786793380991675008128561863631081095222226285788412970362518398757423705216112313533155390315204875516645459370629706277876211656753247984282379731850770447978537855070379324935282789327428625259945250066774049650951465043700088958965762054418615838049340724639373351248933494355591934236360506778496741051064156771092798005112534162050165095430065000827916096893408569751085550379620558282942254606978819033885539221416335848319082054806148859427713144286777516251724474319613960327799643723278205969253636514684757409059003348229151341200451785288395596484563480261212963114071064979559812327582474674812225260616757099890896900340007990585501470484762752362734968297532533654846190900571017635959385883945858334995884341767905619567505341752047589731815868489295690574109758825021386698440670611361127170896689015108432408490763723594673299472336065575301681055583084547847733168801030191262122130369687497236959760366874106043801542493392227424890925595734150487586757484304609945827925762382889592743709682485229267604771944535469557860120878491329984792448597107256325783346904408</span></span><br><span class="line">n= <span class="number">609305637099654478882754880905638123124918364116173050874864700996165096776233155524277418132679727857702738043786588380577485490575591029930152718828075976000078971987922107645530323356525126496562423491563365836491753476840795804040219013880969539154444387313029522565456897962200817021423704204077133003361140660038327458057898764857872645377236870759691588009666047187685654297678987435769051762120388537868493789773766688347724903911796741124237476823452505450704989455260077833828660552130714794889208291939055406292476845194489525212129635173284301782141617878483740788532998492403101324795726865866661786740345862631916793208037250277376942046905892342213663197755010315060990871143919384283302925469309777769989798197913048813940747488087191697903624669415774198027063997058701217124640082074789591591494106726857376728759663074734040755438623372683762856958888826373151815914621262862750497078245369680378038995425628467728412953392359090775734440671874387905724083226246587924716226512631671786591611586774947156657178654343092123117255372954798131265566301316033414311712092913492774989048057650627801991277862963173961355088082419091848569675686058581383542877982979697235829206442087786927939745804017455244315305118437</span></span><br><span class="line">e1=[<span class="number">3</span>,<span class="number">7</span>,<span class="number">3</span>*<span class="number">3</span>,<span class="number">3</span>*<span class="number">7</span>,<span class="number">7</span>*<span class="number">7</span>,<span class="number">7</span>*<span class="number">7</span>*<span class="number">3</span>,<span class="number">7</span>*<span class="number">7</span>*<span class="number">7</span>,<span class="number">7</span>*<span class="number">7</span>*<span class="number">7</span>*<span class="number">3</span>,<span class="number">7</span>*<span class="number">7</span>*<span class="number">3</span>*<span class="number">3</span>,<span class="number">3</span>*<span class="number">3</span>*<span class="number">7</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> e1:</span><br><span class="line">    e2=<span class="number">3087</span>//i</span><br><span class="line">    s,s1,s2=gmpy2.gcdext(i,e2)</span><br><span class="line">    m = <span class="built_in">pow</span>(c1,s1,n) * <span class="built_in">pow</span>(c2,s2,n) % n</span><br></pre></td></tr></table></figure>
<p>ä½†æ˜¯ï¼Œæˆ‘è¿™æ ·å°†æ‰€æœ‰çš„ç»“æœè½¬ç å‡ºæ¥åå‘ç°å¹¶æ²¡æœ‰å¾—åˆ°flagã€‚ä¹‹å‰å­¦ä¹ å…±æ¨¡æ”»å‡»æ—¶ï¼Œæœ‰ä¸ªå‰ææ¡ä»¶ä¸ºe1å’Œe2åº”è¯¥æ˜¯äº’ç´ çš„ï¼Œä½†åœ¨è¿™é‡Œæ˜¾ç„¶å¹¶ä¸ä¸€å®šæˆç«‹ã€‚</p>
<p>æˆ‘ä»¬å‡è®¾å¦‚æœä¸¤ä¸ªeæœ‰å…¬å› å­sï¼ŒçŸ¥é“$e_1s_1+e_2s_2=1$ä¸æˆç«‹äº†ï¼Œåº”è¯¥ä¸º$e_1s_1+e_2s_2=s$</p>
<script type="math/tex; mode=display">
c_1\equiv m_1^{e_1}(\bmod n)\ \ c_2\equiv m_2^{e_2}(\bmod n)</script><p>æ¢ç®—ä¸€ä¸‹å¾—åˆ°ï¼š</p>
<script type="math/tex; mode=display">
m^s\equiv m^{e_1s_1+e_2s_2}\equiv c_1^{s_1}c_2^{s_2}(\bmod n)</script><p>å¯è§ï¼Œæˆ‘ä»¬ç”¨è€æ–¹æ³•æ±‚å‡ºçš„må…¶å®æ˜¯mçš„sæ¬¡æ–¹ï¼Œæˆ‘ä»¬éœ€è¦å†è¿›è¡Œå¼€æ ¹å¾—åˆ°flagï¼š</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">c1= <span class="number">463634070971821449698012827631572665302589213868521491855038966879005784397309389922926838028598122795187584361359142761652619958273094398420314927073008031088375892957173280915904309949716842152249806486027920136603248454946737961650252641668562626310035983343018705370077783879047584582817271215517599531278507300104564011142229942160380563527291388260832749808727470291331902902518196932928128107067117198707209620169906575791373793854773799564060536121390593687449884988936522369331738199522700261116496965863870682295858957952661531894477603953742494526632841396338388879198270913523572980574440793543571757278020533565628285714358815083303489096524318164071888139412436112963845619981511061231001617406815056986634680975142352197476024575809514978857034477688443230263761729039797859697947454810551009108031457294164840611157524719173343259485881089252938664456637673337362424443150013961181619441267926981848009107466576314685961478748352388452114042115892243272514245081604607798243817586737546663059737344687130881861357423084448027959893402445303299089606081931041217035955143939567456782107203447898345284731038150377722447329202078375870541529539840051415759436083384408203659613313535094343772238691393447475364806171594</span></span><br><span class="line">c2= <span class="number">130959534275704453216282334815034647265875632781798750901627773826812657339274362406246297925411291822193191483409847323315110393729020700526946712786793380991675008128561863631081095222226285788412970362518398757423705216112313533155390315204875516645459370629706277876211656753247984282379731850770447978537855070379324935282789327428625259945250066774049650951465043700088958965762054418615838049340724639373351248933494355591934236360506778496741051064156771092798005112534162050165095430065000827916096893408569751085550379620558282942254606978819033885539221416335848319082054806148859427713144286777516251724474319613960327799643723278205969253636514684757409059003348229151341200451785288395596484563480261212963114071064979559812327582474674812225260616757099890896900340007990585501470484762752362734968297532533654846190900571017635959385883945858334995884341767905619567505341752047589731815868489295690574109758825021386698440670611361127170896689015108432408490763723594673299472336065575301681055583084547847733168801030191262122130369687497236959760366874106043801542493392227424890925595734150487586757484304609945827925762382889592743709682485229267604771944535469557860120878491329984792448597107256325783346904408</span></span><br><span class="line">n= <span class="number">609305637099654478882754880905638123124918364116173050874864700996165096776233155524277418132679727857702738043786588380577485490575591029930152718828075976000078971987922107645530323356525126496562423491563365836491753476840795804040219013880969539154444387313029522565456897962200817021423704204077133003361140660038327458057898764857872645377236870759691588009666047187685654297678987435769051762120388537868493789773766688347724903911796741124237476823452505450704989455260077833828660552130714794889208291939055406292476845194489525212129635173284301782141617878483740788532998492403101324795726865866661786740345862631916793208037250277376942046905892342213663197755010315060990871143919384283302925469309777769989798197913048813940747488087191697903624669415774198027063997058701217124640082074789591591494106726857376728759663074734040755438623372683762856958888826373151815914621262862750497078245369680378038995425628467728412953392359090775734440671874387905724083226246587924716226512631671786591611586774947156657178654343092123117255372954798131265566301316033414311712092913492774989048057650627801991277862963173961355088082419091848569675686058581383542877982979697235829206442087786927939745804017455244315305118437</span></span><br><span class="line">e1=[<span class="number">3</span>,<span class="number">7</span>,<span class="number">3</span>*<span class="number">3</span>,<span class="number">3</span>*<span class="number">7</span>,<span class="number">7</span>*<span class="number">7</span>,<span class="number">7</span>*<span class="number">7</span>*<span class="number">3</span>,<span class="number">7</span>*<span class="number">7</span>*<span class="number">7</span>,<span class="number">7</span>*<span class="number">7</span>*<span class="number">7</span>*<span class="number">3</span>,<span class="number">7</span>*<span class="number">7</span>*<span class="number">3</span>*<span class="number">3</span>,<span class="number">3</span>*<span class="number">3</span>*<span class="number">7</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> e1:</span><br><span class="line">    e2=<span class="number">3087</span>//i</span><br><span class="line">    s,s1,s2=gmpy2.gcdext(i,e2)</span><br><span class="line">    ms = <span class="built_in">pow</span>(c1,s1,n) * <span class="built_in">pow</span>(c2,s2,n) % n</span><br><span class="line">    m = gmpy2.iroot(ms,s)</span><br><span class="line">    <span class="keyword">if</span> m[<span class="number">1</span>]:</span><br><span class="line">        <span class="built_in">print</span>(long_to_bytes(m[<span class="number">0</span>]))</span><br></pre></td></tr></table></figure>
<h2 id="RoarCTF-2019-RSA"><a href="#RoarCTF-2019-RSA" class="headerlink" title="[RoarCTF 2019]RSA"></a>[RoarCTF 2019]RSA</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">A=(((y%x)**<span class="number">5</span>)%(x%y))**<span class="number">2019</span>+y**<span class="number">316</span>+(y+<span class="number">1</span>)/x</span><br><span class="line">p=next_prime(z*x*y)</span><br><span class="line">q=next_prime(z)</span><br><span class="line">A =  <span class="number">2683349182678714524247469512793476009861014781004924905484127480308161377768192868061561886577048646432382128960881487463427414176114486885830693959404989743229103516924432512724195654425703453612710310587164417035878308390676612592848750287387318129424195208623440294647817367740878211949147526287091298307480502897462279102572556822231669438279317474828479089719046386411971105448723910594710418093977044179949800373224354729179833393219827789389078869290217569511230868967647963089430594258815146362187250855166897553056073744582946148472068334167445499314471518357535261186318756327890016183228412253724</span></span><br><span class="line">n =  <span class="number">117930806043507374325982291823027285148807239117987369609583515353889814856088099671454394340816761242974462268435911765045576377767711593100416932019831889059333166946263184861287975722954992219766493089630810876984781113645362450398009234556085330943125568377741065242183073882558834603430862598066786475299918395341014877416901185392905676043795425126968745185649565106322336954427505104906770493155723995382318346714944184577894150229037758434597242564815299174950147754426950251419204917376517360505024549691723683358170823416757973059354784142601436519500811159036795034676360028928301979780528294114933347127</span></span><br><span class="line">c =  <span class="number">41971850275428383625653350824107291609587853887037624239544762751558838294718672159979929266922528917912189124713273673948051464226519605803745171340724343705832198554680196798623263806617998072496026019940476324971696928551159371970207365741517064295956376809297272541800647747885170905737868568000101029143923792003486793278197051326716680212726111099439262589341050943913401067673851885114314709706016622157285023272496793595281054074260451116213815934843317894898883215362289599366101018081513215120728297131352439066930452281829446586562062242527329672575620261776042653626411730955819001674118193293313612128</span></span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ç»™äº†ä¸€ä¸ªAï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">A=(((y%x)**5)%(x%y))**2019+y**316+(y+1)/x</span><br></pre></td></tr></table></figure>
<p>è§‚å¯Ÿå¯ä»¥å‘ç°xå’Œyåº”è¯¥ä¸ä¼šå¾ˆå¤§ï¼Œå› ä¸ºéœ€è¦æœ‰yçš„316æ¬¡æ–¹ï¼Œxè¿˜ä¸ºy+1çš„å› å­ï¼Œæ‰€ä»¥å…ˆå°è¯•çˆ†ç ´å‡ºxå’Œyï¼š</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">A=<span class="number">2683349182678714524247469512793476009861014781004924905484127480308161377768192868061561886577048646432382128960881487463427414176114486885830693959404989743229103516924432512724195654425703453612710310587164417035878308390676612592848750287387318129424195208623440294647817367740878211949147526287091298307480502897462279102572556822231669438279317474828479089719046386411971105448723910594710418093977044179949800373224354729179833393219827789389078869290217569511230868967647963089430594258815146362187250855166897553056073744582946148472068334167445499314471518357535261186318756327890016183228412253724</span></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>,<span class="number">100</span>):</span><br><span class="line">    <span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>,<span class="number">100</span>):</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">if</span> A==(((y%x)**<span class="number">5</span>)%(x%y))**<span class="number">2019</span>+y**<span class="number">316</span>+(y+<span class="number">1</span>)//x:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&#x27;x=&#x27;</span>,x)<span class="comment">#2</span></span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&#x27;y=&#x27;</span>,y)<span class="comment">#83</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br></pre></td></tr></table></figure>
<p>è¿˜æœ‰ä¸ªzæ±‚ä¸å‡ºæ¥ï¼Œä¸è¿‡xå’Œyå·²çŸ¥ï¼Œå…ˆå¿½ç•¥next_primeï¼Œè¿›è¡Œè®¡ç®—ï¼š</p>
<script type="math/tex; mode=display">
p'q'=zxy\cdot z=z^2xy=166z^2<n</script><script type="math/tex; mode=display">
z<\sqrt\frac n {166}</script><p>æ‰€ä»¥ï¼Œè®¡ç®—$\sqrt\frac n {166}$ï¼Œæ‰€å¾—çš„å€¼åº”è¯¥æ˜¯è¦æ¯”zè¦å¤§ï¼Œç†è®ºä¸Šè®²ä¸ä¼šå¤§å¤ªå¤šã€‚</p>
<p>æˆ‘ä»¬ä»nçš„è§’åº¦æ¥çœ‹ï¼Œå¯ä»¥å°†next_primeé™„åŠ å€¼è®¾ä¸ºæœªçŸ¥æ•°è¿›è¡Œè®¡ç®—ï¼Œæˆ‘ä»¬å·²çŸ¥äº†xyï¼Œä¸Šé¢çš„è®¡ç®—ä½¿å€¼é€¼è¿‘å…¶ä¸­çš„ä¸€ä¸ªå› å­$z+\beta$ï¼š</p>
<script type="math/tex; mode=display">
n=(zxy+\alpha)(z+\beta)=166z^2+(\alpha+\beta) z+\alpha\beta</script><p>åŒæ ·çš„æ–¹æ³•ï¼Œæœ‰ï¼š</p>
<script type="math/tex; mode=display">
\sqrt\frac n {166}=\sqrt{z^2+\frac{\alpha+\beta}{166}z+\frac{\alpha\beta}{166}}</script><script type="math/tex; mode=display">
\sqrt{(z+\beta)^2}=\sqrt{z^2+2\beta z+\beta^2}</script><p>é€šè¿‡æ¯”è¾ƒä¸Šå¼å¯¹åº”ç³»æ•°å’Œç®€å•çš„åˆ†æï¼Œå®é™…çš„å› å­qå€¼åº”è¯¥æ¯”$\sqrt\frac n {166}$çš„å€¼è¦ç¨å¤§ä¸€äº›ï¼Œè¿™æ ·$\sqrt\frac n {166}$å°±å¤¹åœ¨zå’Œå› å­qä¹‹é—´ï¼Œqä¸€å®šæ˜¯$\sqrt\frac n {166}$çš„ä¸‹ä¸€ä¸ªè´¨æ•°ï¼š</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> sympy</span><br><span class="line"></span><br><span class="line">A=<span class="number">2683349182678714524247469512793476009861014781004924905484127480308161377768192868061561886577048646432382128960881487463427414176114486885830693959404989743229103516924432512724195654425703453612710310587164417035878308390676612592848750287387318129424195208623440294647817367740878211949147526287091298307480502897462279102572556822231669438279317474828479089719046386411971105448723910594710418093977044179949800373224354729179833393219827789389078869290217569511230868967647963089430594258815146362187250855166897553056073744582946148472068334167445499314471518357535261186318756327890016183228412253724</span></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>,<span class="number">100</span>):</span><br><span class="line">    <span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>,<span class="number">100</span>):</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">if</span> A==(((y%x)**<span class="number">5</span>)%(x%y))**<span class="number">2019</span>+y**<span class="number">316</span>+(y+<span class="number">1</span>)//x:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&#x27;x=&#x27;</span>,x)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&#x27;y=&#x27;</span>,y)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">n=<span class="number">117930806043507374325982291823027285148807239117987369609583515353889814856088099671454394340816761242974462268435911765045576377767711593100416932019831889059333166946263184861287975722954992219766493089630810876984781113645362450398009234556085330943125568377741065242183073882558834603430862598066786475299918395341014877416901185392905676043795425126968745185649565106322336954427505104906770493155723995382318346714944184577894150229037758434597242564815299174950147754426950251419204917376517360505024549691723683358170823416757973059354784142601436519500811159036795034676360028928301979780528294114933347127</span></span><br><span class="line">c=<span class="number">41971850275428383625653350824107291609587853887037624239544762751558838294718672159979929266922528917912189124713273673948051464226519605803745171340724343705832198554680196798623263806617998072496026019940476324971696928551159371970207365741517064295956376809297272541800647747885170905737868568000101029143923792003486793278197051326716680212726111099439262589341050943913401067673851885114314709706016622157285023272496793595281054074260451116213815934843317894898883215362289599366101018081513215120728297131352439066930452281829446586562062242527329672575620261776042653626411730955819001674118193293313612128</span></span><br><span class="line">nn=n//<span class="number">166</span></span><br><span class="line">q=gmpy2.iroot(nn,<span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line">q=sympy.nextprime(q)</span><br><span class="line"><span class="keyword">if</span> n%q==<span class="number">0</span>:</span><br><span class="line">    p=n//q</span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">d=gmpy2.invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">m=<span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>
<h2 id="CISCN-2021åˆèµ›-rsa"><a href="#CISCN-2021åˆèµ›-rsa" class="headerlink" title="[CISCN 2021åˆèµ›]rsa"></a>[CISCN 2021åˆèµ›]rsa</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> text,flag</span><br><span class="line"><span class="keyword">import</span> md5</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes,bytes_to_long,getPrime</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> md5.new(text).hexdigest() == flag[<span class="number">6</span>:-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">msg1 = text[:xx]</span><br><span class="line">msg2 = text[xx:yy]</span><br><span class="line">msg3 = text[yy:]</span><br><span class="line"></span><br><span class="line">msg1 = bytes_to_long(msg1)<span class="comment">#solved </span></span><br><span class="line">msg2 = bytes_to_long(msg2)</span><br><span class="line">msg3 = bytes_to_long(msg3)<span class="comment">#solved</span></span><br><span class="line"></span><br><span class="line">p1 = getPrime(<span class="number">512</span>)</span><br><span class="line">q1 = getPrime(<span class="number">512</span>)</span><br><span class="line">N1 = p1*q1</span><br><span class="line">e1 = <span class="number">3</span></span><br><span class="line"><span class="built_in">print</span> <span class="built_in">pow</span>(msg1,e1,N1)</span><br><span class="line"><span class="built_in">print</span> (e1,N1)</span><br><span class="line"></span><br><span class="line">p2 = getPrime(<span class="number">512</span>)</span><br><span class="line">q2 = getPrime(<span class="number">512</span>)</span><br><span class="line">N2 = p2*q2</span><br><span class="line">e2 = <span class="number">17</span></span><br><span class="line">e3 = <span class="number">65537</span></span><br><span class="line"><span class="built_in">print</span> <span class="built_in">pow</span>(msg2,e2,N2)</span><br><span class="line"><span class="built_in">print</span> <span class="built_in">pow</span>(msg2,e3,N2)</span><br><span class="line"><span class="built_in">print</span> (e2,N2)</span><br><span class="line"><span class="built_in">print</span> (e3,N2)</span><br><span class="line"></span><br><span class="line">p3 = getPrime(<span class="number">512</span>)</span><br><span class="line">q3 = getPrime(<span class="number">512</span>)</span><br><span class="line">N3 = p3*q3</span><br><span class="line"><span class="built_in">print</span> <span class="built_in">pow</span>(msg3,e3,N3)</span><br><span class="line"><span class="built_in">print</span> (e3,N3)</span><br><span class="line"><span class="built_in">print</span> p3&gt;&gt;<span class="number">200</span></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">19105765285510667553313898813498220212421177527647187802549913914263968945493144633390670605116251064550364704789358830072133349108808799075021540479815182657667763617178044110939458834654922540704196330451979349353031578518479199454480458137984734402248011464467312753683234543319955893</span></span><br><span class="line"><span class="string">(3, 123814470394550598363280518848914546938137731026777975885846733672494493975703069760053867471836249473290828799962586855892685902902050630018312939010564945676699712246249820341712155938398068732866646422826619477180434858148938235662092482058999079105450136181685141895955574548671667320167741641072330259009L)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">54995751387258798791895413216172284653407054079765769704170763023830130981480272943338445245689293729308200574217959018462512790523622252479258419498858307898118907076773470253533344877959508766285730509067829684427375759345623701605997067135659404296663877453758701010726561824951602615501078818914410959610</span></span><br><span class="line"><span class="string">91290935267458356541959327381220067466104890455391103989639822855753797805354139741959957951983943146108552762756444475545250343766798220348240377590112854890482375744876016191773471853704014735936608436210153669829454288199838827646402742554134017280213707222338496271289894681312606239512924842845268366950</span></span><br><span class="line"><span class="string">(17, 111381961169589927896512557754289420474877632607334685306667977794938824018345795836303161492076539375959731633270626091498843936401996648820451019811592594528673182109109991384472979198906744569181673282663323892346854520052840694924830064546269187849702880332522636682366270177489467478933966884097824069977L)</span></span><br><span class="line"><span class="string">(65537, 111381961169589927896512557754289420474877632607334685306667977794938824018345795836303161492076539375959731633270626091498843936401996648820451019811592594528673182109109991384472979198906744569181673282663323892346854520052840694924830064546269187849702880332522636682366270177489467478933966884097824069977L)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">59213696442373765895948702611659756779813897653022080905635545636905434038306468935283962686059037461940227618715695875589055593696352594630107082714757036815875497138523738695066811985036315624927897081153190329636864005133757096991035607918106529151451834369442313673849563635248465014289409374291381429646</span></span><br><span class="line"><span class="string">(65537, 113432930155033263769270712825121761080813952100666693606866355917116416984149165507231925180593860836255402950358327422447359200689537217528547623691586008952619063846801829802637448874451228957635707553980210685985215887107300416969549087293746310593988908287181025770739538992559714587375763131132963783147L)</span></span><br><span class="line"><span class="string">7117286695925472918001071846973900342640107770214858928188419765628151478620236042882657992902</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>åŠ å¯†åˆ†ä¸‰éƒ¨åˆ†ï¼Œå°æ˜æ–‡æ”»å‡»ï¼Œå…±æ¨¡æ”»å‡»å’Œpé«˜ä½æ”»å‡»ï¼Œåˆ†åˆ«å†™è„šæœ¬ï¼š</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">c1=<span class="number">19105765285510667553313898813498220212421177527647187802549913914263968945493144633390670605116251064550364704789358830072133349108808799075021540479815182657667763617178044110939458834654922540704196330451979349353031578518479199454480458137984734402248011464467312753683234543319955893</span></span><br><span class="line">e1=<span class="number">3</span></span><br><span class="line">n1=<span class="number">123814470394550598363280518848914546938137731026777975885846733672494493975703069760053867471836249473290828799962586855892685902902050630018312939010564945676699712246249820341712155938398068732866646422826619477180434858148938235662092482058999079105450136181685141895955574548671667320167741641072330259009</span></span><br><span class="line">m1=long_to_bytes(gmpy2.iroot(c1,e1)[<span class="number">0</span>])</span><br><span class="line"><span class="comment">#b&#x27; \nO wild West Wind, thou breath of Autum&#x27;</span></span><br><span class="line"></span><br><span class="line">cc1=<span class="number">54995751387258798791895413216172284653407054079765769704170763023830130981480272943338445245689293729308200574217959018462512790523622252479258419498858307898118907076773470253533344877959508766285730509067829684427375759345623701605997067135659404296663877453758701010726561824951602615501078818914410959610</span></span><br><span class="line">cc2=<span class="number">91290935267458356541959327381220067466104890455391103989639822855753797805354139741959957951983943146108552762756444475545250343766798220348240377590112854890482375744876016191773471853704014735936608436210153669829454288199838827646402742554134017280213707222338496271289894681312606239512924842845268366950</span></span><br><span class="line">n2=<span class="number">111381961169589927896512557754289420474877632607334685306667977794938824018345795836303161492076539375959731633270626091498843936401996648820451019811592594528673182109109991384472979198906744569181673282663323892346854520052840694924830064546269187849702880332522636682366270177489467478933966884097824069977</span></span><br><span class="line">ee1=<span class="number">17</span></span><br><span class="line">ee2=<span class="number">65537</span></span><br><span class="line">s,s1,s2=gmpy2.gcdext(ee1,ee2)</span><br><span class="line">m2=long_to_bytes((<span class="built_in">pow</span>(cc1,s1,n2)*<span class="built_in">pow</span>(cc2,s2,n2))%n2)</span><br><span class="line"><span class="comment">#b&quot;n&#x27;s being,\nThou, from whose unseen presence the leaves dead\nAre driven, like ghosts from an enchanter fleeing,\nYellow, a&quot;</span></span><br><span class="line"></span><br><span class="line">e3=<span class="number">65537</span></span><br><span class="line">c3=<span class="number">59213696442373765895948702611659756779813897653022080905635545636905434038306468935283962686059037461940227618715695875589055593696352594630107082714757036815875497138523738695066811985036315624927897081153190329636864005133757096991035607918106529151451834369442313673849563635248465014289409374291381429646</span></span><br><span class="line">p3=<span class="number">11437038763581010263116493983733546014403343859218003707512796706928880848035239990740428334091106443982769386517753703890002478698418549777553268906496423</span></span><br><span class="line">n3=<span class="number">113432930155033263769270712825121761080813952100666693606866355917116416984149165507231925180593860836255402950358327422447359200689537217528547623691586008952619063846801829802637448874451228957635707553980210685985215887107300416969549087293746310593988908287181025770739538992559714587375763131132963783147</span></span><br><span class="line">q3=n3//p3</span><br><span class="line">phi=(p3-<span class="number">1</span>)*(q3-<span class="number">1</span>)</span><br><span class="line">d=gmpy2.invert(e3,phi)</span><br><span class="line">m3=long_to_bytes(<span class="built_in">pow</span>(c3,d,n3))</span><br><span class="line"><span class="comment">#nd black, and pale, and hectic red,\nPestilence-stricken multitudes: O thou,\nWho chariotest to their dark wintry bed\n</span></span><br></pre></td></tr></table></figure>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#sage</span></span><br><span class="line">n3=<span class="number">113432930155033263769270712825121761080813952100666693606866355917116416984149165507231925180593860836255402950358327422447359200689537217528547623691586008952619063846801829802637448874451228957635707553980210685985215887107300416969549087293746310593988908287181025770739538992559714587375763131132963783147</span></span><br><span class="line">p3_=<span class="number">7117286695925472918001071846973900342640107770214858928188419765628151478620236042882657992902</span></span><br><span class="line">p3_high=p3_&lt;&lt;<span class="number">200</span></span><br><span class="line">P.&lt;x&gt;=PolynomialRing(Zmod(n3))</span><br><span class="line">f=x+p3_high</span><br><span class="line">x0=f.small_roots(X=<span class="number">2</span>^<span class="number">200</span>,beta=<span class="number">0.4</span>)[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;p=&quot;</span>,p3_high+x0)</span><br></pre></td></tr></table></figure>
<p>flagä¸ºmd5åŠ å¯†çš„textæ–‡æœ¬ï¼Œç›´æ¥ç”¨hashlibåº“åŠ å¯†å³å¯ï¼š</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line">c1=<span class="number">19105765285510667553313898813498220212421177527647187802549913914263968945493144633390670605116251064550364704789358830072133349108808799075021540479815182657667763617178044110939458834654922540704196330451979349353031578518479199454480458137984734402248011464467312753683234543319955893</span></span><br><span class="line">e1=<span class="number">3</span></span><br><span class="line">n1=<span class="number">123814470394550598363280518848914546938137731026777975885846733672494493975703069760053867471836249473290828799962586855892685902902050630018312939010564945676699712246249820341712155938398068732866646422826619477180434858148938235662092482058999079105450136181685141895955574548671667320167741641072330259009</span></span><br><span class="line">m1=long_to_bytes(gmpy2.iroot(c1,e1)[<span class="number">0</span>])</span><br><span class="line"><span class="comment">#b&#x27; \nO wild West Wind, thou breath of Autum&#x27;</span></span><br><span class="line"></span><br><span class="line">cc1=<span class="number">54995751387258798791895413216172284653407054079765769704170763023830130981480272943338445245689293729308200574217959018462512790523622252479258419498858307898118907076773470253533344877959508766285730509067829684427375759345623701605997067135659404296663877453758701010726561824951602615501078818914410959610</span></span><br><span class="line">cc2=<span class="number">91290935267458356541959327381220067466104890455391103989639822855753797805354139741959957951983943146108552762756444475545250343766798220348240377590112854890482375744876016191773471853704014735936608436210153669829454288199838827646402742554134017280213707222338496271289894681312606239512924842845268366950</span></span><br><span class="line">n2=<span class="number">111381961169589927896512557754289420474877632607334685306667977794938824018345795836303161492076539375959731633270626091498843936401996648820451019811592594528673182109109991384472979198906744569181673282663323892346854520052840694924830064546269187849702880332522636682366270177489467478933966884097824069977</span></span><br><span class="line">ee1=<span class="number">17</span></span><br><span class="line">ee2=<span class="number">65537</span></span><br><span class="line">s,s1,s2=gmpy2.gcdext(ee1,ee2)</span><br><span class="line">m2=long_to_bytes((<span class="built_in">pow</span>(cc1,s1,n2)*<span class="built_in">pow</span>(cc2,s2,n2))%n2)</span><br><span class="line"><span class="comment">#b&quot;n&#x27;s being,\nThou, from whose unseen presence the leaves dead\nAre driven, like ghosts from an enchanter fleeing,\nYellow, a&quot;</span></span><br><span class="line"></span><br><span class="line">e3=<span class="number">65537</span></span><br><span class="line">c3=<span class="number">59213696442373765895948702611659756779813897653022080905635545636905434038306468935283962686059037461940227618715695875589055593696352594630107082714757036815875497138523738695066811985036315624927897081153190329636864005133757096991035607918106529151451834369442313673849563635248465014289409374291381429646</span></span><br><span class="line">p3=<span class="number">11437038763581010263116493983733546014403343859218003707512796706928880848035239990740428334091106443982769386517753703890002478698418549777553268906496423</span></span><br><span class="line">n3=<span class="number">113432930155033263769270712825121761080813952100666693606866355917116416984149165507231925180593860836255402950358327422447359200689537217528547623691586008952619063846801829802637448874451228957635707553980210685985215887107300416969549087293746310593988908287181025770739538992559714587375763131132963783147</span></span><br><span class="line">q3=n3//p3</span><br><span class="line">phi=(p3-<span class="number">1</span>)*(q3-<span class="number">1</span>)</span><br><span class="line">d=gmpy2.invert(e3,phi)</span><br><span class="line">m3=long_to_bytes(<span class="built_in">pow</span>(c3,d,n3))</span><br><span class="line"><span class="comment">#nd black, and pale, and hectic red,\nPestilence-stricken multitudes: O thou,\nWho chariotest to their dark wintry bed\n</span></span><br><span class="line"></span><br><span class="line">m=m1+m2+m3</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;NSSCTF&#123;&#x27;</span>+hashlib.md5(m).hexdigest()+<span class="string">&#x27;&#125;&#x27;</span>)</span><br></pre></td></tr></table></figure>
<h2 id="é¹¤åŸæ¯-2021-BabyRSA"><a href="#é¹¤åŸæ¯-2021-BabyRSA" class="headerlink" title="[é¹¤åŸæ¯ 2021]BabyRSA"></a>[é¹¤åŸæ¯ 2021]BabyRSA</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime, bytes_to_long</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">n = p * q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">hint1 = p &gt;&gt; <span class="number">724</span></span><br><span class="line">hint2 = q % (<span class="number">2</span> ** <span class="number">265</span>)</span><br><span class="line">ct = <span class="built_in">pow</span>(bytes_to_long(flag), e, n)</span><br><span class="line"><span class="built_in">print</span>(hint1)</span><br><span class="line"><span class="built_in">print</span>(hint2)</span><br><span class="line"><span class="built_in">print</span>(n)</span><br><span class="line"><span class="built_in">print</span>(ct)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>å­¦é•¿è¯´1024ä½çš„å› å­è¿›è¡Œcoppersmithéœ€è¦è‡³å°‘å·²çŸ¥çº¦572ä½ã€‚</p>
</blockquote>
<p>çœ‹é¢˜ç›®å°±åƒæ˜¯coppersmithé¢˜ï¼ŒçŸ¥é“äº†pçš„é«˜ä½ï¼Œqçš„ä½ä½ï¼ŒçŸ¥é“çš„ä½æ•°å¤ªå°‘ï¼Œæš‚æ—¶ä¸èƒ½ç›´æ¥ç”¨coppersmithï¼Œéœ€è¦ç»§ç»­æ±‚æŸä¸ªå› å­çš„ä½æ•°ï¼Œåœ¨æ¨¡$2^{265}$ä¸‹ï¼š</p>
<script type="math/tex; mode=display">
p_lq_l\equiv n(\bmod 2^{265})</script><p>å¯ä»¥æ±‚å¾—pçš„ä½ä½ï¼š</p>
<script type="math/tex; mode=display">
p_l\equiv nq_l^{-1}(\bmod 2^{265})</script><p>è¿™æ ·ï¼Œæˆ‘ä»¬çŸ¥é“äº†pçš„é«˜ä½å’Œä½ä½ï¼Œä¸­é—´ä½ä¸çŸ¥é“ï¼Œå¯ä»¥ç”¨coppersmithæ±‚ï¼Œè¿™é‡Œå¦‚æœç›´æ¥æ±‚è§£ï¼Œä¼šæŠ¥é”™æ²¡ç»“æœï¼Œè¿™é‡Œå¯ä»¥è®¾ä¸€ä¸ªforå¾ªç¯çˆ†ç ´å‡ ä½å‡ºæ¥ï¼Œå‡å°‘coppersmithè®¡ç®—çš„ä½æ•°ï¼š</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">p_=<span class="number">1514296530850131082973956029074258536069144071110652176122006763622293335057110441067910479</span></span><br><span class="line">q_=<span class="number">40812438243894343296354573724131194431453023461572200856406939246297219541329623</span></span><br><span class="line">n=<span class="number">21815431662065695412834116602474344081782093119269423403335882867255834302242945742413692949886248581138784199165404321893594820375775454774521554409598568793217997859258282700084148322905405227238617443766062207618899209593375881728671746850745598576485323702483634599597393910908142659231071532803602701147251570567032402848145462183405098097523810358199597631612616833723150146418889589492395974359466777040500971885443881359700735149623177757865032984744576285054725506299888069904106805731600019058631951255795316571242969336763938805465676269140733371287244624066632153110685509892188900004952700111937292221969</span></span><br><span class="line">p_h=p_&lt;&lt;<span class="number">724</span></span><br><span class="line">p_l=n*gmpy2.invert(q_,<span class="number">2</span>**<span class="number">265</span>)%<span class="number">2</span>**<span class="number">265</span></span><br><span class="line">p1=p_h+p_l</span><br><span class="line">t=<span class="number">2</span>**<span class="number">265</span></span><br><span class="line">P.&lt;x&gt;=PolynomialRing(Zmod(n))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>):</span><br><span class="line">    f=p1+x*t*<span class="number">64</span>+i*t</span><br><span class="line">    f=f.monic()</span><br><span class="line">    x0=f.small_roots(X=<span class="number">2</span>^<span class="number">453</span>,beta=<span class="number">0.4</span>)</span><br><span class="line">    <span class="keyword">if</span> x0:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="built_in">print</span>(x0,i)</span><br></pre></td></tr></table></figure>
<p>æ³¨æ„pçš„æ„æˆï¼Œæ—¢æœ‰é«˜ä½ä½ä½ï¼Œä¹Ÿæœ‰ä¸­é—´ä½ï¼Œè¿˜è¦ç®—ä¸Šæˆ‘ä»¬çˆ†ç ´çš„iä½ï¼š</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">p_=<span class="number">1514296530850131082973956029074258536069144071110652176122006763622293335057110441067910479</span></span><br><span class="line">q_=<span class="number">40812438243894343296354573724131194431453023461572200856406939246297219541329623</span></span><br><span class="line">n=<span class="number">21815431662065695412834116602474344081782093119269423403335882867255834302242945742413692949886248581138784199165404321893594820375775454774521554409598568793217997859258282700084148322905405227238617443766062207618899209593375881728671746850745598576485323702483634599597393910908142659231071532803602701147251570567032402848145462183405098097523810358199597631612616833723150146418889589492395974359466777040500971885443881359700735149623177757865032984744576285054725506299888069904106805731600019058631951255795316571242969336763938805465676269140733371287244624066632153110685509892188900004952700111937292221969</span></span><br><span class="line">c=<span class="number">19073695285772829730103928222962723784199491145730661021332365516942301513989932980896145664842527253998170902799883262567366661277268801440634319694884564820420852947935710798269700777126717746701065483129644585829522353341718916661536894041337878440111845645200627940640539279744348235772441988748977191513786620459922039153862250137904894008551515928486867493608757307981955335488977402307933930592035163126858060189156114410872337004784951228340994743202032248681976932591575016798640429231399974090325134545852080425047146251781339862753527319093938929691759486362536986249207187765947926921267520150073408188188</span></span><br><span class="line">p_h=p_&lt;&lt;<span class="number">724</span></span><br><span class="line">p_l=n*gmpy2.invert(q_,<span class="number">2</span>**<span class="number">265</span>)%<span class="number">2</span>**<span class="number">265</span></span><br><span class="line">i=<span class="number">19</span></span><br><span class="line">x0=<span class="number">7914249681483699348105896117503653090559709096541336321100288778319519769467957659191305141838207370902177955576606946702942703171837148</span></span><br><span class="line">p=p_h+p_l+(i&lt;&lt;<span class="number">265</span>)+(x0&lt;&lt;<span class="number">271</span>)</span><br><span class="line">q=n//p</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">phi=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d=gmpy2.invert(e,phi)</span><br><span class="line">m=<span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>
<h2 id="é»‘ç›¾æ¯-2020-Factor"><a href="#é»‘ç›¾æ¯-2020-Factor" class="headerlink" title="[é»‘ç›¾æ¯ 2020]Factor"></a>[é»‘ç›¾æ¯ 2020]Factor</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">n = <span class="number">3454083680130687060405946528826790951695785465926614724373</span></span><br><span class="line">e = <span class="number">3</span></span><br><span class="line">c = <span class="number">1347530713288996422676156069761604101177635382955634367208</span></span><br><span class="line">gcd(m, n) = <span class="number">1</span></span><br></pre></td></tr></table></figure>
<p>yafuåˆ†è§£nå¾—åˆ°ä¸‰ä¸ªå› æ•°ï¼Œç›´æ¥æ±‚é€†å…ƒå‘ç°ä¸å­˜åœ¨ï¼Œçœ‹wpå‘ç°å¯ä»¥<strong>æ ¹æ®flagé•¿åº¦è¾ƒå°ï¼Œåªå–ä¸eäº’è´¨çš„å› æ•°ï¼Œå¾—åˆ°æ–°çš„phiå’Œnï¼Œç„¶åæ±‚å¾—m</strong>ã€‚ä»¥å‰æ²¡è§è¿‡è¿™ç§æ–¹æ³•ï¼š</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">n = <span class="number">3454083680130687060405946528826790951695785465926614724373</span></span><br><span class="line">e = <span class="number">3</span></span><br><span class="line">c = <span class="number">1347530713288996422676156069761604101177635382955634367208</span></span><br><span class="line"></span><br><span class="line">p = [<span class="number">17100682436035561357</span>,<span class="number">17172929050033177661</span>,<span class="number">11761833764528579549</span>]</span><br><span class="line"></span><br><span class="line">n,phi=<span class="number">1</span>,<span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> p:</span><br><span class="line">    <span class="keyword">if</span> gmpy2.gcd(e,i-<span class="number">1</span>)==<span class="number">1</span>:</span><br><span class="line">        phi*=(i-<span class="number">1</span>)</span><br><span class="line">        n*=i</span><br><span class="line">d=gmpy2.invert(e,phi)</span><br><span class="line">m=<span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>
<h2 id="æ¹–æ¹˜æ¯-2021-signin"><a href="#æ¹–æ¹˜æ¯-2021-signin" class="headerlink" title="[æ¹–æ¹˜æ¯ 2021]signin"></a>[æ¹–æ¹˜æ¯ 2021]signin</h2><p>é¢˜ç›®ç»™äº†ä¸€ä¸ªè¿åˆ†æ•°çš„tagï¼Œé‚£ä¹ˆè‚¯å®šæ˜¯è·Ÿè¿åˆ†æ•°æœ‰å…³äº†ï¼š</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#sage</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">m1 = bytes_to_long(flag[:<span class="built_in">len</span>(flag) // <span class="number">2</span>])</span><br><span class="line">m2 = bytes_to_long(flag[<span class="built_in">len</span>(flag) // <span class="number">2</span>:])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen</span>(<span class="params">pbits, qbits</span>):</span><br><span class="line">    p1, q1 = getPrime(pbits), getPrime(qbits)</span><br><span class="line">    n1 = p1**<span class="number">4</span>*q1</span><br><span class="line">    q2 = getPrime(qbits)</span><br><span class="line">    bound = p1 // (<span class="number">8</span>*q1*q2) + <span class="number">1</span></span><br><span class="line">    p2 = random.randrange(p1, p1 + bound)</span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">not</span> isPrime(p2):</span><br><span class="line">        p2 = random.randrange(p1, p1 + bound)</span><br><span class="line">    n2 = p2**<span class="number">4</span>*q2</span><br><span class="line">    <span class="keyword">return</span> (n1, n2), (p1, q1), (p2, q2)</span><br><span class="line"></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">pbits = <span class="built_in">int</span>(<span class="number">360</span>)</span><br><span class="line">qbits = <span class="built_in">int</span>(<span class="number">128</span>)</span><br><span class="line">pk, sk1, sk2 = gen(pbits, qbits)</span><br><span class="line">c1 = <span class="built_in">pow</span>(m1, e, pk[<span class="number">0</span>])</span><br><span class="line">c2 = <span class="built_in">pow</span>(m2, e, pk[<span class="number">1</span>])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;pk = <span class="subst">&#123;pk&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c1, c2 = <span class="subst">&#123;c1, c2&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">pk = (1150398070565459492080597718626032792435556703413923483458704675295997646493249759818468321328556510074044954676615760446708253531839417036997811506222349194302791943489195718713797322878586379546657275419261647635859989280700191441312691274285176619391539387875252135478424580680264554294179123254566796890998243909286508189826458854346825493157697201495100628216832191035903848391447704849808577310612723700318670466035077202673373956324725108350230357879374234418393233, 1242678737076048096780023147702514112272319497423818488193557934695583793070332178723043194823444815153743889740338870676093799728875725651036060313223096288606947708155579060628807516053981975820338028456770109640111153719903207363617099371353910243497871090334898522942934052035102902892149792570965804205461900841595290667647854346905445201396273291648968142608158533514391348407631818144116768794595226974831093526512117505486679153727123796834305088741279455621586989)</span></span><br><span class="line"><span class="string">c1, c2 = (361624030197288323178211941746074961985876772079713896964822566468795093475887773853629454653096485450671233584616088768705417987527877166166213574572987732852155320225332020636386698169212072312758052524652761304795529199864805108000796457423822443871436659548626629448170698048984709740274043050729249408577243328282313593461300703078854044587993248807613713896590402657788194264718603549894361488507629356532718775278399264279359256975688280723740017979438505001819438, 33322989148902718763644384246610630825314206644879155585369541624158380990667828419255828083639294898100922608833810585530801931417726134558845725168047585271855248605561256531342703212030641555260907310067120102069499927711242804407691706542428236208695153618955781372741765233319988193384708525251620506966304554054884590718068210659709406626033891748214407992041364462525367373648910810036622684929049996166651416565651803952838857960054689875755131784246099270581394)</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>
<p>è¯»ä»£ç ï¼Œboundä¸ºä¸€ä¸ªä¸åˆ°100ä½çš„æ•°ï¼Œpéƒ½ä¸º360ä½çš„å¤§æ•°ï¼Œé‚£ä¹ˆp2è¿™ä¸ªéšæœºæ•°ç”Ÿæˆä¹Ÿå°±æ¯”p1ç¨å¾®å¤§ä¸€ç‚¹ç‚¹ã€‚å…ˆå¯»æ‰¾å¯ä»¥ä½¿ç”¨è¿åˆ†æ•°æ”»å‡»çš„ç›®æ ‡ï¼š</p>
<script type="math/tex; mode=display">
\frac{n_1}{n_2}=(\frac{p_1}{p_2})^4\frac{q_1}{q_2}</script><p>p1å’Œp2éå¸¸æ¥è¿‘ï¼Œé‚£ä¹ˆ$(\frac{p_1}{p_2})^4$æ¥è¿‘1ï¼Œé‚£ä¹ˆn1å’Œn2çš„æ¯”å€¼ä¸q1å’Œq2çš„æ¯”å€¼å¾ˆæ¥è¿‘ï¼Œ$\frac{q_1}{q_2}$å¤§äº$\frac{n_1}{n_2}$ä¸”å°äº1ï¼Œå¯ä»¥è¿›è¡Œè¿åˆ†æ•°æ”»å‡»æ‰¾åˆ°q1å’Œq2ã€‚</p>
<p>æ”¹æ”¹ä¹‹å‰ç”¨è¿‡çš„ç»´çº³æ”»å‡»è„šæœ¬å°±å¥½äº†ï¼š</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">f2c</span>(<span class="params">p,q</span>):<span class="comment">#åˆ†æ•°è½¬è¿åˆ†æ•°</span></span><br><span class="line"> a=[]</span><br><span class="line"> <span class="keyword">while</span> q:</span><br><span class="line">  a.append(p//q)</span><br><span class="line">  p,q=q,p%q</span><br><span class="line"> <span class="keyword">return</span> a</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">c2f</span>(<span class="params">a</span>):<span class="comment">#è¿åˆ†æ•°è½¬åˆ†æ•°</span></span><br><span class="line">  x,y=<span class="number">1</span>,<span class="number">0</span><span class="comment">#xä¸ºåˆ†å­yä¸ºåˆ†æ¯</span></span><br><span class="line">  <span class="keyword">for</span> a <span class="keyword">in</span> a[::-<span class="number">1</span>]:<span class="comment">#é€†åºç´¯åŠ </span></span><br><span class="line">    x,y=a*x+y,x</span><br><span class="line">  <span class="keyword">return</span> (x,y)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sf</span>(<span class="params">a</span>):<span class="comment">#æ±‚å„é¡¹æ¸è¿›åˆ†æ•°</span></span><br><span class="line"> f=[]</span><br><span class="line"> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="built_in">len</span>(a)):</span><br><span class="line">  f.append(c2f(a[:i]))</span><br><span class="line"> <span class="keyword">return</span> f</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">wiener_attack</span>(<span class="params">n1,n2</span>):</span><br><span class="line"> a=f2c(n1,n2)</span><br><span class="line"> <span class="keyword">for</span> (q1,q2) <span class="keyword">in</span> sf(a):			</span><br><span class="line">        <span class="keyword">if</span> q1!=<span class="number">0</span> <span class="keyword">and</span> q1!=<span class="number">1</span> <span class="keyword">and</span> n1%q1==<span class="number">0</span>:	</span><br><span class="line">            <span class="keyword">return</span> (q1,q2)</span><br><span class="line"></span><br><span class="line">c1, c2 = <span class="number">361624030197288323178211941746074961985876772079713896964822566468795093475887773853629454653096485450671233584616088768705417987527877166166213574572987732852155320225332020636386698169212072312758052524652761304795529199864805108000796457423822443871436659548626629448170698048984709740274043050729249408577243328282313593461300703078854044587993248807613713896590402657788194264718603549894361488507629356532718775278399264279359256975688280723740017979438505001819438</span>, <span class="number">33322989148902718763644384246610630825314206644879155585369541624158380990667828419255828083639294898100922608833810585530801931417726134558845725168047585271855248605561256531342703212030641555260907310067120102069499927711242804407691706542428236208695153618955781372741765233319988193384708525251620506966304554054884590718068210659709406626033891748214407992041364462525367373648910810036622684929049996166651416565651803952838857960054689875755131784246099270581394</span></span><br><span class="line">n1,n2=<span class="number">1150398070565459492080597718626032792435556703413923483458704675295997646493249759818468321328556510074044954676615760446708253531839417036997811506222349194302791943489195718713797322878586379546657275419261647635859989280700191441312691274285176619391539387875252135478424580680264554294179123254566796890998243909286508189826458854346825493157697201495100628216832191035903848391447704849808577310612723700318670466035077202673373956324725108350230357879374234418393233</span>, <span class="number">1242678737076048096780023147702514112272319497423818488193557934695583793070332178723043194823444815153743889740338870676093799728875725651036060313223096288606947708155579060628807516053981975820338028456770109640111153719903207363617099371353910243497871090334898522942934052035102902892149792570965804205461900841595290667647854346905445201396273291648968142608158533514391348407631818144116768794595226974831093526512117505486679153727123796834305088741279455621586989</span></span><br><span class="line">e=<span class="number">0x10001</span></span><br><span class="line">q1,q2=wiener_attack(n1,n2)</span><br><span class="line">p1=gmpy2.iroot(n1//q1,<span class="number">4</span>)[<span class="number">0</span>]</span><br><span class="line">p2=gmpy2.iroot(n2//q2,<span class="number">4</span>)[<span class="number">0</span>]</span><br><span class="line">phi1=p1**<span class="number">3</span>*(p1-<span class="number">1</span>)*(q1-<span class="number">1</span>)</span><br><span class="line">phi2=p2**<span class="number">3</span>*(p2-<span class="number">1</span>)*(q2-<span class="number">1</span>)</span><br><span class="line">d1=gmpy2.invert(e,phi1)</span><br><span class="line">d2=gmpy2.invert(e,phi2)</span><br><span class="line">m1=<span class="built_in">pow</span>(c1,d1,n1)</span><br><span class="line">m2=<span class="built_in">pow</span>(c2,d2,n2)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m1)+long_to_bytes(m2))</span><br></pre></td></tr></table></figure>
<h2 id="é•¿å®‰æ¯-2021-checkin"><a href="#é•¿å®‰æ¯-2021-checkin" class="headerlink" title="[é•¿å®‰æ¯ 2021]checkin"></a>[é•¿å®‰æ¯ 2021]checkin</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">16</span>)</span><br><span class="line">n = p*q</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,p-q):</span><br><span class="line">    m = m*i%n</span><br><span class="line">e = <span class="number">1049</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">pow</span>(<span class="number">2</span>,e,n))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">pow</span>(m,e,n))</span><br><span class="line"></span><br><span class="line"><span class="comment">#4513855932190587780512692251070948513905472536079140708186519998265613363916408288602023081671609336332823271976169443708346965729874135535872958782973382975364993581165018591335971709648749814573285241290480406050308656233944927823668976933579733318618949138978777831374262042028072274386196484449175052332019377</span></span><br><span class="line"><span class="comment">#3303523331971096467930886326777599963627226774247658707743111351666869650815726173155008595010291772118253071226982001526457616278548388482820628617705073304972902604395335278436888382882457685710065067829657299760804647364231959804889954665450340608878490911738748836150745677968305248021749608323124958372559270</span></span><br></pre></td></tr></table></figure>
<p>è¿™é“é¢˜ç”±äºqè¿‡å°ï¼Œå¯ä»¥ç›´æ¥çˆ†ç ´å‡ºqï¼Œè¿›è€Œçˆ†ç ´å‡ºpã€‚</p>
<p>é¢˜ç›®ç»™äº†2çš„eæ¬¡æ–¹åçš„ç»“æœï¼Œå¯ä»¥ç”¨2çš„eæ¬¡æ–¹å‡å»æ¨¡nå€¼å¾—åˆ°knï¼Œç„¶åæ…¢æ…¢çˆ†ç ´pqå³å¯ï¼š</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c=<span class="number">3303523331971096467930886326777599963627226774247658707743111351666869650815726173155008595010291772118253071226982001526457616278548388482820628617705073304972902604395335278436888382882457685710065067829657299760804647364231959804889954665450340608878490911738748836150745677968305248021749608323124958372559270</span></span><br><span class="line">c2=<span class="number">4513855932190587780512692251070948513905472536079140708186519998265613363916408288602023081671609336332823271976169443708346965729874135535872958782973382975364993581165018591335971709648749814573285241290480406050308656233944927823668976933579733318618949138978777831374262042028072274386196484449175052332019377</span></span><br><span class="line">e = <span class="number">1049</span></span><br><span class="line"></span><br><span class="line">kn=<span class="number">2</span>**<span class="number">1049</span>-c2</span><br><span class="line">q=gmpy2.next_prime(<span class="number">2</span>**<span class="number">15</span>)</span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    <span class="keyword">if</span> kn%q==<span class="number">0</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    q=gmpy2.next_prime(q)</span><br><span class="line"></span><br><span class="line">k=<span class="number">2</span></span><br><span class="line">kp=kn//q</span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">  <span class="keyword">if</span> kp%k==<span class="number">0</span>:</span><br><span class="line">     kp=kp//k</span><br><span class="line">     k=<span class="number">2</span></span><br><span class="line">  <span class="keyword">if</span> gmpy2.is_prime(kp):</span><br><span class="line">     p=kp</span><br><span class="line">     <span class="keyword">break</span></span><br><span class="line">  k+=<span class="number">1</span></span><br><span class="line"></span><br><span class="line">n=p*q</span><br></pre></td></tr></table></figure>
<p>è§‚å¯Ÿå¯¹må•ç‹¬è¿›è¡Œçš„åŠ å¯†ï¼Œä»1é˜¶ä¹˜åˆ°p-qï¼Œå•ç‹¬ç®—çš„è¯æ ¹æœ¬ç®—ä¸å‡ºæ¥ï¼Œéœ€è¦è€ƒè™‘åˆ°å¨å°”é€Šå®šç†ã€‚</p>
<p>å¯¹äºè¿™é¢˜ï¼Œæœ‰ï¼š</p>
<script type="math/tex; mode=display">
(p-1)!\equiv -1(\bmod p)</script><script type="math/tex; mode=display">
m(p-q-1)!\equiv M(\bmod n)</script><p>çŒœæµ‹Mé•¿åº¦åº”è¯¥ä¸ä¼šå¤ªé•¿ï¼Œæ—¢ç„¶æ»¡è¶³åœ¨æ¨¡nä¸‹ç›¸ç­‰ï¼Œé‚£ä¹ˆåº”è¯¥ä¹Ÿåœ¨æ¨¡pä¸‹ç›¸ç­‰ï¼Œè¿™æ ·å°±æŠŠä¸¤ä¸ªå¼å­è”ç³»èµ·æ¥äº†ï¼š</p>
<script type="math/tex; mode=display">
m(p-q-1)!\equiv M(\bmod p)</script><p>è¦åšçš„æ˜¯åŒ–ç®€æ‰è¿™ä¸ªé˜¶ä¹˜ï¼Œå’Œå¨å°”é€Šçš„å…¬å¼ç›¸é™¤å¾—ï¼š</p>
<script type="math/tex; mode=display">
\frac{(p-1)!}{m(p-q-1)!}\equiv -\frac 1 M(\bmod p)</script><p>å¾—åˆ°ï¼š</p>
<script type="math/tex; mode=display">
m=-M(p-q)(p-q+1)\cdot\cdot\cdot(p-1)\bmod p</script><p>ç”±äºqä¸æ˜¯å¾ˆå¤§ï¼Œæ‰€ä»¥ç›¸ä¹˜çš„æ•°ä¸æ˜¯å¾ˆå¤šï¼Œèƒ½è®¡ç®—äº†ï¼š</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c=<span class="number">3303523331971096467930886326777599963627226774247658707743111351666869650815726173155008595010291772118253071226982001526457616278548388482820628617705073304972902604395335278436888382882457685710065067829657299760804647364231959804889954665450340608878490911738748836150745677968305248021749608323124958372559270</span></span><br><span class="line">c2=<span class="number">4513855932190587780512692251070948513905472536079140708186519998265613363916408288602023081671609336332823271976169443708346965729874135535872958782973382975364993581165018591335971709648749814573285241290480406050308656233944927823668976933579733318618949138978777831374262042028072274386196484449175052332019377</span></span><br><span class="line">e = <span class="number">1049</span></span><br><span class="line"></span><br><span class="line">kn=<span class="number">2</span>**<span class="number">1049</span>-c2</span><br><span class="line">q=gmpy2.next_prime(<span class="number">2</span>**<span class="number">15</span>)</span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    <span class="keyword">if</span> kn%q==<span class="number">0</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    q=gmpy2.next_prime(q)</span><br><span class="line"></span><br><span class="line">k=<span class="number">2</span></span><br><span class="line">kp=kn//q</span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">  <span class="keyword">if</span> kp%k==<span class="number">0</span>:</span><br><span class="line">     kp=kp//k</span><br><span class="line">     k=<span class="number">2</span></span><br><span class="line">  <span class="keyword">if</span> gmpy2.is_prime(kp):</span><br><span class="line">     p=kp</span><br><span class="line">     <span class="keyword">break</span></span><br><span class="line">  k+=<span class="number">1</span></span><br><span class="line"></span><br><span class="line">n=p*q</span><br><span class="line">phi=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d=gmpy2.invert(e,phi)</span><br><span class="line">m0=<span class="built_in">pow</span>(c,d,n)</span><br><span class="line">mm=<span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(p-q,p):</span><br><span class="line">   mm=mm*i%p</span><br><span class="line">m=(-m0)*mm%p</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>
<h1 id="WEEK-2"><a href="#WEEK-2" class="headerlink" title="WEEK 2"></a>WEEK 2</h1><h2 id="CISCN-2022-è¥¿å—-rsa"><a href="#CISCN-2022-è¥¿å—-rsa" class="headerlink" title="[CISCN 2022 è¥¿å—]rsa"></a>[CISCN 2022 è¥¿å—]rsa</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;XXXXXXXX&#x27;</span></span><br><span class="line">p1 = getPrime(<span class="number">700</span>)</span><br><span class="line">r1 = getPrime(<span class="number">700</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    q1 = <span class="number">5</span>*p1+i</span><br><span class="line">n = p1*q1*r1</span><br><span class="line">p3 = <span class="built_in">pow</span>(p1,<span class="number">3</span>,n)</span><br><span class="line">q3 = <span class="built_in">pow</span>(q1,<span class="number">3</span>,n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(p3)</span><br><span class="line"><span class="built_in">print</span>(q3)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">p3 = 29914513810588158800677413177910972738704129106546850855032986405861482276089830788972187432277517348644647399654780884571794069905291936470934226328931651386658328163535027343107140438177837479649822914209171476632450951930287641742344330471734177295804718555774395704231261550376220154493373703096062950390869299905383682611063374747752091585836452902373843865043412096365874638466683035848817858586173172058756256354758712684819253211761289032789542371351760915771791997388241121078055468403109260493642435791152671979552597191217179672328555740595434990908530985477314228867209314472001848844089467987561661918366232980944933533</span></span><br><span class="line"><span class="string">q3 = 66208618374366130551979192465001581263127328176551695213970812805980115496523825511250542987452691413485117902772315362811067501379171731387904074565035353566976164797769439898266222919741874340315356585585077141595328441423323822407738375537476582506440045835592730211502035261968878999959340204806442390319739977816872969200022096331677277225467021553564212725120939434924481787524609852608476848761521446441776154400518315701988027274150425936061679275540502720782853648148897480117033152064922234451671636288396704170234613549011854618414776342798740690128675106027908639984431432591397555541420243824539205614036979987830125678</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">P = getPrime(<span class="number">1024</span>)</span><br><span class="line">Q = getPrime(<span class="number">1024</span>)</span><br><span class="line">N = P * Q</span><br><span class="line">E = <span class="number">65537</span></span><br><span class="line">lcm = gmpy2.lcm(P-<span class="number">1</span>, Q-<span class="number">1</span>)</span><br><span class="line">e1 = gmpy2.invert(p1, lcm)</span><br><span class="line">e2 = gmpy2.invert(r1, lcm)</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c = <span class="built_in">pow</span>(m, E, N)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(lcm)</span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"><span class="built_in">print</span>(N)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">lcm = 4292158730589770192682795435047249488185453170529228019750042608688907718268448193363838203887391025871515871000364259326343790645215256385842265899206372365402431198699714374850409466996627163968391249416054093529090485677808301343590811445080871279796162536469847469761747058736980603093722710824453312207182881241846080117790728778291633761198069016865260030288832065807438020772711645648333908622890343009942617559434851450007195025869850769670769715654662127278293639938359741401336592219730356884542179574372134014927006215640945952229142436595334916765255426954857520777553915330597952622785359222832224632624</span></span><br><span class="line"><span class="string">c = 4288727484183191191687364666620023549392656794153112764357730676861570386983002380982803054964588111708662498647767438881892355599604826306427809017097724346976778230464708540600157055782723189971534549543664668430013171469625043063261219462210251726207552819381767396148632877168530609902046293626355744288863460554297860696918890189350721960355460410677203131993419723440382095665713164422367291153108363066159712951217816814873413423853338021627653555202253351957999686659021298525147460016557904084617528199284448056532965033560516083489693334373695545423561715471204868795248569806148395196572046378679014697206</span></span><br><span class="line"><span class="string">N  = 17168634922359080770731181740188997952741812682116912079000170434755630873073792773455352815549564103486063484001457037305375162580861025543369063596825489461609724794798857499401637867986508655873564997664216374116361942711233205374363245780323485119184650145879389879046988234947922412374890843297813248828996855478005656041814919367820336728271583686844991928889831691815821365423570311291064846736832327637944358854661523107817781673029406341843040857813841671405147146887291204140157388049394514390098066284975682117038362207142272098796924412602725857521665773622056312191400612944442008222587867782281556388669</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>å¯¹flagçš„åŠ å¯†åœ¨ååŠéƒ¨åˆ†ï¼Œé¢˜ç›®ç»™å‡ºäº†p-1å’Œq-1çš„æœ€å°å…¬å€æ•°ï¼Œç”±äºpqéƒ½ä¸ºè´¨æ•°ï¼Œä¸€å®šæ˜¯å¥‡æ•°ï¼Œp-1å’Œq-1è‚¯å®šä¸ºå¶æ•°ï¼Œæ‰€ä»¥å®ƒä»¬çš„lcmå°±è‚¯å®šä¸æ˜¯ç›¸ä¹˜çš„phiï¼Œä¸è¿‡å¯ä»¥çˆ†ç ´ä¸€ä¸‹æœ€å¤§å…¬å› å­å¾—åˆ°phiï¼Œåæ­£ä½æ•°å·®ä¸å¤šåº”è¯¥å’Œphiå¾ˆæ¥è¿‘ï¼Œçˆ†ç ´å‡ºæ¥ä¹‹åçŸ¥é“nå’Œphiç›´æ¥åˆ†è§£å¾—åˆ°pqï¼Œflagå°±æ±‚å‡ºæ¥äº†ï¼š</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">lcm = <span class="number">4292158730589770192682795435047249488185453170529228019750042608688907718268448193363838203887391025871515871000364259326343790645215256385842265899206372365402431198699714374850409466996627163968391249416054093529090485677808301343590811445080871279796162536469847469761747058736980603093722710824453312207182881241846080117790728778291633761198069016865260030288832065807438020772711645648333908622890343009942617559434851450007195025869850769670769715654662127278293639938359741401336592219730356884542179574372134014927006215640945952229142436595334916765255426954857520777553915330597952622785359222832224632624</span></span><br><span class="line">c = <span class="number">4288727484183191191687364666620023549392656794153112764357730676861570386983002380982803054964588111708662498647767438881892355599604826306427809017097724346976778230464708540600157055782723189971534549543664668430013171469625043063261219462210251726207552819381767396148632877168530609902046293626355744288863460554297860696918890189350721960355460410677203131993419723440382095665713164422367291153108363066159712951217816814873413423853338021627653555202253351957999686659021298525147460016557904084617528199284448056532965033560516083489693334373695545423561715471204868795248569806148395196572046378679014697206</span></span><br><span class="line">N  = <span class="number">17168634922359080770731181740188997952741812682116912079000170434755630873073792773455352815549564103486063484001457037305375162580861025543369063596825489461609724794798857499401637867986508655873564997664216374116361942711233205374363245780323485119184650145879389879046988234947922412374890843297813248828996855478005656041814919367820336728271583686844991928889831691815821365423570311291064846736832327637944358854661523107817781673029406341843040857813841671405147146887291204140157388049394514390098066284975682117038362207142272098796924412602725857521665773622056312191400612944442008222587867782281556388669</span></span><br><span class="line">E = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">solve_p_q</span>(<span class="params">n,phi</span>):</span><br><span class="line">  x=n-phi+<span class="number">1</span>  <span class="comment">#x=p+q=n-p*q+(p+q)-1+1</span></span><br><span class="line">  y=x*x-<span class="number">4</span>*n  <span class="comment">#y=(p-q)^2=(p+q)^2-4n</span></span><br><span class="line">  z=gmpy2.iroot(y,<span class="number">2</span>)[<span class="number">0</span>]  <span class="comment">#z=q-p</span></span><br><span class="line">  q=(x+z)//<span class="number">2</span></span><br><span class="line">  p=(x-z)//<span class="number">2</span></span><br><span class="line">  <span class="keyword">return</span> p,q</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">10000</span>):</span><br><span class="line">    p,q=solve_p_q(N,k*lcm)</span><br><span class="line">    <span class="keyword">if</span> p*q==N:</span><br><span class="line">       <span class="keyword">break</span></span><br><span class="line">phi=k*lcm</span><br><span class="line">d=gmpy2.invert(E,phi)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">pow</span>(c,d,N)))</span><br></pre></td></tr></table></figure>
<p>é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œè¿™é¢˜å‰é¢è¿™ä¹ˆå¤šå¤æ‚æ“ä½œæ˜¯ä¸ºäº†ä»€ä¹ˆå‘¢ï¼Ÿ</p>
<h2 id="HGAME-2022-week1-Easy-RSA"><a href="#HGAME-2022-week1-Easy-RSA" class="headerlink" title="[HGAME 2022 week1]Easy RSA"></a>[HGAME 2022 week1]Easy RSA</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> gcd</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> next_prime</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">c</span>):</span><br><span class="line">    p = getPrime(<span class="number">8</span>)</span><br><span class="line">    q = getPrime(<span class="number">8</span>)</span><br><span class="line">    e = randint(<span class="number">0</span>, p * q)</span><br><span class="line">    <span class="keyword">while</span> gcd(e, (p - <span class="number">1</span>) * (q - <span class="number">1</span>)) != <span class="number">1</span>:</span><br><span class="line">        e = <span class="built_in">int</span>(next_prime(e))</span><br><span class="line">    <span class="keyword">return</span> e, p, q, <span class="built_in">pow</span>(<span class="built_in">ord</span>(c), e, p * q)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">list</span>(<span class="built_in">map</span>(encrypt, flag)))</span><br><span class="line">    <span class="comment"># [(12433, 149, 197, 104), (8147, 131, 167, 6633), (10687, 211, 197, 35594), (19681, 131, 211, 15710), (33577, 251, 211, 38798), (30241, 157, 251, 35973), (293, 211, 157, 31548), (26459, 179, 149, 4778), (27479, 149, 223, 32728), (9029, 223, 137, 20696), (4649, 149, 151, 13418), (11783, 223, 251, 14239), (13537, 179, 137, 11702), (3835, 167, 139, 20051), (30983, 149, 227, 23928), (17581, 157, 131, 5855), (35381, 223, 179, 37774), (2357, 151, 223, 1849), (22649, 211, 229, 7348), (1151, 179, 223, 17982), (8431, 251, 163, 30226), (38501, 193, 211, 30559), (14549, 211, 151, 21143), (24781, 239, 241, 45604), (8051, 179, 131, 7994), (863, 181, 131, 11493), (1117, 239, 157, 12579), (7561, 149, 199, 8960), (19813, 239, 229, 53463), (4943, 131, 157, 14606), (29077, 191, 181, 33446), (18583, 211, 163, 31800), (30643, 173, 191, 27293), (11617, 223, 251, 13448), (19051, 191, 151, 21676), (18367, 179, 157, 14139), (18861, 149, 191, 5139), (9581, 211, 193, 25595)]</span></span><br></pre></td></tr></table></figure>
<p>è¿™é¢˜çš„mapå‡½æ•°ç›¸å½“äºå¯¹flagè¿›è¡Œé€ä¸ªå­—ç¬¦åŠ å¯†äº†ï¼Œå†™ä¸ªå¾ªç¯æŒ¨ä¸ªè§£å³å¯ï¼Œpå’Œqéƒ½ç»™äº†ï¼š</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line"><span class="built_in">list</span>=[(<span class="number">12433</span>, <span class="number">149</span>, <span class="number">197</span>, <span class="number">104</span>), (<span class="number">8147</span>, <span class="number">131</span>, <span class="number">167</span>, <span class="number">6633</span>), (<span class="number">10687</span>, <span class="number">211</span>, <span class="number">197</span>, <span class="number">35594</span>), (<span class="number">19681</span>, <span class="number">131</span>, <span class="number">211</span>, <span class="number">15710</span>), (<span class="number">33577</span>, <span class="number">251</span>, <span class="number">211</span>, <span class="number">38798</span>), (<span class="number">30241</span>, <span class="number">157</span>, <span class="number">251</span>, <span class="number">35973</span>), (<span class="number">293</span>, <span class="number">211</span>, <span class="number">157</span>, <span class="number">31548</span>), (<span class="number">26459</span>, <span class="number">179</span>, <span class="number">149</span>, <span class="number">4778</span>), (<span class="number">27479</span>, <span class="number">149</span>, <span class="number">223</span>, <span class="number">32728</span>), (<span class="number">9029</span>, <span class="number">223</span>, <span class="number">137</span>, <span class="number">20696</span>), (<span class="number">4649</span>, <span class="number">149</span>, <span class="number">151</span>, <span class="number">13418</span>), (<span class="number">11783</span>, <span class="number">223</span>, <span class="number">251</span>, <span class="number">14239</span>), (<span class="number">13537</span>, <span class="number">179</span>, <span class="number">137</span>, <span class="number">11702</span>), (<span class="number">3835</span>, <span class="number">167</span>, <span class="number">139</span>, <span class="number">20051</span>), (<span class="number">30983</span>, <span class="number">149</span>, <span class="number">227</span>, <span class="number">23928</span>), (<span class="number">17581</span>, <span class="number">157</span>, <span class="number">131</span>, <span class="number">5855</span>), (<span class="number">35381</span>, <span class="number">223</span>, <span class="number">179</span>, <span class="number">37774</span>), (<span class="number">2357</span>, <span class="number">151</span>, <span class="number">223</span>, <span class="number">1849</span>), (<span class="number">22649</span>, <span class="number">211</span>, <span class="number">229</span>, <span class="number">7348</span>), (<span class="number">1151</span>, <span class="number">179</span>, <span class="number">223</span>, <span class="number">17982</span>), (<span class="number">8431</span>, <span class="number">251</span>, <span class="number">163</span>, <span class="number">30226</span>), (<span class="number">38501</span>, <span class="number">193</span>, <span class="number">211</span>, <span class="number">30559</span>), (<span class="number">14549</span>, <span class="number">211</span>, <span class="number">151</span>, <span class="number">21143</span>), (<span class="number">24781</span>, <span class="number">239</span>, <span class="number">241</span>, <span class="number">45604</span>), (<span class="number">8051</span>, <span class="number">179</span>, <span class="number">131</span>, <span class="number">7994</span>), (<span class="number">863</span>, <span class="number">181</span>, <span class="number">131</span>, <span class="number">11493</span>), (<span class="number">1117</span>, <span class="number">239</span>, <span class="number">157</span>, <span class="number">12579</span>), (<span class="number">7561</span>, <span class="number">149</span>, <span class="number">199</span>, <span class="number">8960</span>), (<span class="number">19813</span>, <span class="number">239</span>, <span class="number">229</span>, <span class="number">53463</span>), (<span class="number">4943</span>, <span class="number">131</span>, <span class="number">157</span>, <span class="number">14606</span>), (<span class="number">29077</span>, <span class="number">191</span>, <span class="number">181</span>, <span class="number">33446</span>), (<span class="number">18583</span>, <span class="number">211</span>, <span class="number">163</span>, <span class="number">31800</span>), (<span class="number">30643</span>, <span class="number">173</span>, <span class="number">191</span>, <span class="number">27293</span>), (<span class="number">11617</span>, <span class="number">223</span>, <span class="number">251</span>, <span class="number">13448</span>), (<span class="number">19051</span>, <span class="number">191</span>, <span class="number">151</span>, <span class="number">21676</span>), (<span class="number">18367</span>, <span class="number">179</span>, <span class="number">157</span>, <span class="number">14139</span>), (<span class="number">18861</span>, <span class="number">149</span>, <span class="number">191</span>, <span class="number">5139</span>), (<span class="number">9581</span>, <span class="number">211</span>, <span class="number">193</span>, <span class="number">25595</span>)]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">list</span>:</span><br><span class="line">    e,p,q,c=i[<span class="number">0</span>],i[<span class="number">1</span>],i[<span class="number">2</span>],i[<span class="number">3</span>]</span><br><span class="line">    n=p*q</span><br><span class="line">    phi=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">    d=gmpy2.invert(e,phi)</span><br><span class="line">    m=<span class="built_in">pow</span>(c,d,n)</span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(m).decode(<span class="string">&#x27;utf-8&#x27;</span>),end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>
<h2 id="ç¾ŠåŸæ¯-2020-RRRRRRRSA"><a href="#ç¾ŠåŸæ¯-2020-RRRRRRRSA" class="headerlink" title="[ç¾ŠåŸæ¯ 2020]RRRRRRRSA"></a>[ç¾ŠåŸæ¯ 2020]RRRRRRRSA</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> sympy</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;GWHT&#123;*********&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line">flag1 = flag[:<span class="number">14</span>]</span><br><span class="line">flag2 = flag[<span class="number">14</span>:]</span><br><span class="line"><span class="keyword">assert</span>(<span class="built_in">len</span>(flag) == <span class="number">27</span>)</span><br><span class="line"></span><br><span class="line">P1 = getPrime(<span class="number">1038</span>)</span><br><span class="line">P2 = sympy.nextprime(P1)</span><br><span class="line"><span class="keyword">assert</span>(P2 - P1 &lt; <span class="number">1000</span>)</span><br><span class="line"></span><br><span class="line">Q1 = getPrime(<span class="number">512</span>)</span><br><span class="line">Q2 = sympy.nextprime(Q1)</span><br><span class="line"></span><br><span class="line">N1 = P1 * P1 * Q1</span><br><span class="line">N2 = P2 * P2 * Q2</span><br><span class="line"></span><br><span class="line">E1 = getPrime(<span class="number">1024</span>)</span><br><span class="line">E2 = sympy.nextprime(E1)</span><br><span class="line"></span><br><span class="line">m1 = bytes_to_long(flag1)</span><br><span class="line">m2 = bytes_to_long(flag2)</span><br><span class="line"></span><br><span class="line">c1 = <span class="built_in">pow</span>(m1, E1, N1)</span><br><span class="line">c2 = <span class="built_in">pow</span>(m2, E2, N2)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">output = <span class="built_in">open</span>(<span class="string">&#x27;secret&#x27;</span>, <span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">output.write(<span class="string">&#x27;N1=&#x27;</span> + <span class="built_in">str</span>(N1) + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">output.write(<span class="string">&#x27;c1=&#x27;</span> + <span class="built_in">str</span>(c1) + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">output.write(<span class="string">&#x27;E1=&#x27;</span> + <span class="built_in">str</span>(E1) + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">output.write(<span class="string">&#x27;N2=&#x27;</span> + <span class="built_in">str</span>(N2) + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">output.write(<span class="string">&#x27;c2=&#x27;</span> + <span class="built_in">str</span>(c2) + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">output.write(<span class="string">&#x27;E2=&#x27;</span> + <span class="built_in">str</span>(E2) + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">output.close()</span><br></pre></td></tr></table></figure>
<p>p1p2å’Œq1q2åˆ†åˆ«éƒ½æ˜¯ç›¸é‚»ç´ æ•°ï¼Œæœ‰ï¼š</p>
<script type="math/tex; mode=display">
\frac{n_1}{n_2}=(\frac{p_1}{p_2})^2\frac{q_1}{q_2}</script><p>å’Œä¸Šå‘¨çš„signinå·®ä¸å¤šï¼Œä¾æ—§æ˜¯ç»´çº³æ”»å‡»ï¼š</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">N1=<span class="number">28539239760609998188190348006307254423529984523926011298354682217538318221201323233400895681944936240127760319591714405028970789289069319799896668405374649890651532747231344681669678805558659075027847592497103008180667401328194026698749233856463858487096300279373254961880228864461848969277992345170787143090948199697266462389362914238819698112687026213976658417210663710975098053456243238943838516217798558036642447022751111845270483110159293737669560262193958772015914816987850140197853369767380678566336063010710812528919482513791382363881826680659095433918156094107350594201368395060384315773118343026193511099009931177740948978534045707679969732723167077325752299598557383348276880809860413060977442176372544771414690543709674125255716088409107695219200275948083389811120343</span></span><br><span class="line">c1=<span class="number">1432582014696304280729383293185554513436929310033823269133977593539672022744978340029313742941392672688363895524640351487464959860278576282854691764963077939567531721178912737755379413034164798305484717033762726637503348022397339246940965129765378824268519081645805470821347112369377592502109678876165836108257610182421452838639591697308432137885174692492190957254254995673010537260331832973067691597718100899475899017281060822990010249568584370589711942182283002241043038119931455622397903939297537776804134742442672001638774739818585840571993745726530468147630711418520486306194651956014117679528472239294239116641656014852458465706006398065574504399016286485027421474307531748266141136418468990741046806688381193860509615850629805172129297224123462801586090084637746562423808</span></span><br><span class="line">E1=<span class="number">165789626975534012040420057284463500775834911397214992496515507176272849770841998477139944440126985014248815418211585858658342524799286016374109756516450870298232454995876047057825952563581619963387275065218691863272435560584657400761485940130783607258311246708485662913432455714363728035174035069036312370233</span></span><br><span class="line">N2=<span class="number">28539239760609998188190348006307254423529984523926011298354682217538318221201323233400895681944936240127760319591714405028970789289069319799896668405377378062335966544017315329665365256524558696688888741558627244653037221467229159144343040629127843297021870442297090214085287305843208151069804261723045390513830069085816369993597001968164660390663983571269250460727348123970070188870297493687465127551913118724304293942732950040939150438510454614095673775735977217966562306548665616925803946575019193754095625773160561193234183507671760318885800972555685452762447998320093072265818485061557955267533908006243431570323359331106169234651310488306412479972526063665874847216797986275140105142694301359006633212114432527436809944525332728559649659936613255629968696993687582732203577</span></span><br><span class="line">c2=<span class="number">15573518512630583133605706431375892476846434992703760807266881477212729790675502562405142453118932977842339803883111403869334521098950030048699583130857582338419182841819307757252097704148569218757559761264396801310961344678392000382263595912787825617009851110457692404940207973548999796553024456145274114257889573707649959860997335143214788897776951837248853483762434899857463503651914305981628033038172123120703537802061315610043298426738218704990852775023413248589434394708618489802771255075164976384643287270994751622452142844176084933641827641239534332334446368745588970480750957569438747829980771324981588625047320914720986351721280038816715323656526802000900688313558979941992015923305782197562859553039256619824373010017972420560224632828808074734952385591551175446599133</span></span><br><span class="line">E2=<span class="number">165789626975534012040420057284463500775834911397214992496515507176272849770841998477139944440126985014248815418211585858658342524799286016374109756516450870298232454995876047057825952563581619963387275065218691863272435560584657400761485940130783607258311246708485662913432455714363728035174035069036312370859</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">f2c</span>(<span class="params">p,q</span>):<span class="comment">#åˆ†æ•°è½¬è¿åˆ†æ•°</span></span><br><span class="line"> a=[]</span><br><span class="line"> <span class="keyword">while</span> q:</span><br><span class="line">  a.append(p//q)</span><br><span class="line">  p,q=q,p%q</span><br><span class="line"> <span class="keyword">return</span> a</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">c2f</span>(<span class="params">a</span>):<span class="comment">#è¿åˆ†æ•°è½¬åˆ†æ•°</span></span><br><span class="line">  x,y=<span class="number">1</span>,<span class="number">0</span><span class="comment">#xä¸ºåˆ†å­yä¸ºåˆ†æ¯</span></span><br><span class="line">  <span class="keyword">for</span> a <span class="keyword">in</span> a[::-<span class="number">1</span>]:<span class="comment">#é€†åºç´¯åŠ </span></span><br><span class="line">    x,y=a*x+y,x</span><br><span class="line">  <span class="keyword">return</span> (x,y)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sf</span>(<span class="params">a</span>):<span class="comment">#æ±‚å„é¡¹æ¸è¿›åˆ†æ•°</span></span><br><span class="line"> f=[]</span><br><span class="line"> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="built_in">len</span>(a)):</span><br><span class="line">  f.append(c2f(a[:i]))</span><br><span class="line"> <span class="keyword">return</span> f</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">wiener_attack</span>(<span class="params">n1,n2</span>):</span><br><span class="line"> a=f2c(n1,n2)</span><br><span class="line"> <span class="keyword">for</span> (q1,q2) <span class="keyword">in</span> sf(a):		</span><br><span class="line">    <span class="keyword">if</span> q1!=<span class="number">0</span> <span class="keyword">and</span> q1!=<span class="number">1</span> <span class="keyword">and</span> n1%q1==<span class="number">0</span>:	</span><br><span class="line">        <span class="keyword">return</span> (q1,q2)</span><br><span class="line"></span><br><span class="line">Q1,Q2=wiener_attack(N1,N2)</span><br><span class="line">P1=gmpy2.iroot(N1//Q1,<span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line">P2=gmpy2.iroot(N2//Q2,<span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line">phi1=P1*(P1-<span class="number">1</span>)*(Q1-<span class="number">1</span>)</span><br><span class="line">phi2=P2*(P2-<span class="number">1</span>)*(Q2-<span class="number">1</span>)</span><br><span class="line">d1=gmpy2.invert(E1,phi1)</span><br><span class="line">d2=gmpy2.invert(E2,phi2)</span><br><span class="line">m1=<span class="built_in">pow</span>(c1,d1,N1)</span><br><span class="line">m2=<span class="built_in">pow</span>(c2,d2,N2)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m1)+long_to_bytes(m2))</span><br></pre></td></tr></table></figure>
<h2 id="SWPUCTF-2021-æ–°ç”Ÿèµ›-crypto3"><a href="#SWPUCTF-2021-æ–°ç”Ÿèµ›-crypto3" class="headerlink" title="[SWPUCTF 2021 æ–°ç”Ÿèµ›]crypto3"></a>[SWPUCTF 2021 æ–°ç”Ÿèµ›]crypto3</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">flag  = <span class="string">&#x27;******************&#x27;</span></span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">m1 = bytes_to_long(<span class="built_in">bytes</span>(flag.encode()))</span><br><span class="line"></span><br><span class="line">n = p*q</span><br><span class="line"></span><br><span class="line">flag1 = <span class="built_in">pow</span>(m1,p,n)</span><br><span class="line">flag2 = <span class="built_in">pow</span>(m1,q,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;flag1= &#x27;</span>+<span class="built_in">str</span>(flag1))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;flag2= &#x27;</span>+<span class="built_in">str</span>(flag2))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;n= &#x27;</span>+<span class="built_in">str</span>(n))</span><br><span class="line"></span><br><span class="line"><span class="comment">#flag1= 17893542812755845772427795161304049467610774531005620109503081344099161906017295486868699578946474114607624347167976713200068059018517606363517478396368430072890681401898145302336139240273132723451063402106360810413024642916851746118524166947301681245568333254648265529408446609050354235727237078987509705857</span></span><br><span class="line"><span class="comment">#flag2= 95580409405085606847879727622943874726633827220524165744517624606566789614499137069562997931972825651309707390763700301965277040876322904891716953565845966918293178547100704981251056401939781365264616997055296773593435626490578886752446381493929807909671245959154990639046333135728431707979143972145708806954</span></span><br><span class="line"><span class="comment">#n= 140457323583824160338989317689698102738341061967768153879646505422358544720607476140977064053629005764551339082120337223672330979298373653766782620973454095507484118565884885623328751648660379894592063436924903894986994746394508539721459355200184089470977772075720319482839923856979166319700474349042326898971</span></span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®åŠ å¯†æ‰€ç”¨çš„æŒ‡æ•°ä¸ºpå’Œqï¼Œè¿™è®©æˆ‘æƒ³åˆ°äº†è´¹é©¬å°å®šç†ï¼š</p>
<script type="math/tex; mode=display">
m^p\equiv m(\bmod p)</script><p>æ­¤å¤–ï¼Œæ ¹æ®åŒä½™çš„æ€§è´¨å¯ä»¥å¯¹$c_1$åšå¦‚ä¸‹å¤„ç†ï¼š</p>
<script type="math/tex; mode=display">
m^p\equiv\begin{cases}c_1(\bmod p)\\\\c_1(\bmod q)\end{cases}</script><p>è¿™æ ·å°±æœ‰äº†$m\equiv c_1(\bmod p)$ï¼Œåœ¨æ¨¡pä¸‹ï¼š</p>
<script type="math/tex; mode=display">
m^2-(c_1+c_2)m+c_1c_2=c_1^2-(c_1+c_2)c_1+c_1c_2=0</script><p>å¯ä»¥æ„é€ å¤šé¡¹å¼æ±‚è§£å°å€¼æ ¹äº†ï¼š</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c1= <span class="number">17893542812755845772427795161304049467610774531005620109503081344099161906017295486868699578946474114607624347167976713200068059018517606363517478396368430072890681401898145302336139240273132723451063402106360810413024642916851746118524166947301681245568333254648265529408446609050354235727237078987509705857</span></span><br><span class="line">c2= <span class="number">95580409405085606847879727622943874726633827220524165744517624606566789614499137069562997931972825651309707390763700301965277040876322904891716953565845966918293178547100704981251056401939781365264616997055296773593435626490578886752446381493929807909671245959154990639046333135728431707979143972145708806954</span></span><br><span class="line">n= <span class="number">140457323583824160338989317689698102738341061967768153879646505422358544720607476140977064053629005764551339082120337223672330979298373653766782620973454095507484118565884885623328751648660379894592063436924903894986994746394508539721459355200184089470977772075720319482839923856979166319700474349042326898971</span></span><br><span class="line"></span><br><span class="line">p.&lt;x&gt;=PolynomialRing(Zmod(n))</span><br><span class="line">f=x^<span class="number">2</span>-(c1+c2)*x+c1*c2</span><br><span class="line">x0=f.small_roots()[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(x0)))</span><br></pre></td></tr></table></figure>
<blockquote>
<p>æˆ‘ä»¬ç”±äºæœªçŸ¥flagé•¿åº¦ï¼ŒçŒœæµ‹flagå¾ˆå°ï¼Œä¸éœ€è¦è®¾ç½®ä¸Šç•Œå°±èƒ½è§£å‡ºflagã€‚</p>
</blockquote>
<h2 id="TSGCTF-2021-Beginnerâ€™s-Crypto-2021"><a href="#TSGCTF-2021-Beginnerâ€™s-Crypto-2021" class="headerlink" title="[TSGCTF 2021]Beginnerâ€™s Crypto 2021"></a>[TSGCTF 2021]Beginnerâ€™s Crypto 2021</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> e</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getStrongPrime, isPrime</span><br><span class="line"></span><br><span class="line">p = getStrongPrime(<span class="number">1024</span>)</span><br><span class="line">q = getStrongPrime(<span class="number">1024</span>)</span><br><span class="line">N = p * q</span><br><span class="line">phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;flag.txt&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    flag = <span class="built_in">int</span>.from_bytes(f.read(), <span class="string">&#x27;big&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span>(isPrime(e))</span><br><span class="line"><span class="keyword">assert</span>(isPrime(e + <span class="number">2</span>))</span><br><span class="line"><span class="keyword">assert</span>(isPrime(e + <span class="number">4</span>))</span><br><span class="line"></span><br><span class="line">e1 = <span class="built_in">pow</span>(e, <span class="number">0x10001</span>, phi)</span><br><span class="line">e2 = <span class="built_in">pow</span>(e + <span class="number">2</span>, <span class="number">0x10001</span>, phi)</span><br><span class="line">e3 = <span class="built_in">pow</span>(e + <span class="number">4</span>, <span class="number">0x10001</span>, phi)</span><br><span class="line"></span><br><span class="line">c1 = <span class="built_in">pow</span>(flag, e1, N)</span><br><span class="line">c2 = <span class="built_in">pow</span>(flag, e2, N)</span><br><span class="line">c3 = <span class="built_in">pow</span>(flag, e3, N)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;p = <span class="subst">&#123;p&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;q = <span class="subst">&#123;q&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c1 = <span class="subst">&#123;c1&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c2 = <span class="subst">&#123;c2&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c3 = <span class="subst">&#123;c3&#125;</span>&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>è¿™é¢˜ç”¨äº†å…±æ¨¡æ”»å‡»ï¼Œä½†æ˜¯æœªçŸ¥eï¼Œé¦–å…ˆæƒ³åˆ°çš„å°±æ˜¯çˆ†ç ´ä¸€ä¸‹eï¼Œè§‚å¯Ÿä¸€ä¸‹ä»£ç ï¼Œå¯ä»¥åˆ¤æ–­ä¸€ä¸‹eï¼Œe+2ï¼Œe+4æ¥æ‰¾åˆ°eï¼Œäº‹å®ä¸Šï¼Œçˆ†ç ´äº†ä¸€ä¼šå‘ç°æ»¡è¶³è¦æ±‚çš„eåªæœ‰3ï¼š</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> libnum <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line">p = <span class="number">167710954518007348037383082265231465648795974011761905177264545864288011527333715495850532989338171489309608848431113452814709692343039027970312735521415071265608660628968391884287240987858607818275329135585153511665148279408708087727501421558738163577629329044315775019460018956186674179846621352371150072281</span></span><br><span class="line">q = <span class="number">130354329753344570838569091064852072757046774566775609047544069941246798511317343102715733555464772099991834579660053860799207243561908291522943696711982657846373844514551117658179060004064010647453939332217996817580433587341521331941287365948919907797478197717562721233289937471168288241937022054501586986443</span></span><br><span class="line">c1 = <span class="number">2560344169447809042170685026483682125499025654554670516499742981486615082413150123244985585751880264831112089324011804397189638172356179296987581738515619297036118472798499254785110885662931526277474101787493114656242031264678448394380651657330967744585361662315313462698221954777506355498445242300193032704972074020068699180111637362566860530694807230108024167631423062629721393506643291591971626450262144814424411172618188943774725105690851574922374544865628890948773274109561622040022136970632948166009941425683576381155722191980954262373394704682297682490061906408535261437100820855976015526295573831744458528440</span></span><br><span class="line">c2 = <span class="number">9041231631916227099296501948589424780380702196870972231114747229225732542137483840187783630590878594711315671224997985975031038623195921968945234067183003568830416719957054703139219879265482072634572699299971785171441858501409377942183918216246312330291820452436486171483461790388518159980027140392750222843449604265528929311978655519463562520038992870162220913137870017065557254099767583925177889051326144499369420594398043223307161794788085369471538477803421726790780799629276012701406231535048423554314287152404245482928538931953627397633165453319078105028671410039195670727134471011040601278722143504641171853743</span></span><br><span class="line">c3 = <span class="number">3193069356811106774640161554961405075257002069448498144279061282023129342916422283816661697787316681475161942522570615456264481238277711114193792510286127129056376618422336477707825009085263623755329815306483253646072909132096678270667136193038337386976289222105363398033633185639402128949635525665502328717781718263894690234837016959581149138917064108193064639981137359869717065147934752707676203651598070046066514316196771853484143158367616177332902152347890310640338106015356361617700741042461419248117687350565094928451141103632305400493998164788411031832078388030194992306440474662871408938796429927990102583837</span></span><br><span class="line">n=p*q</span><br><span class="line">e=<span class="number">2</span></span><br><span class="line">phi=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    <span class="built_in">print</span>(e)</span><br><span class="line">    <span class="keyword">if</span> isPrime(e) <span class="keyword">and</span> isPrime(e+<span class="number">2</span>) <span class="keyword">and</span> isPrime(e+<span class="number">4</span>):</span><br><span class="line">        e1 = <span class="built_in">pow</span>(e, <span class="number">0x10001</span>, phi)</span><br><span class="line">        e2 = <span class="built_in">pow</span>(e + <span class="number">2</span>, <span class="number">0x10001</span>, phi)</span><br><span class="line">        s,s1,s2=gmpy2.gcdext(e1,e2)</span><br><span class="line">        m=(<span class="built_in">pow</span>(c1,s1,n)*<span class="built_in">pow</span>(c2,s2,n))%n</span><br><span class="line">        flag=long_to_bytes(m)</span><br><span class="line">        <span class="comment">#print(flag)</span></span><br><span class="line">        <span class="built_in">str</span>=<span class="string">&#x27;You are intuitively understanding the distribution of prime numbers! Bonus: You can solve this challenge w/ N instead of p and q!&#x27;</span></span><br><span class="line">        <span class="built_in">print</span>(hashlib.md5(<span class="built_in">str</span>.encode(<span class="string">&#x27;utf-8&#x27;</span>)).hexdigest())</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    e+=<span class="number">1</span></span><br></pre></td></tr></table></figure>
<p>æäº¤éœ€è¦md5åŠ å¯†ï¼Œæ³¨æ„åªéœ€è¦åŠ å¯†flagå†…éƒ¨çš„å†…å®¹å³å¯ã€‚</p>
<h2 id="é•¿åŸæ¯-2022-æ”¿ä¼ç»„-xor"><a href="#é•¿åŸæ¯-2022-æ”¿ä¼ç»„-xor" class="headerlink" title="[é•¿åŸæ¯ 2022 æ”¿ä¼ç»„]xor"></a>[é•¿åŸæ¯ 2022 æ”¿ä¼ç»„]xor</h2><p>çœ‹é¢˜ç›®æ˜¯ä¸€é“å¼‚æˆ–é¢˜ï¼š</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cut</span>(<span class="params">obj, sec</span>):</span><br><span class="line">    <span class="keyword">return</span> [obj[i:i+sec] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(obj),sec)]</span><br><span class="line"></span><br><span class="line">x = <span class="number">6</span></span><br><span class="line"><span class="keyword">assert</span> flag.startswith(<span class="string">&#x27;flag&#123;&#x27;</span>)</span><br><span class="line"><span class="keyword">assert</span> flag.endswith(<span class="string">&#x27;&#125;&#x27;</span>)</span><br><span class="line">m = cut(flag, x)</span><br><span class="line"></span><br><span class="line">pad = os.urandom(x)</span><br><span class="line">res = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> m:</span><br><span class="line">    tmp = []</span><br><span class="line"></span><br><span class="line">    tmp.append(i[<span class="number">0</span>] ^ i[<span class="number">1</span>] ^ i[<span class="number">2</span>] ^ pad[<span class="number">0</span>])</span><br><span class="line">    tmp.append(i[<span class="number">3</span>] ^ i[<span class="number">4</span>] ^ pad[<span class="number">1</span>] ^ pad[<span class="number">2</span>])</span><br><span class="line">    tmp.append(pad[<span class="number">5</span>] ^ i[<span class="number">5</span>] ^ pad[<span class="number">1</span>] ^ pad[<span class="number">3</span>])</span><br><span class="line">    tmp.append(i[<span class="number">3</span>] ^ pad[<span class="number">3</span>] ^ pad[<span class="number">4</span>] ^ pad[<span class="number">1</span>])</span><br><span class="line">    tmp.append(i[<span class="number">5</span>] ^ pad[<span class="number">0</span>] ^ i[<span class="number">4</span>] ^ pad[<span class="number">1</span>])</span><br><span class="line">    tmp.append(i[<span class="number">2</span>] ^ i[<span class="number">4</span>] ^ pad[<span class="number">0</span>] ^ pad[<span class="number">1</span>])</span><br><span class="line">    tmp.append(i[<span class="number">2</span>] ^ i[<span class="number">0</span>] ^ i[<span class="number">4</span>] ^ pad[<span class="number">4</span>])</span><br><span class="line">    </span><br><span class="line">    res.append(tmp)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line"><span class="comment">#[[150, 194, 49, 195, 23, 79, 66], [194, 136, 63, 147, 3, 2, 81], [132, 221, 57, 144, 83, 83, 93], [208, 223, 37, 193, 28, 0, 70], [154, 203, 108, 156, 28, 78, 68], [159, 221, 62, 146, 86, 82, 88], [197, 141, 117, 192, 31, 90, 85]]</span></span><br></pre></td></tr></table></figure>
<p>è¿™é¢˜ç”¨cutå¯¹flagè¿›è¡Œäº†ä¸€ç§å—åŠ å¯†çš„æ“ä½œï¼Œå®è´¨å°±æ˜¯å¼‚æˆ–ã€‚</p>
<p>è¿™é¢˜æœ€å¥½çš„çªç ´å£å°±åœ¨é¢˜ç›®æäº†ä¸€ä¸‹<code>assert flag.startswith(&#39;flag&#123;&#39;)</code>ï¼Œè¿™ä¸ªå¼‚æˆ–æœ‰ä¸€ä¸ªpadç”Ÿæˆçš„éšæœºå­—èŠ‚æˆ‘ä»¬éœ€è¦å»æ±‚ï¼Œç”¨è¿™ä¸ªflagå¤´ä»£å…¥iæ•°ç»„å»è¿ç®—å°±èƒ½å¾—åˆ°padï¼Œä¹Ÿèƒ½å¾—åˆ°flagç¬¬ä¸€ä¸ªå—çš„æœ€åä¸€ä½ï¼š</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">pad=[<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>]</span><br><span class="line">pad[<span class="number">0</span>]=<span class="number">150</span>^<span class="built_in">ord</span>(<span class="string">&#x27;f&#x27;</span>)^<span class="built_in">ord</span>(<span class="string">&#x27;l&#x27;</span>)^<span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">pad[<span class="number">4</span>]=<span class="number">66</span>^<span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>)^<span class="built_in">ord</span>(<span class="string">&#x27;f&#x27;</span>)^<span class="built_in">ord</span>(<span class="string">&#x27;&#123;&#x27;</span>)</span><br><span class="line">pad[<span class="number">1</span>]=<span class="number">79</span>^<span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>)^<span class="built_in">ord</span>(<span class="string">&#x27;&#123;&#x27;</span>)^pad[<span class="number">0</span>]</span><br><span class="line">pad[<span class="number">3</span>]=<span class="number">195</span>^<span class="built_in">ord</span>(<span class="string">&#x27;g&#x27;</span>)^pad[<span class="number">4</span>]^pad[<span class="number">1</span>]</span><br><span class="line">pad[<span class="number">2</span>]=<span class="number">194</span>^<span class="built_in">ord</span>(<span class="string">&#x27;g&#x27;</span>)^<span class="built_in">ord</span>(<span class="string">&#x27;&#123;&#x27;</span>)^pad[<span class="number">1</span>]</span><br><span class="line">i=<span class="number">23</span>^pad[<span class="number">0</span>]^<span class="built_in">ord</span>(<span class="string">&#x27;&#123;&#x27;</span>)^pad[<span class="number">1</span>]</span><br><span class="line">pad[<span class="number">5</span>]=<span class="number">49</span>^i^pad[<span class="number">1</span>]^pad[<span class="number">3</span>]</span><br><span class="line"><span class="built_in">print</span>(pad)</span><br></pre></td></tr></table></figure>
<p>æœ‰äº†padä¹‹åï¼Œæ ¹æ®ä»–çš„è¿ç®—æ³•åˆ™æŠŠå¾—åˆ°çš„æ•°ç»„å†å¼‚æˆ–å›å»å³å¯ï¼Œæœ‰ç‚¹ç»•ï¼Œä½†ä¸å¤šï¼š</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">list</span>=[[<span class="number">150</span>, <span class="number">194</span>, <span class="number">49</span>, <span class="number">195</span>, <span class="number">23</span>, <span class="number">79</span>, <span class="number">66</span>], [<span class="number">194</span>, <span class="number">136</span>, <span class="number">63</span>, <span class="number">147</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">81</span>], [<span class="number">132</span>, <span class="number">221</span>, <span class="number">57</span>, <span class="number">144</span>, <span class="number">83</span>, <span class="number">83</span>, <span class="number">93</span>], [<span class="number">208</span>, <span class="number">223</span>, <span class="number">37</span>, <span class="number">193</span>, <span class="number">28</span>, <span class="number">0</span>, <span class="number">70</span>], [<span class="number">154</span>, <span class="number">203</span>, <span class="number">108</span>, <span class="number">156</span>, <span class="number">28</span>, <span class="number">78</span>, <span class="number">68</span>], [<span class="number">159</span>, <span class="number">221</span>, <span class="number">62</span>, <span class="number">146</span>, <span class="number">86</span>, <span class="number">82</span>, <span class="number">88</span>], [<span class="number">197</span>, <span class="number">141</span>, <span class="number">117</span>, <span class="number">192</span>, <span class="number">31</span>, <span class="number">90</span>, <span class="number">85</span>]]</span><br><span class="line">pad=[<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>]</span><br><span class="line">pad[<span class="number">0</span>]=<span class="number">150</span>^<span class="built_in">ord</span>(<span class="string">&#x27;f&#x27;</span>)^<span class="built_in">ord</span>(<span class="string">&#x27;l&#x27;</span>)^<span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">pad[<span class="number">4</span>]=<span class="number">66</span>^<span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>)^<span class="built_in">ord</span>(<span class="string">&#x27;f&#x27;</span>)^<span class="built_in">ord</span>(<span class="string">&#x27;&#123;&#x27;</span>)</span><br><span class="line">pad[<span class="number">1</span>]=<span class="number">79</span>^<span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>)^<span class="built_in">ord</span>(<span class="string">&#x27;&#123;&#x27;</span>)^pad[<span class="number">0</span>]</span><br><span class="line">pad[<span class="number">3</span>]=<span class="number">195</span>^<span class="built_in">ord</span>(<span class="string">&#x27;g&#x27;</span>)^pad[<span class="number">4</span>]^pad[<span class="number">1</span>]</span><br><span class="line">pad[<span class="number">2</span>]=<span class="number">194</span>^<span class="built_in">ord</span>(<span class="string">&#x27;g&#x27;</span>)^<span class="built_in">ord</span>(<span class="string">&#x27;&#123;&#x27;</span>)^pad[<span class="number">1</span>]</span><br><span class="line">i=<span class="number">23</span>^pad[<span class="number">0</span>]^<span class="built_in">ord</span>(<span class="string">&#x27;&#123;&#x27;</span>)^pad[<span class="number">1</span>]</span><br><span class="line">pad[<span class="number">5</span>]=<span class="number">49</span>^i^pad[<span class="number">1</span>]^pad[<span class="number">3</span>]</span><br><span class="line">flag=<span class="string">&#x27;&#x27;</span></span><br><span class="line">flag+=<span class="string">&#x27;flag&#123;&#x27;</span>+<span class="built_in">chr</span>(i)</span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="built_in">len</span>(<span class="built_in">list</span>)):</span><br><span class="line">    i=<span class="built_in">list</span>[j]</span><br><span class="line">    tmp=[<span class="string">&#x27;&#x27;</span>,<span class="string">&#x27;&#x27;</span>,<span class="string">&#x27;&#x27;</span>,<span class="string">&#x27;&#x27;</span>,<span class="string">&#x27;&#x27;</span>,<span class="string">&#x27;&#x27;</span>]</span><br><span class="line">    tmp[<span class="number">5</span>]=<span class="built_in">chr</span>(i[<span class="number">2</span>]^pad[<span class="number">5</span>]^pad[<span class="number">1</span>]^pad[<span class="number">3</span>])</span><br><span class="line">    tmp[<span class="number">3</span>]=<span class="built_in">chr</span>(i[<span class="number">3</span>]^pad[<span class="number">3</span>]^pad[<span class="number">4</span>]^pad[<span class="number">1</span>])</span><br><span class="line">    tmp[<span class="number">4</span>]=<span class="built_in">chr</span>(i[<span class="number">4</span>]^<span class="built_in">ord</span>(tmp[<span class="number">5</span>])^pad[<span class="number">0</span>]^pad[<span class="number">1</span>])</span><br><span class="line">    tmp[<span class="number">2</span>]=<span class="built_in">chr</span>(i[<span class="number">5</span>]^<span class="built_in">ord</span>(tmp[<span class="number">4</span>])^pad[<span class="number">0</span>]^pad[<span class="number">1</span>])</span><br><span class="line">    tmp[<span class="number">0</span>]=<span class="built_in">chr</span>(i[<span class="number">6</span>]^<span class="built_in">ord</span>(tmp[<span class="number">2</span>])^<span class="built_in">ord</span>(tmp[<span class="number">4</span>])^pad[<span class="number">4</span>])</span><br><span class="line">    tmp[<span class="number">1</span>]=<span class="built_in">chr</span>(i[<span class="number">0</span>]^<span class="built_in">ord</span>(tmp[<span class="number">0</span>])^<span class="built_in">ord</span>(tmp[<span class="number">2</span>])^pad[<span class="number">0</span>])</span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> tmp:</span><br><span class="line">        flag+=k</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>
<h2 id="çº¢æ˜è°·CTF-2022-easy-ya"><a href="#çº¢æ˜è°·CTF-2022-easy-ya" class="headerlink" title="[çº¢æ˜è°·CTF 2022]easy_ya"></a>[çº¢æ˜è°·CTF 2022]easy_ya</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen</span>():</span><br><span class="line">    e = <span class="number">3</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            p = getPrime(<span class="number">512</span>)</span><br><span class="line">            q = getPrime(<span class="number">512</span>)</span><br><span class="line">            n = p*q</span><br><span class="line">            phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">            d = inverse(e,phi)</span><br><span class="line">            <span class="keyword">return</span> p,q,d,n,e</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">return</span> p,q,d,n,e</span><br><span class="line"></span><br><span class="line">p,q,d,n,e = gen()</span><br><span class="line">r = getPrime(<span class="number">512</span>)</span><br><span class="line">m = bytes_to_long(flag+os.urandom(<span class="number">32</span>))</span><br><span class="line">M = m%r</span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;r = %d&quot;</span>%r)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;M = %d&quot;</span>%M)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n = %d&quot;</span>%n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;e = %d&quot;</span>%e)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c = %d&quot;</span>%c)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">r = 7996728164495259362822258548434922741290100998149465194487628664864256950051236186227986990712837371289585870678059397413537714250530572338774305952904473</span></span><br><span class="line"><span class="string">M = 4159518144549137412048572485195536187606187833861349516326031843059872501654790226936115271091120509781872925030241137272462161485445491493686121954785558</span></span><br><span class="line"><span class="string">n = 131552964273731742744001439326470035414270864348139594004117959631286500198956302913377947920677525319260242121507196043323292374736595943942956194902814842206268870941485429339132421676367167621812260482624743821671183297023718573293452354284932348802548838847981916748951828826237112194142035380559020560287</span></span><br><span class="line"><span class="string">e = 3</span></span><br><span class="line"><span class="string">c = 46794664006708417132147941918719938365671485176293172014575392203162005813544444720181151046818648417346292288656741056411780813044749520725718927535262618317679844671500204720286218754536643881483749892207516758305694529993542296670281548111692443639662220578293714396224325591697834572209746048616144307282</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>è¿™é¢˜å¯¹måšäº†å¤„ç†ï¼Œæœ‰$m=M+k_1r$</p>
<p>å› ä¸º$e=3$ï¼Œæ‰€ä»¥æœ‰ï¼š</p>
<script type="math/tex; mode=display">
(M+k_1r)^3-k_2n=c</script><p>å¯ä»¥æ„é€ å¤šé¡¹å¼$f=(M+k_1r)^3-c$</p>
<p>ç”¨coppersmithæ±‚è§£må¾—åˆ°flagï¼š</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r = <span class="number">7996728164495259362822258548434922741290100998149465194487628664864256950051236186227986990712837371289585870678059397413537714250530572338774305952904473</span></span><br><span class="line">M = <span class="number">4159518144549137412048572485195536187606187833861349516326031843059872501654790226936115271091120509781872925030241137272462161485445491493686121954785558</span></span><br><span class="line">n = <span class="number">131552964273731742744001439326470035414270864348139594004117959631286500198956302913377947920677525319260242121507196043323292374736595943942956194902814842206268870941485429339132421676367167621812260482624743821671183297023718573293452354284932348802548838847981916748951828826237112194142035380559020560287</span></span><br><span class="line">e = <span class="number">3</span></span><br><span class="line">c = <span class="number">46794664006708417132147941918719938365671485176293172014575392203162005813544444720181151046818648417346292288656741056411780813044749520725718927535262618317679844671500204720286218754536643881483749892207516758305694529993542296670281548111692443639662220578293714396224325591697834572209746048616144307282</span></span><br><span class="line">p.&lt;x&gt;=PolynomialRing(Zmod(n))</span><br><span class="line">f=(M+x*r)^<span class="number">3</span>-c</span><br><span class="line">f=f.monic()</span><br><span class="line">x0=f.small_roots()[<span class="number">0</span>]</span><br><span class="line">k=<span class="built_in">int</span>(x0)</span><br><span class="line">m=M+k*r</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>
<h1 id="WEEK-3"><a href="#WEEK-3" class="headerlink" title="WEEK 3"></a>WEEK 3</h1><h2 id="zer0pts-2020-ROR"><a href="#zer0pts-2020-ROR" class="headerlink" title="[zer0pts 2020]ROR"></a>[zer0pts 2020]ROR</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">ror = <span class="keyword">lambda</span> x, l, b: (x &gt;&gt; l) | ((x &amp; ((<span class="number">1</span>&lt;&lt;l)-<span class="number">1</span>)) &lt;&lt; (b-l))</span><br><span class="line"></span><br><span class="line">N = <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> base <span class="keyword">in</span> [<span class="number">2</span>, <span class="number">3</span>, <span class="number">7</span>]:</span><br><span class="line">    N *= <span class="built_in">pow</span>(base, random.randint(<span class="number">123</span>, <span class="number">456</span>))</span><br><span class="line">e = random.randint(<span class="number">271828</span>, <span class="number">314159</span>)</span><br><span class="line"></span><br><span class="line">m = <span class="built_in">int</span>.from_bytes(flag, byteorder=<span class="string">&#x27;big&#x27;</span>)</span><br><span class="line"><span class="keyword">assert</span> m.bit_length() &lt; N.bit_length()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m.bit_length()):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">pow</span>(ror(m, i, m.bit_length()), e, N))</span><br><span class="line">    </span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">å…±367ä¸ªå¤§æ•°</span></span><br><span class="line"><span class="string">1123279905753420854056949270002079681846506391469678488301569277287912082415123311220349271402019208029052224502080757137106573269187631637748684158368045600005655891722764459682451768985892383847582777401840658306512477897257240329468693759755275846566672333848486514916087101615422164522188501353017634498421719941291156644882844167419683097913336651801182760157321799921263689020310161398379427011654220488495216138997481624067312309716359256133688385745929373875911175705411323092025782228256765</span></span><br><span class="line"><span class="string">60848463499016786897050297575193379856357320605752544731915960900662600736882534150881154375836797044831443206517611246422944245077214035778529831198642997131725966633365520266930784297332554358743269582513125982070736168184463231257501147666235039856936758619962287224127462217899181431380749110624483441043813791223675322207707555956618770587208981573720919846554234432849886071965346594511242517114924137967847829591750727942755115692172497988369795219622584033874069145907439553222939015905280</span></span><br><span class="line"><span class="string">237348271212870069146218394147712821983756154361121125464843821356777343086464786262769510843094453963434423871359291400355493177339013648909538576312957298531245771260362473919076759706682735266855920298899200500046967238386252391851138198530671332478315828876262645843939174292712690021408705461921177334034837441241231182751353058298103009124765377211803579840406270396477937117875490192355651017855958671557749329097262800621575287211938761281102664405069806503929644344867737790185734896367903</span></span><br><span class="line"><span class="string">...</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>ç¬¬ä¸€æ¬¡çœ‹è¿™ä¸ªé¢˜ä¸€ç‚¹å¤´ç»ªéƒ½æ²¡æœ‰ï¼Œåæ¥ä»”ç»†ç ”ç©¶äº†ä¸€ä¸‹<code>ror()</code>ä¹‹åå‘ç°å¥½åƒä¸æ˜¯å¾ˆå¤æ‚ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ror = <span class="keyword">lambda</span> x, l, b: (x &gt;&gt; l) | ((x &amp; ((<span class="number">1</span>&lt;&lt;l)-<span class="number">1</span>)) &lt;&lt; (b-l))</span><br></pre></td></tr></table></figure>
<p>é¡ºç€åˆ†æäº†ä¸€ä¸‹è¿™ä¸ªä½è¿ç®—ï¼Œè¿™ä¸ªå‡½æ•°æŠŠxæ•°ålä½ç»™ç§»åˆ°äº†æœ€å‰é¢ï¼Œåœ¨é¢˜ç›®ä»£ç ä¸­ç”¨äº†ä¸€ä¸ªå¾ªç¯ï¼š</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m.bit_length()):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">pow</span>(ror(m, i, m.bit_length()), e, N))</span><br></pre></td></tr></table></figure>
<p>å¯¹äº<code>ror(m, i, m.bit_length())</code>éšç€içš„å¢å¤§ï¼Œè¢«æåˆ°æœ€å‰é¢çš„åä½è¶Šæ¥è¶Šå¤šï¼Œæ‰€ä»¥å¯ä»¥æ ¹æ®æ¯ä¸€è½®çš„æœ«ä½æ¥å¤åŸåŸæ•°ï¼Œeæ¬¡æ–¹å¹¶æ²¡æœ‰æ”¹å˜äºŒè¿›åˆ¶çš„æœ«ä½ï¼Œç”±äºnä¸ºå¶æ•°ï¼Œå«æœ‰å› å­2ï¼Œnçš„äºŒè¿›åˆ¶æœ«ä½ä¸€å®šä¸º0ï¼Œæ¨¡è¿ç®—ä¸ä¼šæ”¹å˜åŸæ•°çš„æœ«ä½å€¼ï¼Œæ‰€ä»¥ç›´æ¥æŠŠå¾—åˆ°çš„è¿™äº›æ•°æœ«ä½æå–å‡ºæ¥è¿˜åŸåŸæ•°å°±èƒ½å¾—åˆ°flagï¼š</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;chall.txt&#x27;</span>,<span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f=f.readlines()</span><br><span class="line">    num=[<span class="built_in">bin</span>(<span class="built_in">int</span>(i))[-<span class="number">1</span>] <span class="keyword">for</span> i <span class="keyword">in</span> f]</span><br><span class="line">    flag=<span class="string">&#x27;&#x27;</span>.join(num[<span class="built_in">len</span>(num)-i-<span class="number">1</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(num)))</span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(flag,<span class="number">2</span>)))</span><br></pre></td></tr></table></figure>
<h2 id="HUBUCTF-2022-æ–°ç”Ÿèµ›-ezMath"><a href="#HUBUCTF-2022-æ–°ç”Ÿèµ›-ezMath" class="headerlink" title="[HUBUCTF 2022 æ–°ç”Ÿèµ›]ezMath"></a>[HUBUCTF 2022 æ–°ç”Ÿèµ›]ezMath</h2><p>é¢˜ç›®ï¼šå°å­¦äºŒå¹´çº§æ•°å­¦ï¼Œåšå¯¹100é“å°±ç»™flagï¼Œç®€å•å§ã€‚</p>
<p>è¿™é“é¢˜ç»™äº†ncçš„ipå’Œç«¯å£ï¼Œæ²¡ç»™ä»£ç ï¼Œå…ˆè¿ä¸Šçœ‹çœ‹è¦å¹²å•¥ï¼š</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&quot;43.143.7.97&quot;</span>, <span class="number">28018</span>)</span><br><span class="line">p.interactive()</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">[+] sha256(XXXX+Vmadgdm6sxtjigB7) == 1aca8c61a88c891794e47ff8cbb6c3ded7bcb764df23c15d4a65ad591077a3e9</span></span><br><span class="line"><span class="string">[+] Plz Tell Me XXXX :</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>é¦–å…ˆéœ€è¦çˆ†ç ´ä¸€ä¸ªsha256ï¼Œç„¶åå‘é€çˆ†ç ´å€¼ï¼š</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sfsha</span>(<span class="params">str1, str2</span>):</span><br><span class="line">    t = string.ascii_letters+string.digits</span><br><span class="line">    <span class="keyword">for</span> a <span class="keyword">in</span> t:</span><br><span class="line">        <span class="keyword">for</span> b <span class="keyword">in</span> t:</span><br><span class="line">            <span class="keyword">for</span> c <span class="keyword">in</span> t:</span><br><span class="line">                <span class="keyword">for</span> d <span class="keyword">in</span> t:</span><br><span class="line">                    <span class="keyword">if</span> hashlib.sha256((a+b+c+d+str1.decode()).encode()).hexdigest() == str2.decode():</span><br><span class="line">                        <span class="keyword">return</span> a+b+c+d</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&quot;43.143.7.97&quot;</span>, <span class="number">28018</span>)</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;sha256(XXXX+&#x27;</span>)</span><br><span class="line">str1 = p.recvuntil(<span class="string">b&#x27;)&#x27;</span>, drop=<span class="literal">True</span>)</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;== &#x27;</span>)</span><br><span class="line">str2 = p.recvuntil(<span class="string">b&#x27;\n&#x27;</span>, drop=<span class="literal">True</span>)</span><br><span class="line">p.sendline((sfsha(str1, str2)).encode())</span><br></pre></td></tr></table></figure>
<blockquote>
<p>è¿™é‡Œéœ€è¦åˆ©ç”¨åˆ°pwntoolsåº“çš„ä¸€äº›å‡½æ•°ï¼Œåœ¨çŸ¥é“äº†è¿”å›çš„å†…å®¹ä¹‹åå¯ä»¥æ ¹æ®å…¶ç‰¹ç‚¹æ¥æˆªå–éœ€è¦çš„éƒ¨åˆ†ï¼šæˆ‘ä»¬éœ€è¦å·²çŸ¥çš„çˆ†ç ´å­—æ®µVmadgdm6sxtjigB7å’Œsha256å€¼ï¼Œ<code>p.recvuntil(b&#39;xxxxx&#39;)</code>è¿™ä¸ªå‡½æ•°å¯ä»¥æ¥æ”¶è¿”å›å†…å®¹æˆªæ­¢åˆ°æ‹¬å·å†…çš„å­—ç¬¦ä¸²åœæ­¢ï¼Œdropå±æ€§å¯ä»¥è®¾ç½®è¿”å›å€¼æ˜¯å¦åŒ…å«æ‹¬å·å†…å­—ç¬¦ä¸²ã€‚</p>
</blockquote>
<p>å‘é€çˆ†ç ´å€¼ä¹‹åç»§ç»­ç›‘å¬ï¼š</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">p.interactive()</span><br><span class="line"></span><br><span class="line">[+] Welcome to  Calc Service</span><br><span class="line">[+] <span class="number">44</span>//<span class="number">53</span> = ?</span><br></pre></td></tr></table></figure>
<p>è¿™å°±æ˜¯æ‰€è°“çš„100é“å°å­¦æ•°å­¦é¢˜ï¼Œæ ¹æ®å…¶ç‰¹ç‚¹å†™ä¸€ä¸ªå¾ªç¯è§£100æ¬¡å°±è¡Œï¼š</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sfsha</span>(<span class="params">str1, str2</span>):</span><br><span class="line">    t = string.ascii_letters+string.digits</span><br><span class="line">    <span class="keyword">for</span> a <span class="keyword">in</span> t:</span><br><span class="line">        <span class="keyword">for</span> b <span class="keyword">in</span> t:</span><br><span class="line">            <span class="keyword">for</span> c <span class="keyword">in</span> t:</span><br><span class="line">                <span class="keyword">for</span> d <span class="keyword">in</span> t:</span><br><span class="line">                    <span class="keyword">if</span> hashlib.sha256((a+b+c+d+str1.decode()).encode()).hexdigest() == str2.decode():</span><br><span class="line">                        <span class="keyword">return</span> a+b+c+d</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&quot;43.143.7.97&quot;</span>, <span class="number">28018</span>)</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;sha256(XXXX+&#x27;</span>)</span><br><span class="line">str1 = p.recvuntil(<span class="string">b&#x27;)&#x27;</span>, drop=<span class="literal">True</span>)</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;== &#x27;</span>)</span><br><span class="line">str2 = p.recvuntil(<span class="string">b&#x27;\n&#x27;</span>, drop=<span class="literal">True</span>)</span><br><span class="line">p.sendline((sfsha(str1, str2)).encode())</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">    l = p.recvline()</span><br><span class="line">    l = p.recvline()</span><br><span class="line">    c = <span class="built_in">eval</span>(l.split(<span class="string">b&#x27; &#x27;</span>)[<span class="number">1</span>])</span><br><span class="line">    <span class="built_in">print</span>(l.split(<span class="string">b&#x27; &#x27;</span>)[<span class="number">1</span>].decode(), <span class="string">&#x27;=&#x27;</span>, c)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(c).encode())</span><br><span class="line"><span class="built_in">print</span>(p.recv().decode())</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">28+17 = 45</span></span><br><span class="line"><span class="string">54%93 = 54</span></span><br><span class="line"><span class="string">86-94 = -8</span></span><br><span class="line"><span class="string">57+82 = 139</span></span><br><span class="line"><span class="string">34*76 = 2584</span></span><br><span class="line"><span class="string">37%26 = 11</span></span><br><span class="line"><span class="string">2*93 = 186</span></span><br><span class="line"><span class="string">17+90 = 107</span></span><br><span class="line"><span class="string">18-60 = -42</span></span><br><span class="line"><span class="string">45-35 = 10</span></span><br><span class="line"><span class="string">10*14 = 140</span></span><br><span class="line"><span class="string">95+30 = 125</span></span><br><span class="line"><span class="string">5+75 = 80</span></span><br><span class="line"><span class="string">40*97 = 3880</span></span><br><span class="line"><span class="string">58+35 = 93</span></span><br><span class="line"><span class="string">79%85 = 79</span></span><br><span class="line"><span class="string">17//38 = 0</span></span><br><span class="line"><span class="string">80-78 = 2</span></span><br><span class="line"><span class="string">55-40 = 15</span></span><br><span class="line"><span class="string">71*7 = 497</span></span><br><span class="line"><span class="string">60*83 = 4980</span></span><br><span class="line"><span class="string">90*31 = 2790</span></span><br><span class="line"><span class="string">40-78 = -38</span></span><br><span class="line"><span class="string">15%51 = 15</span></span><br><span class="line"><span class="string">60//40 = 1</span></span><br><span class="line"><span class="string">44+99 = 143</span></span><br><span class="line"><span class="string">58*68 = 3944</span></span><br><span class="line"><span class="string">41*30 = 1230</span></span><br><span class="line"><span class="string">87+38 = 125</span></span><br><span class="line"><span class="string">50-84 = -34</span></span><br><span class="line"><span class="string">12*33 = 396</span></span><br><span class="line"><span class="string">1+80 = 81</span></span><br><span class="line"><span class="string">63-23 = 40</span></span><br><span class="line"><span class="string">76%32 = 12</span></span><br><span class="line"><span class="string">73*20 = 1460</span></span><br><span class="line"><span class="string">86*46 = 3956</span></span><br><span class="line"><span class="string">1*73 = 73</span></span><br><span class="line"><span class="string">87%50 = 37</span></span><br><span class="line"><span class="string">6-80 = -74</span></span><br><span class="line"><span class="string">16%24 = 16</span></span><br><span class="line"><span class="string">93%41 = 11</span></span><br><span class="line"><span class="string">93*63 = 5859</span></span><br><span class="line"><span class="string">42%4 = 2</span></span><br><span class="line"><span class="string">97*8 = 776</span></span><br><span class="line"><span class="string">40%3 = 1</span></span><br><span class="line"><span class="string">80*66 = 5280</span></span><br><span class="line"><span class="string">41%43 = 41</span></span><br><span class="line"><span class="string">93-68 = 25</span></span><br><span class="line"><span class="string">75//42 = 1</span></span><br><span class="line"><span class="string">22%43 = 22</span></span><br><span class="line"><span class="string">51-71 = -20</span></span><br><span class="line"><span class="string">26//91 = 0</span></span><br><span class="line"><span class="string">40-99 = -59</span></span><br><span class="line"><span class="string">38-20 = 18</span></span><br><span class="line"><span class="string">29//50 = 0</span></span><br><span class="line"><span class="string">78//77 = 1</span></span><br><span class="line"><span class="string">50%34 = 16</span></span><br><span class="line"><span class="string">76//92 = 0</span></span><br><span class="line"><span class="string">52//8 = 6</span></span><br><span class="line"><span class="string">65-26 = 39</span></span><br><span class="line"><span class="string">78*31 = 2418</span></span><br><span class="line"><span class="string">54//91 = 0</span></span><br><span class="line"><span class="string">56//25 = 2</span></span><br><span class="line"><span class="string">16+27 = 43</span></span><br><span class="line"><span class="string">52+37 = 89</span></span><br><span class="line"><span class="string">4//81 = 0</span></span><br><span class="line"><span class="string">71-77 = -6</span></span><br><span class="line"><span class="string">71//47 = 1</span></span><br><span class="line"><span class="string">44-46 = -2</span></span><br><span class="line"><span class="string">27-38 = -11</span></span><br><span class="line"><span class="string">4*76 = 304</span></span><br><span class="line"><span class="string">28+40 = 68</span></span><br><span class="line"><span class="string">48+16 = 64</span></span><br><span class="line"><span class="string">59*66 = 3894</span></span><br><span class="line"><span class="string">99+62 = 161</span></span><br><span class="line"><span class="string">51+49 = 100</span></span><br><span class="line"><span class="string">47//62 = 0</span></span><br><span class="line"><span class="string">62+79 = 141</span></span><br><span class="line"><span class="string">84-22 = 62</span></span><br><span class="line"><span class="string">76%31 = 14</span></span><br><span class="line"><span class="string">40-7 = 33</span></span><br><span class="line"><span class="string">48*31 = 1488</span></span><br><span class="line"><span class="string">74-10 = 64</span></span><br><span class="line"><span class="string">61-31 = 30</span></span><br><span class="line"><span class="string">73%96 = 73</span></span><br><span class="line"><span class="string">27+69 = 96</span></span><br><span class="line"><span class="string">55-57 = -2</span></span><br><span class="line"><span class="string">67//72 = 0</span></span><br><span class="line"><span class="string">99*53 = 5247</span></span><br><span class="line"><span class="string">13*39 = 507</span></span><br><span class="line"><span class="string">3%42 = 3</span></span><br><span class="line"><span class="string">88*66 = 5808</span></span><br><span class="line"><span class="string">50+24 = 74</span></span><br><span class="line"><span class="string">52%63 = 52</span></span><br><span class="line"><span class="string">62*53 = 3286</span></span><br><span class="line"><span class="string">66+5 = 71</span></span><br><span class="line"><span class="string">16-14 = 2</span></span><br><span class="line"><span class="string">55*35 = 1925</span></span><br><span class="line"><span class="string">28*8 = 224</span></span><br><span class="line"><span class="string">61+7 = 68</span></span><br><span class="line"><span class="string">[+] Good Job!</span></span><br><span class="line"><span class="string">You get flag: NSSCTF&#123;dc9397ce-cb67-4557-8176-3dff71cb202b&#125;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>pythonçš„evalå‡½æ•°å¯ä»¥å¯»æ‰¾å­—ç¬¦ä¸²ä¸­ç¬¦åˆæ¡ä»¶çš„è¿ç®—å¼å¹¶è®¡ç®—è¿”å›å€¼ï¼Œä½†æ˜¯å®ƒä¼šè¯†åˆ«åˆ°pwntoolsåº“è¿”å›çš„[+]å¯¼è‡´æŠ¥é”™ï¼Œæ‰€ä»¥å®é™…ä½¿ç”¨å¯ä»¥ç¨å¾®å¤„ç†ä¸€ä¸‹è¿”å›å€¼ï¼Œæ–¹å¼å¹¶ä¸å”¯ä¸€ã€‚</p>
</blockquote>
<h2 id="å¹¿ä¸œå¼ºç½‘æ¯-2021-å›¢é˜Ÿç»„-RSA-and-BASE"><a href="#å¹¿ä¸œå¼ºç½‘æ¯-2021-å›¢é˜Ÿç»„-RSA-and-BASE" class="headerlink" title="[å¹¿ä¸œå¼ºç½‘æ¯ 2021 å›¢é˜Ÿç»„]RSA and BASE?"></a>[å¹¿ä¸œå¼ºç½‘æ¯ 2021 å›¢é˜Ÿç»„]RSA and BASE?</h2><p>é¢˜ç›®ï¼š</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">RSA:</span><br><span class="line">n=<span class="number">56661243519426563299920058134092862370737397949947210394843021856477420959615132553610830104961645574615005956183703191006421508461009698780382360943562001485153455401650697532951591191737164547520951628336941289873198979641173541232117518791706826699650307105202062429672725308809988269372149027026719779368169</span></span><br><span class="line">e=<span class="number">36269788044703267426177340992826172140174404390577736281478891381612294207666891529019937732720246602062358244751177942289155662197410594434293004130952671354973700999803850153697545606312859272554835232089533366743867361181786472126124169787094837977468259794816050397735724313560434944684790818009385459207329</span></span><br><span class="line">c=<span class="number">137954301101369152742229874240507191901061563449586247819350394387527789763579249250710679911626270895090455502283455665178389917777053863730286065809459077858674885530015624798882224173066151402222862023045940035652321621761390317038440821354117827990307003831352154618952447402389360183594248381165728338233</span></span><br><span class="line"></span><br><span class="line">BASE:</span><br><span class="line"><span class="string">&quot;GHI45FQRSCX****UVWJK67DELMNOPAB3&quot;</span></span><br></pre></td></tr></table></figure>
<p>å°±ç»™äº†å‡ ä¸ªæ•°ï¼Œå…ˆçœ‹åˆ°encï¼Œç›´æ¥ç»´çº³æ”»å‡»å¾—åˆ°<code>flag&#123;TCMDIEOH2MJFBLKHT2J7BLYZ2WUE5NYR2HNG====&#125;</code></p>
<p>é‡Œé¢çš„å†…å®¹å¾ˆæ˜æ˜¾æ˜¯base32åŠ å¯†è¿‡ï¼Œä½†æ˜¯è§£å¯†è¿‡åå‘ç°æ˜¯ä¹±ç ï¼Œé¢˜ç›®è¿˜ç»™äº†ä¸€è¡ŒBASEï¼ŒçŒœæµ‹æ˜¯è‡ªå®šä¹‰base32åŠ å¯†ï¼Œè€Œä¸”é‡Œé¢è¿˜æœ‰å››ä½æœªçŸ¥ï¼Œå¯ä»¥çˆ†ç ´ã€‚</p>
<p>è‡³äºå¦‚ä½•è¿›è¡Œè‡ªå®šä¹‰base32è§£å¯†ï¼Œæœ‰ä¸ªåŠæ³•æ˜¯é€šè¿‡ä¸‹æ ‡å¯¹åº”æ¥è½¬ä¸ºä¼ ç»Ÿå¯†æ–‡ï¼š</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="built_in">list</span> = [<span class="string">&#x27;T&#x27;</span>, <span class="string">&#x27;Y&#x27;</span>, <span class="string">&#x27;Z&#x27;</span>, <span class="string">&#x27;2&#x27;</span>]</span><br><span class="line">b32 = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">list</span>:</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">list</span>:</span><br><span class="line">        <span class="keyword">if</span> i != j:</span><br><span class="line">            <span class="keyword">for</span> h <span class="keyword">in</span> <span class="built_in">list</span>:</span><br><span class="line">                <span class="keyword">if</span> h != i <span class="keyword">and</span> h != j:</span><br><span class="line">                    <span class="keyword">for</span> g <span class="keyword">in</span> <span class="built_in">list</span>:</span><br><span class="line">                        <span class="keyword">if</span> h != g <span class="keyword">and</span> g != i <span class="keyword">and</span> g != j:</span><br><span class="line">                            key = i+j+h+g</span><br><span class="line">                            b32.append(key)</span><br><span class="line"></span><br><span class="line">cipher = <span class="string">&#x27;TCMDIEOH2MJFBLKHT2J7BLYZ2WUE5NYR2HNG====&#x27;</span></span><br><span class="line">base32 = <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZ234567&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> b32:</span><br><span class="line">    dic = <span class="string">&#x27;GHI45FQRSCX&#x27;</span> + i + <span class="string">&#x27;UVWJK67DELMNOPAB3&#x27;</span></span><br><span class="line">    res = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> cipher:</span><br><span class="line">        <span class="keyword">if</span> i <span class="keyword">in</span> base32:</span><br><span class="line">            res += base32[dic.index(i)]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            res += i</span><br><span class="line">    <span class="built_in">print</span>(base64.b32decode(res))</span><br></pre></td></tr></table></figure>
<p>èƒ½åœ¨ç»™å‡ºçš„å‡ ä¸ªç»“æœé‡Œæ‰¾åˆ°ä¸€ä¸ªåˆé€‚çš„ä½œä¸ºflagã€‚</p>
<h2 id="GKCTF-2021-RRRRsa"><a href="#GKCTF-2021-RRRRsa" class="headerlink" title="[GKCTF 2021]RRRRsa"></a>[GKCTF 2021]RRRRsa</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> gcd</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;xxxxxxxxxxxxx&#x27;</span></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">n = p*q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c=&#123;&#125;&#x27;</span>.<span class="built_in">format</span>(c))</span><br><span class="line"></span><br><span class="line">p1 = getPrime(<span class="number">512</span>)</span><br><span class="line">q1 = getPrime(<span class="number">512</span>)</span><br><span class="line">n1 = p1*q1</span><br><span class="line">e1 = <span class="number">65537</span></span><br><span class="line"><span class="keyword">assert</span> gcd(e1,(p1-<span class="number">1</span>)*(q1-<span class="number">1</span>)) == <span class="number">1</span></span><br><span class="line">c1 = <span class="built_in">pow</span>(p,e1,n1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;n1=&#123;&#125;&#x27;</span>.<span class="built_in">format</span>(n1))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c1=&#123;&#125;&#x27;</span>.<span class="built_in">format</span>(c1))</span><br><span class="line">hint1 = <span class="built_in">pow</span>(<span class="number">2020</span> * p1 + q1, <span class="number">202020</span>, n1)</span><br><span class="line">hint2 = <span class="built_in">pow</span>(<span class="number">2021</span> * p1 + <span class="number">212121</span>, q1, n1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;hint1=&#123;&#125;&#x27;</span>.<span class="built_in">format</span>(hint1))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;hint2=&#123;&#125;&#x27;</span>.<span class="built_in">format</span>(hint2))</span><br><span class="line"></span><br><span class="line">p2 = getPrime(<span class="number">512</span>)</span><br><span class="line">q2 = getPrime(<span class="number">512</span>)</span><br><span class="line">n2 = p2*q2</span><br><span class="line">e2 = <span class="number">65537</span></span><br><span class="line"><span class="keyword">assert</span> gcd(e1,(p2-<span class="number">1</span>)*(q2-<span class="number">1</span>)) == <span class="number">1</span></span><br><span class="line">c2 = <span class="built_in">pow</span>(q,e2,n2)</span><br><span class="line">hint3 = <span class="built_in">pow</span>(<span class="number">2020</span> * p2 + <span class="number">2021</span> * q2, <span class="number">202020</span>, n2)</span><br><span class="line">hint4 = <span class="built_in">pow</span>(<span class="number">2021</span> * p2 + <span class="number">2020</span> * q2, <span class="number">212121</span>, n2)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;n2=&#123;&#125;&#x27;</span>.<span class="built_in">format</span>(n2))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c2=&#123;&#125;&#x27;</span>.<span class="built_in">format</span>(c2))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;hint3=&#123;&#125;&#x27;</span>.<span class="built_in">format</span>(hint3))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;hint4=&#123;&#125;&#x27;</span>.<span class="built_in">format</span>(hint4))</span><br><span class="line"></span><br><span class="line"><span class="comment">#c=13492392717469817866883431475453770951837476241371989714683737558395769731416522300851917887957945766132864151382877462142018129852703437240533684604508379950293643294877725773675505912622208813435625177696614781601216465807569201380151669942605208425645258372134465547452376467465833013387018542999562042758</span></span><br><span class="line"><span class="comment">#n1=75003557379080252219517825998990183226659117019770735080523409561757225883651040882547519748107588719498261922816865626714101556207649929655822889945870341168644508079317582220034374613066751916750036253423990673764234066999306874078424803774652754587494762629397701664706287999727238636073466137405374927829</span></span><br><span class="line"><span class="comment">#c1=68111901092027813007099627893896838517426971082877204047110404787823279211508183783468891474661365139933325981191524511345219830693064573462115529345012970089065201176142417462299650761299758078141504126185921304526414911455395289228444974516503526507906721378965227166653195076209418852399008741560796631569</span></span><br><span class="line"><span class="comment">#hint1=23552090716381769484990784116875558895715552896983313406764042416318710076256166472426553520240265023978449945974218435787929202289208329156594838420190890104226497263852461928474756025539394996288951828172126419569993301524866753797584032740426259804002564701319538183190684075289055345581960776903740881951</span></span><br><span class="line"><span class="comment">#hint2=52723229698530767897979433914470831153268827008372307239630387100752226850798023362444499211944996778363894528759290565718266340188582253307004810850030833752132728256929572703630431232622151200855160886614350000115704689605102500273815157636476901150408355565958834764444192860513855376978491299658773170270</span></span><br><span class="line"><span class="comment">#n2=114535923043375970380117920548097404729043079895540320742847840364455024050473125998926311644172960176471193602850427607899191810616953021324742137492746159921284982146320175356395325890407704697018412456350862990849606200323084717352630282539156670636025924425865741196506478163922312894384285889848355244489</span></span><br><span class="line"><span class="comment">#c2=67054203666901691181215262587447180910225473339143260100831118313521471029889304176235434129632237116993910316978096018724911531011857469325115308802162172965564951703583450817489247675458024801774590728726471567407812572210421642171456850352167810755440990035255967091145950569246426544351461548548423025004</span></span><br><span class="line"><span class="comment">#hint3=25590923416756813543880554963887576960707333607377889401033718419301278802157204881039116350321872162118977797069089653428121479486603744700519830597186045931412652681572060953439655868476311798368015878628002547540835719870081007505735499581449077950263721606955524302365518362434928190394924399683131242077</span></span><br><span class="line"><span class="comment">#hint4=104100726926923869566862741238876132366916970864374562947844669556403268955625670105641264367038885706425427864941392601593437305258297198111819227915453081797889565662276003122901139755153002219126366611021736066016741562232998047253335141676203376521742965365133597943669838076210444485458296240951668402513</span></span><br></pre></td></tr></table></figure>
<p>å…ˆçœ‹hint1å’Œhint2ï¼š</p>
<script type="math/tex; mode=display">
(2020p_1 + q_1)^{202020}\equiv h_1 (\bmod n_1)</script><script type="math/tex; mode=display">
(2021p_1 + 212121)^{q_1} \equiv h_2(\bmod n_1)</script><p>æ ¹æ®åŒä½™çš„æ€§è´¨å’Œè´¹é©¬å°å®šç†ï¼Œå°†ä¸Šé¢ä¸¤ä¸ªå¼å­æ‹†åˆ†å˜å½¢ï¼š</p>
<script type="math/tex; mode=display">
(2020p_1)^{202020}\equiv h_1 (\bmod q_1)</script><script type="math/tex; mode=display">
2021p_1 + 212121 \equiv h_2(\bmod q_1)</script><p>å°†ä¸¤å¼æ”¾åœ¨ä¸€èµ·é…ä¸€ä¸‹å¯ä»¥å¾—åˆ°å«æœ‰pçš„å¼å­ï¼š</p>
<script type="math/tex; mode=display">
2021^{202020}h_1-[2020(h_2-212121)]^{202020}=kp_1</script><p>åŒç†ï¼Œhint3å’Œhint4ä¹Ÿå¯ä»¥ç”¨ç±»ä¼¼çš„æ–¹æ³•ï¼š</p>
<script type="math/tex; mode=display">
(2020p_2 + 2021q_2)^{202020}\equiv h_3(\bmod n_2)</script><script type="math/tex; mode=display">
(2021 p_2 + 2020  q_2)^{212121}\equiv h_4 (\bmod n_2)</script><p>å°†å…¶åŒ–ç®€ï¼Œé…æ–¹ï¼š</p>
<script type="math/tex; mode=display">
(2021q_2)^{202020}\equiv h_3(\bmod p_2)</script><script type="math/tex; mode=display">
(2020  q_2)^{212121}\equiv h_4 (\bmod p_2)</script><script type="math/tex; mode=display">
(2020^{202020}h_3)^{212121}-(2021^{212121}h_4)^{202020}=k'p_2</script><p>åˆ†åˆ«è§£ä¸¤æ¬¡RSAå¾—åˆ°pqä¹‹åå†è§£ä¸€è½®å¾—åˆ°flagï¼š</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">c=<span class="number">13492392717469817866883431475453770951837476241371989714683737558395769731416522300851917887957945766132864151382877462142018129852703437240533684604508379950293643294877725773675505912622208813435625177696614781601216465807569201380151669942605208425645258372134465547452376467465833013387018542999562042758</span></span><br><span class="line">n1=<span class="number">75003557379080252219517825998990183226659117019770735080523409561757225883651040882547519748107588719498261922816865626714101556207649929655822889945870341168644508079317582220034374613066751916750036253423990673764234066999306874078424803774652754587494762629397701664706287999727238636073466137405374927829</span></span><br><span class="line">c1=<span class="number">68111901092027813007099627893896838517426971082877204047110404787823279211508183783468891474661365139933325981191524511345219830693064573462115529345012970089065201176142417462299650761299758078141504126185921304526414911455395289228444974516503526507906721378965227166653195076209418852399008741560796631569</span></span><br><span class="line">hint1=<span class="number">23552090716381769484990784116875558895715552896983313406764042416318710076256166472426553520240265023978449945974218435787929202289208329156594838420190890104226497263852461928474756025539394996288951828172126419569993301524866753797584032740426259804002564701319538183190684075289055345581960776903740881951</span></span><br><span class="line">hint2=<span class="number">52723229698530767897979433914470831153268827008372307239630387100752226850798023362444499211944996778363894528759290565718266340188582253307004810850030833752132728256929572703630431232622151200855160886614350000115704689605102500273815157636476901150408355565958834764444192860513855376978491299658773170270</span></span><br><span class="line">n2=<span class="number">114535923043375970380117920548097404729043079895540320742847840364455024050473125998926311644172960176471193602850427607899191810616953021324742137492746159921284982146320175356395325890407704697018412456350862990849606200323084717352630282539156670636025924425865741196506478163922312894384285889848355244489</span></span><br><span class="line">c2=<span class="number">67054203666901691181215262587447180910225473339143260100831118313521471029889304176235434129632237116993910316978096018724911531011857469325115308802162172965564951703583450817489247675458024801774590728726471567407812572210421642171456850352167810755440990035255967091145950569246426544351461548548423025004</span></span><br><span class="line">hint3=<span class="number">25590923416756813543880554963887576960707333607377889401033718419301278802157204881039116350321872162118977797069089653428121479486603744700519830597186045931412652681572060953439655868476311798368015878628002547540835719870081007505735499581449077950263721606955524302365518362434928190394924399683131242077</span></span><br><span class="line">hint4=<span class="number">104100726926923869566862741238876132366916970864374562947844669556403268955625670105641264367038885706425427864941392601593437305258297198111819227915453081797889565662276003122901139755153002219126366611021736066016741562232998047253335141676203376521742965365133597943669838076210444485458296240951668402513</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">q1 = gmpy2.gcd(<span class="built_in">pow</span>(<span class="number">2021</span>,<span class="number">202020</span>)*hint1 - <span class="built_in">pow</span>(<span class="number">2020</span>*(hint2 - <span class="number">212121</span>), <span class="number">202020</span>, n1), n1)</span><br><span class="line">p1=n1//q1</span><br><span class="line">phi1=(p1-<span class="number">1</span>)*(q1-<span class="number">1</span>)</span><br><span class="line">d1=gmpy2.invert(e,phi1)</span><br><span class="line">p=<span class="built_in">pow</span>(c1,d1,n1)</span><br><span class="line">q2=gmpy2.gcd(<span class="built_in">pow</span>(<span class="built_in">pow</span>(<span class="number">2020</span>,<span class="number">202020</span>)*hint3,<span class="number">212121</span>,n2)-<span class="built_in">pow</span>(<span class="built_in">pow</span>(<span class="number">2021</span>,<span class="number">212121</span>)*hint4,<span class="number">202020</span>,n2),n2)</span><br><span class="line">p2=n2//q2</span><br><span class="line">phi2=(p2-<span class="number">1</span>)*(q2-<span class="number">1</span>)</span><br><span class="line">d2=gmpy2.invert(e,phi2)</span><br><span class="line">q=<span class="built_in">pow</span>(c2,d2,n2)</span><br><span class="line">n=p*q</span><br><span class="line">phi=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d=gmpy2.invert(e,phi)</span><br><span class="line">m=<span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>
<h1 id="WEEK-4"><a href="#WEEK-4" class="headerlink" title="WEEK 4"></a>WEEK 4</h1><h2 id="MTCTF-2021-hamburgerRSA"><a href="#MTCTF-2021-hamburgerRSA" class="headerlink" title="[MTCTF 2021]hamburgerRSA"></a>[MTCTF 2021]hamburgerRSA</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">flag = <span class="built_in">open</span>(<span class="string">&#x27;flag.txt&#x27;</span>).read()</span><br><span class="line">nbit = <span class="number">64</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    p, q = getPrime(nbit), getPrime(nbit)</span><br><span class="line">    PP = <span class="built_in">int</span>(<span class="built_in">str</span>(p) + <span class="built_in">str</span>(p) + <span class="built_in">str</span>(q) + <span class="built_in">str</span>(q))</span><br><span class="line">    QQ = <span class="built_in">int</span>(<span class="built_in">str</span>(q) + <span class="built_in">str</span>(q) + <span class="built_in">str</span>(p) + <span class="built_in">str</span>(p))</span><br><span class="line">    <span class="keyword">if</span> isPrime(PP) <span class="keyword">and</span> isPrime(QQ):</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">n = PP * QQ</span><br><span class="line">m = bytes_to_long(flag.encode())</span><br><span class="line">c = <span class="built_in">pow</span>(m, <span class="number">65537</span>, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;n =&#x27;</span>, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c =&#x27;</span>, c)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n = 177269125756508652546242326065138402971542751112423326033880862868822164234452280738170245589798474033047460920552550018968571267978283756742722231922451193</span></span><br><span class="line"><span class="string">c = 47718022601324543399078395957095083753201631332808949406927091589044837556469300807728484035581447960954603540348152501053100067139486887367207461593404096</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>è¿™é¢˜å¯¹pqç”Ÿæˆç”¨äº†ä¸€ç§ç‰¹æ®Šçš„æ–¹æ³•ï¼Œåœ¨å¾—åˆ°å› å­ä¹‹å‰ï¼Œéœ€è¦å…ˆäº†è§£ä¸€ä¸‹ä½æ•°å’Œä¹˜æ³•ä¹‹é—´çš„å…³ç³»ï¼š</p>
<p>å¯¹äº64bitçš„på’Œqï¼Œå…ˆè¯•ä¸€ä¸‹å®ƒä»¬åœ¨åè¿›åˆ¶ä¸‹çš„ä½æ•°é•¿åº¦å’Œä¹˜ç§¯é•¿åº¦ï¼š</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    p = getPrime(<span class="number">64</span>)</span><br><span class="line">    q = getPrime(<span class="number">64</span>)</span><br><span class="line">    res = p*q</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">len</span>(<span class="built_in">str</span>(p)),end=<span class="string">&quot; &quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">len</span>(<span class="built_in">str</span>(q)),end=<span class="string">&quot; &quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">len</span>(<span class="built_in">str</span>(res)))</span><br></pre></td></tr></table></figure>
<p>på’Œqå¤§éƒ¨åˆ†ä¸º20ä½ï¼Œå°‘æ•°ä¼šç”Ÿæˆ19ä½ã€‚å…¨ä¸º20ä½æ—¶ä¹˜ç§¯ä¸º39ä½ï¼Œå•ä¸ªä¸º19ä½æ—¶ä¹˜ç§¯æœ‰ä¸€å®šå¯èƒ½ä¸º38ä½ï¼Œå¦‚æœä¸¤ä¸ª19ä½æ—¶ä¹˜ç§¯ä¸º38ä½ã€‚</p>
<p>æˆ‘ä»¬éœ€è¦å¤§è‡´åˆ¤æ–­å‡ºæ¥æœ¬é¢˜çš„på’Œqå¤§æ¦‚ä¸ºå¤šå°‘ä½ï¼Œå…ˆè®¾ä¸ºxå’Œyï¼š</p>
<script type="math/tex; mode=display">
PP=10^{x+2y}p+10^{2y}p+10^yq+q</script><script type="math/tex; mode=display">
QQ=10^{2x+y}q+10^{2x}q+10^xp+p</script><script type="math/tex; mode=display">
n=PPQQ=10^{3x+3y}pq+10^{3x+2y}pq+10^{2x+3y}pq...+10^ypq+10^xpq+pq</script><p>ç”±ä¸Šå¼å¯ä»¥è§‚å¯Ÿåˆ°ï¼šå†³å®šnçš„ä½æ•°çš„å°±æ˜¯ç¬¬ä¸€é¡¹ï¼Œè¿™é¢˜çš„nä¸º156ä½ï¼Œå¦‚æœxyå…¨ä¸º20ï¼Œç¬¬ä¸€é¡¹çš„ä½æ•°å°±ä¸º120+39=159ä½ï¼Œä¸æ»¡è¶³è¦æ±‚ï¼Œå¦‚æœå…¶ä¸­ä¸€ä¸ªä¸º19ä½ï¼Œä½æ•°ä¸º117+39(38)=156(155)ï¼ŒåŸºæœ¬ç¬¦åˆè¦æ±‚ï¼Œæ‰€ä»¥på’Œqçš„ä½æ•°å…³ç³»åº”è¯¥ä¸º1ä¸ª20ä½ã€1ä¸ª19ä½ï¼Œpqä¹˜ç§¯ä¸º39ä½ã€‚</p>
<p>ç”±äºPPQQä½æ•°å¤ªå¤§æ„æˆå¼å­å¤æ‚ä¸å¥½åˆ†è§£ï¼Œpqåªæœ‰39ä½æ¯”è¾ƒå¥½å› å¼åˆ†è§£ï¼Œéœ€è¦å¾—åˆ°pqï¼Œåœ¨ç»™å‡ºnçš„å¤šé¡¹å¼å‰ä¸‰é¡¹é‡Œï¼ŒåŒ…å«å®é™…æ•°æ®çš„ä½æ•°åˆ†åˆ«ä¸º118-156ï¼›98-136ï¼›99-137</p>
<p>æ‰€ä»¥ï¼Œnçš„138-156ä½æ˜¯å·²çŸ¥çš„â€œçº¯å‡€â€çš„pqä¹˜ç§¯ï¼Œæ€»å…±19ä½ï¼ŒåŒç†ï¼Œå¯ä»¥å¾—åˆ°ä½ä½ä¸‰é¡¹ä½æ•°èŒƒå›´1-39ï¼›20-58ï¼›21-59ï¼›çš„19ä½ï¼Œç¼ºå°‘ä¸­é—´çš„ä¸€ä½ï¼Œå¯ä»¥çˆ†ç ´ä¸€ä¸‹æŒ¨ä¸ªå› å¼åˆ†è§£ä¸€ä¸‹çœ‹çœ‹å“ªä¸ªèƒ½åˆ†è§£æˆä¸¤ä¸ªbit=64çš„å› å­ï¼š</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n=<span class="number">177269125756508652546242326065138402971542751112423326033880862868822164234452280738170245589798474033047460920552550018968571267978283756742722231922451193</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">str</span>(n)[:<span class="number">19</span>],<span class="built_in">str</span>(n)[-<span class="number">19</span>:])</span><br><span class="line">res1=<span class="number">1772691257565086525</span></span><br><span class="line">res2=<span class="number">6742722231922451193</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">10</span>):</span><br><span class="line">    pq=<span class="built_in">int</span>(<span class="built_in">str</span>(res1)+<span class="built_in">str</span>(i)+<span class="built_in">str</span>(res2))</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> isPrime(pq):</span><br><span class="line">        <span class="built_in">print</span>(i,pq)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">0 177269125756508652506742722231922451193</span></span><br><span class="line"><span class="string">1 177269125756508652516742722231922451193</span></span><br><span class="line"><span class="string">2 177269125756508652526742722231922451193</span></span><br><span class="line"><span class="string">3 177269125756508652536742722231922451193</span></span><br><span class="line"><span class="string">4 177269125756508652546742722231922451193</span></span><br><span class="line"><span class="string">5 177269125756508652556742722231922451193</span></span><br><span class="line"><span class="string">6 177269125756508652566742722231922451193</span></span><br><span class="line"><span class="string">7 177269125756508652576742722231922451193</span></span><br><span class="line"><span class="string">8 177269125756508652586742722231922451193</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>å½“ä¸­é—´ä½ä¸º2æ—¶ï¼Œèƒ½åˆ†è§£å‡ºpqä¸¤ä¸ªå› å­ï¼Œç ´è§£RSAï¼š</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">n = <span class="number">177269125756508652546242326065138402971542751112423326033880862868822164234452280738170245589798474033047460920552550018968571267978283756742722231922451193</span></span><br><span class="line">c = <span class="number">47718022601324543399078395957095083753201631332808949406927091589044837556469300807728484035581447960954603540348152501053100067139486887367207461593404096</span></span><br><span class="line">a = <span class="number">18109858317913867117</span></span><br><span class="line">b = <span class="number">9788542938580474429</span></span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">p=<span class="built_in">int</span>(<span class="built_in">str</span>(a)+<span class="built_in">str</span>(a)+<span class="built_in">str</span>(b)+<span class="built_in">str</span>(b))</span><br><span class="line">q=<span class="built_in">int</span>(<span class="built_in">str</span>(b)+<span class="built_in">str</span>(b)+<span class="built_in">str</span>(a)+<span class="built_in">str</span>(a))</span><br><span class="line">phi=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d=gmpy2.invert(e,phi)</span><br><span class="line">m=<span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>
<h2 id="é¹åŸæ¯-2022-babyrsa"><a href="#é¹åŸæ¯-2022-babyrsa" class="headerlink" title="[é¹åŸæ¯ 2022]babyrsa"></a>[é¹åŸæ¯ 2022]babyrsa</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> libnum <span class="keyword">import</span> s2n</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">16</span>)</span><br><span class="line">n = p*q</span><br><span class="line">m = s2n(flag)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,p-q):</span><br><span class="line">    m = m*i%n</span><br><span class="line">e = <span class="number">1049</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">pow</span>(<span class="number">2</span>,e,n))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">pow</span>(m,e,n))</span><br><span class="line"><span class="comment">#4513855932190587780512692251070948513905472536079140708186519998265613363916408288602023081671609336332823271976169443708346965729874135535872958782973382975364993581165018591335971709648749814573285241290480406050308656233944927823668976933579733318618949138978777831374262042028072274386196484449175052332019377</span></span><br><span class="line"><span class="comment">#3303523331971096467930886326777599963627226774247658707743111351666869650815726173155008595010291772118253071226982001526457616278548388482820628617705073304972902604395335278436888382882457685710065067829657299760804647364231959804889954665450340608878490911738748836150745677968305248021749608323124958372559270</span></span><br></pre></td></tr></table></figure>
<p>çœ‹åˆ°mæƒ³åˆ°äº†å¨å°”é€Šå®šç†ï¼Œä¸è¿‡åœ¨æ­¤ä¹‹å‰ï¼Œå¯ä»¥å…ˆæŠŠnå› å¼åˆ†è§£å‡ºæ¥ï¼Œå°½ç®¡æ²¡ç»™nï¼Œå¯ä»¥æ ¹æ®$2^{1049}$æ±‚å‡ºnï¼š</p>
<script type="math/tex; mode=display">
2^{1049}-c_1=kn</script><p>ç”¨yafuçˆ†ä¸€ä¸‹ï¼Œç”±äºpqå·®è·å¤ªå¤§ï¼Œèƒ½é¡ºå¸¦æ±‚å¾—nå› å¼åˆ†è§£çš„ç»“æœï¼Œè¿™å°±æ–¹ä¾¿å¾ˆå¤šäº†ï¼š</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> sympy</span><br><span class="line"></span><br><span class="line">e=<span class="number">1049</span></span><br><span class="line">p=<span class="number">170229264879724117919007372149468684565431232721075153274808454126426741324966131188484635914814926870341378228417496808202497615585946352638507704855332363766887139815236730403246238633855524068161116748612090155595549964229654262432946553891601975628848891407847198187453488358420350203927771308228162321231</span></span><br><span class="line">q=<span class="number">34211</span></span><br><span class="line">n=<span class="number">170229264879724117919007372149468684565431232721075153274808454126426741324966131188484635914814926870341378228417496808202497615585946352638507704855332363766887139815236730403246238633855524068161116748612090155595549964229654262432946553891601975628848891407847198187453488358420350203927771308228162321231</span>*<span class="number">34211</span></span><br><span class="line">c=<span class="number">3303523331971096467930886326777599963627226774247658707743111351666869650815726173155008595010291772118253071226982001526457616278548388482820628617705073304972902604395335278436888382882457685710065067829657299760804647364231959804889954665450340608878490911738748836150745677968305248021749608323124958372559270</span></span><br><span class="line">phi=<span class="built_in">int</span>(sympy.totient(n))</span><br><span class="line">d=gmpy2.invert(e,phi)</span><br><span class="line">M=<span class="built_in">pow</span>(c,d,n)</span><br></pre></td></tr></table></figure>
<p>æ±‚å‡ºMä¹‹åç”¨å¨å°”é€Šå®šç†æ±‚è§£mï¼š</p>
<script type="math/tex; mode=display">
M\equiv m(p-q-1)!(\bmod p)</script><script type="math/tex; mode=display">
-1\equiv(p-1)!(\bmod p)</script><p>ä¸¤å¼ç›¸é™¤ï¼š</p>
<script type="math/tex; mode=display">
m\equiv -M(p-q)...(p-1)(\bmod p)</script><p>ç®€åŒ–è¿ç®—åå¯ä»¥æ±‚è§£ï¼š</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> sympy</span><br><span class="line"></span><br><span class="line">e=<span class="number">1049</span></span><br><span class="line">n=<span class="number">170229264879724117919007372149468684565431232721075153274808454126426741324966131188484635914814926870341378228417496808202497615585946352638507704855332363766887139815236730403246238633855524068161116748612090155595549964229654262432946553891601975628848891407847198187453488358420350203927771308228162321231</span>*<span class="number">34211</span></span><br><span class="line">c=<span class="number">3303523331971096467930886326777599963627226774247658707743111351666869650815726173155008595010291772118253071226982001526457616278548388482820628617705073304972902604395335278436888382882457685710065067829657299760804647364231959804889954665450340608878490911738748836150745677968305248021749608323124958372559270</span></span><br><span class="line">phi=<span class="built_in">int</span>(sympy.totient(n))</span><br><span class="line">d=gmpy2.invert(e,phi)</span><br><span class="line">M=<span class="built_in">pow</span>(c,d,n)</span><br><span class="line">m=<span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(p-q,p):</span><br><span class="line">    m = m*i%p</span><br><span class="line">m=(-M)*m%p</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>
<h2 id="ç¾ŠåŸæ¯-2021-Easy-Rsa"><a href="#ç¾ŠåŸæ¯-2021-Easy-Rsa" class="headerlink" title="[ç¾ŠåŸæ¯ 2021]Easy_Rsa"></a>[ç¾ŠåŸæ¯ 2021]Easy_Rsa</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_prime</span>(<span class="params">nbits, gamma</span>):</span><br><span class="line">    g = getPrime(<span class="built_in">int</span>(nbits * gamma))</span><br><span class="line">    alpha = <span class="number">0.5</span> - gamma</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        a = getRandomNBitInteger(<span class="built_in">int</span>(alpha * nbits))</span><br><span class="line">        p = <span class="number">2</span> * g * a + <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> isPrime(p):</span><br><span class="line">            b = getRandomNBitInteger(<span class="built_in">int</span>(alpha * nbits))</span><br><span class="line">            q = <span class="number">2</span> * g * b + <span class="number">1</span></span><br><span class="line">            h = <span class="number">2</span> * g * a * b + a + b</span><br><span class="line">            <span class="keyword">while</span> <span class="keyword">not</span> isPrime(q) <span class="keyword">or</span> isPrime(h) <span class="keyword">or</span> gmpy2.gcd(a, b) != <span class="number">1</span>:</span><br><span class="line">                b = getRandomNBitInteger(<span class="built_in">int</span>(alpha * nbits))</span><br><span class="line">                q = <span class="number">2</span> * g * b + <span class="number">1</span></span><br><span class="line">            <span class="keyword">return</span> p, q</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">nbits, gamma</span>):</span><br><span class="line">    p, q = gen_prime(nbits, gamma)</span><br><span class="line">    n = p * q</span><br><span class="line">    e = getPrime(<span class="number">16</span>)</span><br><span class="line">    <span class="keyword">while</span> gmpy2.gcd(e, gmpy2.lcm(p-<span class="number">1</span>,q-<span class="number">1</span>)) != <span class="number">1</span>:</span><br><span class="line">        e = getPrime(<span class="number">16</span>)</span><br><span class="line">    m = bytes_to_long(flag)</span><br><span class="line">    c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line">    <span class="keyword">return</span> n, e, c</span><br><span class="line"></span><br><span class="line">n, e, c = encrypt(<span class="number">1024</span>, <span class="number">0.48</span>)</span><br><span class="line"><span class="built_in">print</span> <span class="string">&#x27;n =&#x27;</span>, n</span><br><span class="line"><span class="built_in">print</span> <span class="string">&#x27;e =&#x27;</span>, e</span><br><span class="line"><span class="built_in">print</span> <span class="string">&#x27;c =&#x27;</span>, c</span><br><span class="line"></span><br><span class="line"><span class="comment"># n = 84236796025318186855187782611491334781897277899439717384242559751095347166978304126358295609924321812851255222430530001043539925782811895605398187299748256080526691975084042025794113521587064616352833904856626744098904922117855866813505228134381046907659080078950018430266048447119221001098505107823645953039</span></span><br><span class="line"><span class="comment"># e = 58337</span></span><br><span class="line"><span class="comment"># c = 13646200911032594651110040891135783560995665642049282201695300382255436792102048169200570930229947213493204600006876822744757042959653203573780257603577712302687497959686258542388622714078571068849217323703865310256200818493894194213812410547780002879351619924848073893321472704218227047519748394961963394668</span></span><br></pre></td></tr></table></figure>
<p>è¿™é¢˜ç”¨äº†pollardrhoç®—æ³•çš„å˜ç§ï¼Œå…ˆè®°ç€è„šæœ¬ï¼Œæ²¡æ‰¾åˆ°ç®—æ³•ï¼š</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> invert</span><br><span class="line"></span><br><span class="line">f = <span class="keyword">lambda</span> x,n: (<span class="built_in">pow</span>(x, n - <span class="number">1</span>, n) + <span class="number">3</span>) % n</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">phllard_rho</span>(<span class="params">n</span>):</span><br><span class="line">    i = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        a = getRandomRange(<span class="number">2</span>, n)</span><br><span class="line">        b = f(a, n)</span><br><span class="line">        j = <span class="number">1</span></span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            p = GCD(<span class="built_in">abs</span>(a - b), n)</span><br><span class="line">            <span class="keyword">if</span> p == n:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">elif</span> p &gt; <span class="number">1</span>:</span><br><span class="line">                <span class="keyword">return</span> (p, n // p)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                a = f(a, n)</span><br><span class="line">                b = f(f(b, n), n)</span><br><span class="line">            j += <span class="number">1</span></span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">n = <span class="number">84236796025318186855187782611491334781897277899439717384242559751095347166978304126358295609924321812851255222430530001043539925782811895605398187299748256080526691975084042025794113521587064616352833904856626744098904922117855866813505228134381046907659080078950018430266048447119221001098505107823645953039</span></span><br><span class="line">c = <span class="number">13646200911032594651110040891135783560995665642049282201695300382255436792102048169200570930229947213493204600006876822744757042959653203573780257603577712302687497959686258542388622714078571068849217323703865310256200818493894194213812410547780002879351619924848073893321472704218227047519748394961963394668</span></span><br><span class="line">e = <span class="number">58337</span></span><br><span class="line"></span><br><span class="line">p,q = phllard_rho(n)</span><br><span class="line">d = invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">pow</span>(c,d,n)))</span><br></pre></td></tr></table></figure>
<h2 id="å¼ºç½‘æ¯-2022-ASR"><a href="#å¼ºç½‘æ¯-2022-ASR" class="headerlink" title="[å¼ºç½‘æ¯ 2022]ASR"></a>[å¼ºç½‘æ¯ 2022]ASR</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> falg</span><br><span class="line">pad = <span class="keyword">lambda</span> s:s + <span class="built_in">bytes</span>([(<span class="built_in">len</span>(s)-<span class="number">1</span>)%<span class="number">16</span>+<span class="number">1</span>]*((<span class="built_in">len</span>(s)-<span class="number">1</span>)%<span class="number">16</span>+<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">n = getPrime(<span class="number">128</span>)**<span class="number">2</span> * getPrime(<span class="number">128</span>)**<span class="number">2</span> * getPrime(<span class="number">128</span>)**<span class="number">2</span> * getPrime(<span class="number">128</span>)**<span class="number">2</span></span><br><span class="line">e = <span class="number">3</span></span><br><span class="line"></span><br><span class="line">flag = pad(flag)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="keyword">assert</span>(<span class="built_in">len</span>(flag) &gt;= <span class="number">48</span>)</span><br><span class="line">m = <span class="built_in">int</span>.from_bytes(flag,<span class="string">&#x27;big&#x27;</span>)</span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;n = <span class="subst">&#123;n&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;e = <span class="subst">&#123;e&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c = <span class="subst">&#123;c&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n = 8250871280281573979365095715711359115372504458973444367083195431861307534563246537364248104106494598081988216584432003199198805753721448450911308558041115465900179230798939615583517756265557814710419157462721793864532239042758808298575522666358352726060578194045804198551989679722201244547561044646931280001</span></span><br><span class="line"><span class="string">e = 3</span></span><br><span class="line"><span class="string">c = 945272793717722090962030960824180726576357481511799904903841312265308706852971155205003971821843069272938250385935597609059700446530436381124650731751982419593070224310399320617914955227288662661442416421725698368791013785074809691867988444306279231013360024747585261790352627234450209996422862329513284149</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>å¯¹äºnæœ‰ï¼š</p>
<script type="math/tex; mode=display">
n=(pqrs)^2</script><p>pqrséƒ½æ˜¯128ä½å°å› å­ï¼Œæˆ–è€…ç½‘ç«™æˆ–è€…yafuçˆ†ç ´å¯ä»¥å¾—åˆ°å››ä¸ªå› å­ï¼Œå°è¯•ç›´æ¥æ±‚phiè§£RSAï¼Œå‘ç°phiå’Œeæœ‰ä¸äº’è´¨ï¼Œå†çœ‹çœ‹æ˜¯è°ä¸äº’è´¨ï¼š</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(gmpy2.gcd(e,p-<span class="number">1</span>),gmpy2.gcd(e,q-<span class="number">1</span>),gmpy2.gcd(e,r-<span class="number">1</span>),gmpy2.gcd(e,s-<span class="number">1</span>))</span><br><span class="line"><span class="comment">#3 1 3 1</span></span><br></pre></td></tr></table></figure>
<p>æœ‰ä¸¤ä¸ªå› å­ä½¿å¾—eå’Œphiä¸äº’ç´ ï¼Œå»æ‰è¿™ä¸¤ä¸ªå› å­æ ¹æ®åŒä½™æ€§è´¨æ„é€ æ–°RSAæ±‚è§£ï¼š</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n=<span class="number">8250871280281573979365095715711359115372504458973444367083195431861307534563246537364248104106494598081988216584432003199198805753721448450911308558041115465900179230798939615583517756265557814710419157462721793864532239042758808298575522666358352726060578194045804198551989679722201244547561044646931280001</span></span><br><span class="line">p=<span class="number">218566259296037866647273372633238739089</span></span><br><span class="line">q=<span class="number">223213222467584072959434495118689164399</span></span><br><span class="line">r=<span class="number">225933944608558304529179430753170813347</span></span><br><span class="line">s=<span class="number">260594583349478633632570848336184053653</span></span><br><span class="line">e=<span class="number">3</span></span><br><span class="line">c = <span class="number">945272793717722090962030960824180726576357481511799904903841312265308706852971155205003971821843069272938250385935597609059700446530436381124650731751982419593070224310399320617914955227288662661442416421725698368791013785074809691867988444306279231013360024747585261790352627234450209996422862329513284149</span></span><br><span class="line"><span class="built_in">print</span>(gmpy2.gcd(e,p-<span class="number">1</span>),gmpy2.gcd(e,q-<span class="number">1</span>),gmpy2.gcd(e,r-<span class="number">1</span>),gmpy2.gcd(e,s-<span class="number">1</span>))</span><br><span class="line">phi=q*s*(q-<span class="number">1</span>)*(s-<span class="number">1</span>)</span><br><span class="line">n=q*s*q*s</span><br><span class="line">d=gmpy2.invert(e,phi)</span><br><span class="line">m=<span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>
<blockquote>
<p>æ³¨æ„åˆ°è¿™é‡Œéœ€è¦ä¸¤ä¸ªqå’Œsï¼Œå› ä¸ºå¦‚æœåªç”¨å•ä¸ªpå’Œsçš„è¯åŸå§‹mçš„é•¿åº¦ä¸å¤Ÿï¼Œéœ€è¦ä¸¤ç»„qå’Œsã€‚</p>
</blockquote>
<p>è¿™é¢˜çœ‹wpè¿˜æœ‰ä¸€ç§åšæ³•ï¼Œç”¨ä¸­å›½å‰©ä½™å®šç†åˆ†åˆ«åœ¨æœ‰é™åŸŸå¼€ä¸‰æ¬¡æ–¹æ ¹ï¼š</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n = <span class="number">8250871280281573979365095715711359115372504458973444367083195431861307534563246537364248104106494598081988216584432003199198805753721448450911308558041115465900179230798939615583517756265557814710419157462721793864532239042758808298575522666358352726060578194045804198551989679722201244547561044646931280001</span></span><br><span class="line">e = <span class="number">3</span></span><br><span class="line">c = <span class="number">945272793717722090962030960824180726576357481511799904903841312265308706852971155205003971821843069272938250385935597609059700446530436381124650731751982419593070224310399320617914955227288662661442416421725698368791013785074809691867988444306279231013360024747585261790352627234450209996422862329513284149</span></span><br><span class="line">p = <span class="number">225933944608558304529179430753170813347</span></span><br><span class="line">q = <span class="number">260594583349478633632570848336184053653</span></span><br><span class="line">r = <span class="number">218566259296037866647273372633238739089</span></span><br><span class="line">t = <span class="number">223213222467584072959434495118689164399</span></span><br><span class="line"></span><br><span class="line">R.&lt;x&gt; = Zmod(p)[]</span><br><span class="line">f = x^e-c</span><br><span class="line">f = f.monic()</span><br><span class="line">results1 = f.roots()</span><br><span class="line"></span><br><span class="line">R.&lt;x&gt; = Zmod(q)[]</span><br><span class="line">f = x^e-c</span><br><span class="line">f = f.monic()</span><br><span class="line">results2 = f.roots()</span><br><span class="line"></span><br><span class="line">R.&lt;x&gt; = Zmod(r)[]</span><br><span class="line">f = x^e-c</span><br><span class="line">f = f.monic()</span><br><span class="line">results3 = f.roots()</span><br><span class="line"></span><br><span class="line">R.&lt;x&gt; = Zmod(t)[]</span><br><span class="line">f = x^e-c</span><br><span class="line">f = f.monic()</span><br><span class="line">results4 = f.roots()</span><br><span class="line"><span class="keyword">for</span> a <span class="keyword">in</span> results1:</span><br><span class="line">    <span class="keyword">for</span> b <span class="keyword">in</span> results2:</span><br><span class="line">        <span class="keyword">for</span> c <span class="keyword">in</span> results3:</span><br><span class="line">             <span class="keyword">for</span> d <span class="keyword">in</span> results4:</span><br><span class="line">                list1=[<span class="built_in">int</span>(a[<span class="number">0</span>]),<span class="built_in">int</span>(b[<span class="number">0</span>]),<span class="built_in">int</span>(c[<span class="number">0</span>]),<span class="built_in">int</span>(d[<span class="number">0</span>])]</span><br><span class="line">                list2=[p,q,r,t]</span><br><span class="line">                m = CRT_list(list1,list2)</span><br><span class="line">                flag = long_to_bytes(<span class="built_in">int</span>(m))</span><br><span class="line">                <span class="keyword">if</span> <span class="string">b&#x27;flag&#x27;</span> <span class="keyword">in</span> flag:</span><br><span class="line">                    <span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>
<h2 id="watevrCTF-2019-ECC-RSA"><a href="#watevrCTF-2019-ECC-RSA" class="headerlink" title="[watevrCTF 2019]ECC-RSA"></a>[watevrCTF 2019]ECC-RSA</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> fastecdsa.curve <span class="keyword">import</span> P521 <span class="keyword">as</span> Curve</span><br><span class="line"><span class="keyword">from</span> fastecdsa.point <span class="keyword">import</span> Point</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long, isPrime</span><br><span class="line"><span class="keyword">from</span> os <span class="keyword">import</span> urandom</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> getrandbits</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_rsa_primes</span>(<span class="params">G</span>):</span><br><span class="line">	urand = bytes_to_long(urandom(<span class="number">521</span>//<span class="number">8</span>))</span><br><span class="line">	<span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">		s = getrandbits(<span class="number">521</span>) ^ urand</span><br><span class="line"></span><br><span class="line">		Q = s*G</span><br><span class="line">		<span class="keyword">if</span> isPrime(Q.x) <span class="keyword">and</span> isPrime(Q.y):</span><br><span class="line">			<span class="built_in">print</span>(<span class="string">&quot;ECC Private key:&quot;</span>, <span class="built_in">hex</span>(s))</span><br><span class="line">			<span class="built_in">print</span>(<span class="string">&quot;RSA primes:&quot;</span>, <span class="built_in">hex</span>(Q.x), <span class="built_in">hex</span>(Q.y))</span><br><span class="line">			<span class="built_in">print</span>(<span class="string">&quot;Modulo:&quot;</span>, <span class="built_in">hex</span>(Q.x * Q.y))</span><br><span class="line">			<span class="keyword">return</span> (Q.x, Q.y)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">flag = <span class="built_in">int</span>.from_bytes(<span class="built_in">input</span>(), byteorder=<span class="string">&quot;big&quot;</span>)</span><br><span class="line"></span><br><span class="line">ecc_p = Curve.p</span><br><span class="line">a = Curve.a</span><br><span class="line">b = Curve.b</span><br><span class="line"></span><br><span class="line">Gx = Curve.gx</span><br><span class="line">Gy = Curve.gy</span><br><span class="line">G = Point(Gx, Gy, curve=Curve)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">p, q = gen_rsa_primes(G)</span><br><span class="line">n = p*q</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">file_out = <span class="built_in">open</span>(<span class="string">&quot;downloads/ecc-rsa.txt&quot;</span>, <span class="string">&quot;w&quot;</span>)</span><br><span class="line"></span><br><span class="line">file_out.write(<span class="string">&quot;ECC Curve Prime: &quot;</span> + <span class="built_in">hex</span>(ecc_p) + <span class="string">&quot;\n&quot;</span>)</span><br><span class="line">file_out.write(<span class="string">&quot;Curve a: &quot;</span> + <span class="built_in">hex</span>(a) + <span class="string">&quot;\n&quot;</span>)</span><br><span class="line">file_out.write(<span class="string">&quot;Curve b: &quot;</span> + <span class="built_in">hex</span>(b) + <span class="string">&quot;\n&quot;</span>)</span><br><span class="line">file_out.write(<span class="string">&quot;Gx: &quot;</span> + <span class="built_in">hex</span>(Gx) + <span class="string">&quot;\n&quot;</span>)</span><br><span class="line">file_out.write(<span class="string">&quot;Gy: &quot;</span> + <span class="built_in">hex</span>(Gy) + <span class="string">&quot;\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">file_out.write(<span class="string">&quot;e: &quot;</span> + <span class="built_in">hex</span>(e) + <span class="string">&quot;\n&quot;</span>)</span><br><span class="line">file_out.write(<span class="string">&quot;p * q: &quot;</span> + <span class="built_in">hex</span>(n) + <span class="string">&quot;\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">c = <span class="built_in">pow</span>(flag, e, n)</span><br><span class="line">file_out.write(<span class="string">&quot;ciphertext: &quot;</span> + <span class="built_in">hex</span>(c) + <span class="string">&quot;\n&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">ECC Curve Prime: 0x1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff</span></span><br><span class="line"><span class="string">Curve a: -0x3</span></span><br><span class="line"><span class="string">Curve b: 0x51953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00</span></span><br><span class="line"><span class="string">Gx: 0xc6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66</span></span><br><span class="line"><span class="string">Gy: 0x11839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650</span></span><br><span class="line"><span class="string">e: 0x10001</span></span><br><span class="line"><span class="string">p * q: 0x118aaa1add80bdd0a1788b375e6b04426c50bb3f9cae0b173b382e3723fc858ce7932fb499cd92f5f675d4a2b05d2c575fc685f6cf08a490d6c6a8a6741e8be4572adfcba233da791ccc0aee033677b72788d57004a776909f6d699a0164af514728431b5aed704b289719f09d591f5c1f9d2ed36a58448a9d57567bd232702e9b28f</span></span><br><span class="line"><span class="string">ciphertext: 0x3862c872480bdd067c0c68cfee4527a063166620c97cca4c99baff6eb0cf5d42421b8f8d8300df5f8c7663adb5d21b47c8cb4ca5aab892006d7d44a1c5b5f5242d88c6e325064adf9b969c7dfc52a034495fe67b5424e1678ca4332d59225855b7a9cb42db2b1db95a90ab6834395397e305078c5baff78c4b7252d7966365afed9e</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>è¿™æ˜¯ä¸€é“RSAå’ŒECCç»¼åˆèµ·æ¥çš„ä¸€é“é¢˜ç›®ï¼Œæœ¬è´¨è¿˜æ˜¯RSAï¼Œå› å­pqçš„ç”Ÿæˆæ˜¯å€ŸåŠ©æ¤­åœ†æ›²çº¿æ¥ç”Ÿæˆçš„ï¼Œæœ‰ï¼š</p>
<script type="math/tex; mode=display">
E:y^2=x^3+ax+b(\bmod P)</script><p>å½“x,y=p,qæ—¶ï¼Œä»£å…¥ï¼š</p>
<script type="math/tex; mode=display">
E:q^2=p^3+ap+b(\bmod P)</script><p>æ„é€ å¤šé¡¹å¼ï¼š</p>
<script type="math/tex; mode=display">
p^5+ap^3+bp^2-n^2=0(\bmod p)</script><p>é¢˜ç›®æŠŠPã€aã€béƒ½ç»™äº†ï¼Œå¯ä»¥ç”¨sageè¿›è¡Œæ±‚è§£pï¼š</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">P=<span class="number">0x1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff</span></span><br><span class="line">a = -<span class="number">0x3</span></span><br><span class="line">b = <span class="number">0x51953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00</span></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">n=<span class="number">0x118aaa1add80bdd0a1788b375e6b04426c50bb3f9cae0b173b382e3723fc858ce7932fb499cd92f5f675d4a2b05d2c575fc685f6cf08a490d6c6a8a6741e8be4572adfcba233da791ccc0aee033677b72788d57004a776909f6d699a0164af514728431b5aed704b289719f09d591f5c1f9d2ed36a58448a9d57567bd232702e9b28f</span></span><br><span class="line">c=<span class="number">0x3862c872480bdd067c0c68cfee4527a063166620c97cca4c99baff6eb0cf5d42421b8f8d8300df5f8c7663adb5d21b47c8cb4ca5aab892006d7d44a1c5b5f5242d88c6e325064adf9b969c7dfc52a034495fe67b5424e1678ca4332d59225855b7a9cb42db2b1db95a90ab6834395397e305078c5baff78c4b7252d7966365afed9e</span></span><br><span class="line">R.&lt;x&gt;=Zmod(P)[]</span><br><span class="line">f=x**<span class="number">5</span>+a*x**<span class="number">3</span>+b*x**<span class="number">2</span>-n**<span class="number">2</span></span><br><span class="line"><span class="built_in">list</span>=f.roots()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">list</span>:</span><br><span class="line">    <span class="keyword">if</span> isPrime(<span class="built_in">int</span>(i[<span class="number">0</span>])) <span class="keyword">and</span> n%<span class="built_in">int</span>(i[<span class="number">0</span>])==<span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span>(i[<span class="number">0</span>])</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>
<p>è§£å¯†RSAï¼š</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">n=<span class="number">0x118aaa1add80bdd0a1788b375e6b04426c50bb3f9cae0b173b382e3723fc858ce7932fb499cd92f5f675d4a2b05d2c575fc685f6cf08a490d6c6a8a6741e8be4572adfcba233da791ccc0aee033677b72788d57004a776909f6d699a0164af514728431b5aed704b289719f09d591f5c1f9d2ed36a58448a9d57567bd232702e9b28f</span></span><br><span class="line">c=<span class="number">0x3862c872480bdd067c0c68cfee4527a063166620c97cca4c99baff6eb0cf5d42421b8f8d8300df5f8c7663adb5d21b47c8cb4ca5aab892006d7d44a1c5b5f5242d88c6e325064adf9b969c7dfc52a034495fe67b5424e1678ca4332d59225855b7a9cb42db2b1db95a90ab6834395397e305078c5baff78c4b7252d7966365afed9e</span></span><br><span class="line">p=<span class="number">4573744216059593260686660411936793507327994800883645562370166075007970317346237399760397301505506131100113886281839847419425482918932436139080837246914736557</span> </span><br><span class="line">q=<span class="number">2824062321531218201174796572016162635824475505413691713885561763408852922459097896008852396651320629671944905279844855869954833917289579518017582137554769067</span></span><br><span class="line">phi=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d=gmpy2.invert(e,phi)</span><br><span class="line">m=<span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>
<h2 id="å¼ºç½‘æ‹Ÿæ€-2021-ONLYRSA"><a href="#å¼ºç½‘æ‹Ÿæ€-2021-ONLYRSA" class="headerlink" title="[å¼ºç½‘æ‹Ÿæ€ 2021]ONLYRSA"></a>[å¼ºç½‘æ‹Ÿæ€ 2021]ONLYRSA</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">n = <span class="number">264048827496427248021277383801027180195275776366915828865010362454006394906519399441496561006668252031429735502465174250525698696973129422193405161920872162928097673289330345041221985548078586423910246601720647996170161319016119241836415788315729493164331517547663558380515400720081995290120793014108439083514403659082115510258023834737471488528527557960636984676435543300074504679264476413252780514962473070445293528877641502742438571110744667739728450283295649865745629276142949963507003094791773183928894536793857609738113546410753895719242547720815692998871947957214118354127328586542848234994500987288641595105</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"><span class="comment"># 76196483810925191371357319946893762223027002702624516192769497540954799651198719100683206759706879828894501526423422596543748404479640715319801018211652987852179907519286760601944889601355220646374788026632971331786307898234821477134265724962397355614076896148563340833323366935479885600112872998594315513803419069126624158092821269145991266528158747750965226483644012365861166608598063649804899693010576080857540523307078138634628539419178875838147396170651777949577793359622498517581948006585916952705460782942977789615065947303447566918741750017127110484065354974088489869377128636357092420660532261674969708694</span></span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®ç»™äº†ä¸€å¥æè¿°ï¼šRSA say : My birthday is in November instead of October</p>
<p>çœ‹å®Œwpåæ‰å‘ç°è¿™æ˜¯ä¸€ä¸ªè„‘æ´é¢˜ï¼Œä¸è¿‡ä¹Ÿä¸ºè§£RSAæä¾›äº†ä¸€ç§æ–°çš„æ€è·¯ï¼š</p>
<p>æè¿°çš„æ„æ€è®©æˆ‘ä»¬æŠŠæ¨¡æ•°è½¬ä¸º11è¿›åˆ¶ï¼Œå¯ä»¥åœ¨sageé‡Œç”¨digitå‡½æ•°è¿›è¡Œè½¬æ¢ï¼š</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">n = <span class="number">264048827496427248021277383801027180195275776366915828865010362454006394906519399441496561006668252031429735502465174250525698696973129422193405161920872162928097673289330345041221985548078586423910246601720647996170161319016119241836415788315729493164331517547663558380515400720081995290120793014108439083514403659082115510258023834737471488528527557960636984676435543300074504679264476413252780514962473070445293528877641502742438571110744667739728450283295649865745629276142949963507003094791773183928894536793857609738113546410753895719242547720815692998871947957214118354127328586542848234994500987288641595105</span></span><br><span class="line">p = <span class="number">11</span></span><br><span class="line">a = n.digits(p)</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line"><span class="comment">#[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 4, 0, 0, 0, 0, 0, 0, 0, 0, 2, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1]</span></span><br></pre></td></tr></table></figure>
<p>å¾—åˆ°çš„æ˜¯æŒ‰ç…§ä½æ•°é¡ºåºæ•´ç†çš„æ•°ç»„ï¼Œå¯è§æœ‰éå¸¸å¤šçš„0ï¼Œç”¨11è¿›åˆ¶æ•°çš„å½¢å¼æ„é€ å¤šé¡¹å¼çš„é¡¹æ•°ç›¸å¯¹è¾ƒå°‘ï¼Œå¯¹å¤šé¡¹å¼è¿›è¡Œåˆ†è§£æ¯”è¾ƒå®¹æ˜“ï¼Œå¯ä»¥è€ƒè™‘åˆ°å¤šé¡¹å¼åˆ†è§£æ±‚pï¼š</p>
<p>è¿™é‡Œç”¨sageè¿›è¡Œç›¸å…³æ“ä½œæ¯”è¾ƒå®¹æ˜“ï¼š</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">n = <span class="number">264048827496427248021277383801027180195275776366915828865010362454006394906519399441496561006668252031429735502465174250525698696973129422193405161920872162928097673289330345041221985548078586423910246601720647996170161319016119241836415788315729493164331517547663558380515400720081995290120793014108439083514403659082115510258023834737471488528527557960636984676435543300074504679264476413252780514962473070445293528877641502742438571110744667739728450283295649865745629276142949963507003094791773183928894536793857609738113546410753895719242547720815692998871947957214118354127328586542848234994500987288641595105</span></span><br><span class="line">p = <span class="number">11</span></span><br><span class="line">a = n.digits(p)</span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(ZZ)</span><br><span class="line">f = PR(a)</span><br><span class="line">fac = factor(f)</span><br><span class="line"><span class="built_in">print</span>(fac)</span><br><span class="line"><span class="comment">#(x^295 + 2*x^249 + x^196 + 1) * (x^295 + 2*x^281 + 2*x^192 + x^100 + 2*x^37 + 1)</span></span><br></pre></td></tr></table></figure>
<p>æ³¨æ„åˆ°è¿™é‡Œæˆ‘ä»¬æ˜¯åœ¨11è¿›åˆ¶ä¸‹æ„é€ çš„10è¿›åˆ¶å¤šé¡¹å¼ï¼Œåœ¨x=11ä¸‹æ‰èƒ½å¾—åˆ°åŸæ¥çš„nã€‚</p>
<p>æ‰€ä»¥ï¼Œå¯¹äºåˆ†è§£å‡ºçš„ä¸¤ä¸ªå¤šé¡¹å¼å› å­ï¼Œåˆ†åˆ«ä½¿x=11å°±èƒ½å¾—åˆ°ä¸¤ä¸ªå› å­ï¼š</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">16249579302136589695295481114504339262045249125801939374419304404565893699789462299636475519992076209810443523832755415818528536943125532985768629325734679453205207122927745917471850395124342956866284689792620888965652429711989205344392333681297321070276796015579775171010928476523589349812683875326849195595</span></span><br><span class="line"><span class="number">16249579302136675275737472669394168521026727339712083110552530420348131906271518040549529167354613121510156841352658645018277766962773342379074137176993546193979134201416444089373463960664685121485689105129185197998903479181913613273443541075619342246119648308939006396145123630152777688592984718084919469059</span></span><br></pre></td></tr></table></figure>
<p>æœ€å‘çš„åœ°æ–¹æ¥äº†ï¼Œæ£€æµ‹ä¸€ä¸‹è¿™ä¸¤ä¸ªå¤§æ•°å‘ç°æœ‰ä¸€ä¸ªä¸æ˜¯ç´ æ•°ï¼Œç»§ç»­åˆ†è§£çš„è¯åˆæ¯”è¾ƒå›°éš¾ï¼Œç´¢æ€§ç›´æ¥ç”¨på½“nè§£RSAï¼š</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">p=<span class="number">16249579302136675275737472669394168521026727339712083110552530420348131906271518040549529167354613121510156841352658645018277766962773342379074137176993546193979134201416444089373463960664685121485689105129185197998903479181913613273443541075619342246119648308939006396145123630152777688592984718084919469059</span></span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">c=<span class="number">76196483810925191371357319946893762223027002702624516192769497540954799651198719100683206759706879828894501526423422596543748404479640715319801018211652987852179907519286760601944889601355220646374788026632971331786307898234821477134265724962397355614076896148563340833323366935479885600112872998594315513803419069126624158092821269145991266528158747750965226483644012365861166608598063649804899693010576080857540523307078138634628539419178875838147396170651777949577793359622498517581948006585916952705460782942977789615065947303447566918741750017127110484065354974088489869377128636357092420660532261674969708694</span></span><br><span class="line">phi=p-<span class="number">1</span></span><br><span class="line">d=gmpy2.invert(e,phi)</span><br><span class="line">m=<span class="built_in">pow</span>(c,d,p)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>
<h2 id="NISACTF-2022-xor"><a href="#NISACTF-2022-xor" class="headerlink" title="[NISACTF 2022]xor"></a>[NISACTF 2022]xor</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> Crypto.Util <span class="keyword">import</span> number, strxor</span><br><span class="line"><span class="comment">#from flag import flag</span></span><br><span class="line"></span><br><span class="line">flag=<span class="string">&#x27;xxxxxxxxxxxxxxxxxx&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_key</span>():</span><br><span class="line">    <span class="keyword">return</span> [os.urandom(<span class="number">16</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>)]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rnd</span>(<span class="params">b: <span class="built_in">bytes</span>, k: <span class="built_in">bytes</span></span>):</span><br><span class="line">    l = b[:<span class="number">16</span>]</span><br><span class="line">    r = b[<span class="number">16</span>:]</span><br><span class="line">    _r = l</span><br><span class="line">    _l = strxor.strxor(strxor.strxor(r, k), l)</span><br><span class="line">    <span class="keyword">return</span> _l + _r</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">enc</span>(<span class="params">b: <span class="built_in">bytes</span>, ks</span>):</span><br><span class="line">    c = b</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">        c = rnd(c, ks[i])</span><br><span class="line">    <span class="keyword">return</span> c</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    a = os.urandom(<span class="number">32</span>)</span><br><span class="line">    ks = gen_key()</span><br><span class="line">    enc_a = enc(a, ks)</span><br><span class="line">    enc_flag = enc(flag.encode(), ks)</span><br><span class="line">    <span class="built_in">print</span>(base64.b64encode(a).decode())</span><br><span class="line">    <span class="built_in">print</span>(base64.b64encode(enc_a).decode())</span><br><span class="line">    <span class="built_in">print</span>(base64.b64encode(enc_flag).decode())</span><br><span class="line"></span><br><span class="line"><span class="comment">#i03yXzXWe4QTiwJHlUZo6iqEdDkwJVviSOQ7CM3vJmM=</span></span><br><span class="line"><span class="comment">#4EnYOhbivTMP5r4VYLA8cwJBFTXIeeKAoNf/3ctgLLA=</span></span><br><span class="line"><span class="comment">#+qyVMEei1eN3YbV/z2kjcaCKngWc2pW2/e7HwpXKaj0=</span></span><br></pre></td></tr></table></figure>
<p>æ˜¯ä¸€é“å—åŠ å¯†çš„ç¨‹åºé¢˜ï¼Œç”¨å¼‚æˆ–è¿›è¡Œçš„åŠ å¯†ï¼š</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">gen_key</span>():</span><br><span class="line">    <span class="keyword">return</span> [os.urandom(<span class="number">16</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>)]</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œç”Ÿæˆäº†å…«è½®16å­—èŠ‚çš„è½®å¯†é’¥ã€‚</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">rnd</span>(<span class="params">b: <span class="built_in">bytes</span>, k: <span class="built_in">bytes</span></span>):</span><br><span class="line">    l = b[:<span class="number">16</span>]</span><br><span class="line">    r = b[<span class="number">16</span>:]</span><br><span class="line">    _r = l</span><br><span class="line">    _l = strxor.strxor(strxor.strxor(r, k), l)</span><br><span class="line">    <span class="keyword">return</span> _l + _r</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">enc</span>(<span class="params">b: <span class="built_in">bytes</span>, ks</span>):</span><br><span class="line">    c = b</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">        c = rnd(c, ks[i])</span><br><span class="line">    <span class="keyword">return</span> c</span><br></pre></td></tr></table></figure>
<p>æ¯è½®åŠ å¯†ï¼Œè®©å³åŠå’Œæœ¬è½®å¯†é’¥ä»¥åŠå·¦åŠå¼‚æˆ–ï¼Œäº¤æ¢å‰åä½ç½®ï¼Œé‡å¤å…«è½®ã€‚</p>
<p>è¿™é“é¢˜å¹¶æ²¡æœ‰ç»™è½®å¯†é’¥ï¼Œè¦è¯´æ±‚çš„è¯ä¹Ÿæ±‚ä¸å‡ºæ¥ï¼Œç”±äºæ— è®ºåŠ å¯†ä»€ä¹ˆæ¶ˆæ¯ï¼Œæœ€ç»ˆå‡ºæ¥çš„ç»“æœæ— éæ˜¯å·¦å³ä¸¤åŠä¿¡æ¯ï¼Œå¹¶å¸¦æœ‰è½®å¯†é’¥ä¸€èµ·è·Ÿç€å¼‚æˆ–çš„ç‰¹ç‚¹ï¼Œæ‰€ä»¥è¿™é‡Œå¯ä»¥ä¸è€ƒè™‘å…·ä½“çš„è½®å¯†é’¥ï¼Œè€Œæ˜¯æŠŠå·¦å³æ¯ä¸€å—å¼‚æˆ–è¿‡çš„å¯†é’¥çœ‹åšä¸€ä¸ªæ•´ä½“ï¼ŒåŠ å¯†çš„æ¶ˆæ¯å˜äº†ï¼Œä½†æ˜¯å¯†é’¥çš„è½¬ç§»åœ¨è¿‡ç¨‹ä¸­ä¸ä¼šæ”¹å˜ã€‚</p>
<p>å…ˆæ³¨æ„ä¸€ä¸‹åœ¨è¿‡ç¨‹ä¸­ï¼Œæ¶ˆæ¯çš„è½¬ç§»ï¼Œæ¯ä¸€è½®çš„å³åŠä¼šä¸å·¦åŠè¿›è¡Œå¼‚æˆ–ï¼š</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>å…«è½®è½¬æ¢</th>
<th>originalLeftï¼ˆLï¼‰</th>
<th>originalRightï¼ˆRï¼‰</th>
</tr>
</thead>
<tbody>
<tr>
<td>1-2</td>
<td>2.R</td>
<td>1.R^L</td>
</tr>
<tr>
<td>3-4</td>
<td>4.R^L</td>
<td>3.L</td>
</tr>
<tr>
<td>5-6</td>
<td>6.L</td>
<td>5.R</td>
</tr>
<tr>
<td>7-8</td>
<td>8.R</td>
<td>7.L^R</td>
</tr>
</tbody>
</table>
</div>
<p>æ‰€ä»¥ï¼Œæœ€ç»ˆå¾—åˆ°çš„ä¸¤å—å¯†æ–‡ï¼Œå·¦åŠå¸¦æœ‰åŸå§‹å¯†æ–‡å³åŠçš„ä¿¡æ¯åŒæ—¶æœ‰å¯†é’¥ä¸€èµ·å¼‚æˆ–ï¼Œå³åŠå¸¦æœ‰å³åŠå’Œå·¦åŠå¼‚æˆ–çš„ç»“æœè¿˜æœ‰å¯†é’¥ã€‚æ‰€ä»¥å¯ä»¥è®©å…¶ä¸åŸæ¥çš„å¯†æ–‡å¼‚æˆ–å¾—åˆ°å‰©ä¸‹çš„ç§˜é’¥å—ã€‚</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.strxor <span class="keyword">import</span> strxor <span class="keyword">as</span> xor</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64decode <span class="keyword">as</span> b64</span><br><span class="line"></span><br><span class="line">a=<span class="string">&#x27;i03yXzXWe4QTiwJHlUZo6iqEdDkwJVviSOQ7CM3vJmM=&#x27;</span></span><br><span class="line">e_a=<span class="string">&#x27;#4EnYOhbivTMP5r4VYLA8cwJBFTXIeeKAoNf/3ctgLLA=&#x27;</span></span><br><span class="line">e_flag=<span class="string">&#x27;+qyVMEei1eN3YbV/z2kjcaCKngWc2pW2/e7HwpXKaj0=&#x27;</span></span><br><span class="line">a=b64(a)</span><br><span class="line">enc_a=b64(e_a)</span><br><span class="line">enc_flag=b64(e_flag)</span><br><span class="line">l,r=a[:<span class="number">16</span>],a[<span class="number">16</span>:]</span><br><span class="line">enc_r,enc_l=enc_a[<span class="number">16</span>:],enc_a[:<span class="number">16</span>]</span><br><span class="line">key_r=xor(xor(enc_r,l),r)</span><br><span class="line">key_l=xor(enc_l,r)</span><br></pre></td></tr></table></figure>
<p>æ‰€ä»¥ï¼Œflagçš„åŠ å¯†ä¹Ÿæ»¡è¶³ä¸Šè¡¨ï¼Œå¾—åˆ°æ¯ç»„çš„keyä¹‹åå¼‚æˆ–å³å¯ï¼š</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.strxor <span class="keyword">import</span> strxor <span class="keyword">as</span> xor</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64decode <span class="keyword">as</span> b64</span><br><span class="line"></span><br><span class="line">a=<span class="string">&#x27;i03yXzXWe4QTiwJHlUZo6iqEdDkwJVviSOQ7CM3vJmM=&#x27;</span></span><br><span class="line">e_a=<span class="string">&#x27;#4EnYOhbivTMP5r4VYLA8cwJBFTXIeeKAoNf/3ctgLLA=&#x27;</span></span><br><span class="line">e_flag=<span class="string">&#x27;+qyVMEei1eN3YbV/z2kjcaCKngWc2pW2/e7HwpXKaj0=&#x27;</span></span><br><span class="line">a=b64(a)</span><br><span class="line">enc_a=b64(e_a)</span><br><span class="line">enc_flag=b64(e_flag)</span><br><span class="line">l,r=a[:<span class="number">16</span>],a[<span class="number">16</span>:]</span><br><span class="line">enc_r,enc_l=enc_a[<span class="number">16</span>:],enc_a[:<span class="number">16</span>]</span><br><span class="line">key_r=xor(xor(enc_r,l),r)</span><br><span class="line">key_l=xor(enc_l,r)</span><br><span class="line">flag_r=xor(enc_flag[:<span class="number">16</span>],key_l)</span><br><span class="line">flag_l=xor(xor(enc_flag[<span class="number">16</span>:],key_r),flag_r)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;NSSCTF&#123;&#x27;</span>+flag_l.decode()+flag_r.decode()+<span class="string">&#x27;&#125;&#x27;</span>)</span><br></pre></td></tr></table></figure>
<h1 id="NSSCTF-Round-11-Basic"><a href="#NSSCTF-Round-11-Basic" class="headerlink" title="NSSCTF Round#11 Basic"></a>NSSCTF Round#11 Basic</h1><p>è¿™æ¯”èµ›åšäº†ä¸€ä¸ªæ¥å°æ—¶ï¼Œå‡ºäº†å››ä¸ªé¢˜ï¼Œå‰©é‚£ä¸¤ä¸ªé¢˜æœ‰ç‚¹éš¾å°±ä¸åç‰¢äº†ã€‚</p>
<h2 id="ez-enc"><a href="#ez-enc" class="headerlink" title="ez_enc"></a>ez_enc</h2><p>Baconicï¼ŸNo,not baconic</p>
<p>ABAABBBAABABAABBABABAABBABAAAABBABABABAAABAAABBAABBBBABBABBABBABABABAABBAABBABAAABBAABBBABABABAAAABBAAABABAABABBABBBABBAAABBBAABABAABBAAAABBBAAAABAABBBAABBABABAABABAAAAABBBBABAABBBBAAAABBBBBAB</p>
<p>è¯•äº†ä¸€ä¸‹åŸ¹æ ¹ï¼Œ192ä½ä¸èƒ½è§£ï¼ŒçŒœæµ‹æ˜¯äºŒè¿›åˆ¶ï¼ŒAä¸º0Bä¸º1ç„¶åè§£ç ï¼Œå¾—åˆ°flagï¼š</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">str</span>=<span class="string">&#x27;ABAABBBAABABAABBABABAABBABAAAABBABABABAAABAAABBAABBBBABBABBABBABABABAABBAABBABAAABBAABBBABABABAAAABBAAABABAABABBABBBABBAAABBBAABABAABBAAAABBBAAAABAABBBAABBABABAABABAAAAABBBBABAABBBBAAAABBBBBAB&#x27;</span></span><br><span class="line"><span class="built_in">str</span>=<span class="built_in">str</span>.replace(<span class="string">&#x27;A&#x27;</span>,<span class="string">&#x27;0&#x27;</span>).replace(<span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;1&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;&#x27;</span>.join(<span class="built_in">chr</span>(<span class="built_in">int</span>(<span class="built_in">str</span>[i:i+<span class="number">8</span>],<span class="number">2</span>)) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(<span class="built_in">str</span>),<span class="number">8</span>)))</span><br></pre></td></tr></table></figure>
<h2 id="MyMessage"><a href="#MyMessage" class="headerlink" title="MyMessage"></a>MyMessage</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">flag = os.getenv(<span class="string">&#x27;FLAG&#x27;</span>)</span><br><span class="line"></span><br><span class="line">e = <span class="number">127</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sign</span>():</span><br><span class="line">    msg = <span class="built_in">input</span>(<span class="string">&quot;Input messageï¼š&quot;</span>)</span><br><span class="line">    p = getPrime(<span class="number">512</span>)</span><br><span class="line">    q = getPrime(<span class="number">512</span>)</span><br><span class="line">    n = p*q</span><br><span class="line">    c = <span class="built_in">pow</span>(bytes_to_long((msg + flag).encode()), e, n)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;n: <span class="subst">&#123;n&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;Token: <span class="subst">&#123;<span class="built_in">hex</span>(c)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        sign()</span><br><span class="line"></span><br><span class="line">main()</span><br></pre></td></tr></table></figure>
<p>e=127ï¼Œè¿™è®©æˆ‘æƒ³åˆ°äº†å‰å‡ å¤©åšäº”é“é¢˜çš„æ—¶å€™çš„é‚£ä¸ªä½åŠ å¯†æŒ‡æ•°æ”»å‡»ï¼Œè·å–127ç»„æ•°ç›´æ¥CRTå°±èƒ½è§£ï¼Œè„šæœ¬æ”¹æ”¹å°±èƒ½ç”¨ï¼š</p>
<p>æ³¨æ„éœ€è¦å…ˆè¾“å…¥æˆ‘ä»¬è‡ªå·±çš„ä¿¡æ¯ï¼Œåå°ä¼šæŠŠflagå’Œmsgä¸€èµ·åŠ å¯†ï¼Œè¿™é‡Œç›´æ¥ç”¨ä¸ªä¸å¯è§å­—ç¬¦åŠ å¯†äº†å°±è¡Œï¼Œä¸å½±å“flagï¼š</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> libnum <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">e=<span class="number">127</span></span><br><span class="line">ns,cs = [],[]</span><br><span class="line">sh = remote(<span class="string">&#x27;node2.anna.nssctf.cn&#x27;</span>,<span class="number">28972</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">127</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;i+<span class="number">1</span>&#125;</span>/<span class="subst">&#123;<span class="number">127</span>&#125;</span>&#x27;</span>)</span><br><span class="line">    sh.sendline(<span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line">    sh.recvuntil(<span class="string">b&#x27;n: &#x27;</span>)</span><br><span class="line">    ns.append(<span class="built_in">int</span>(sh.recvline().decode()))</span><br><span class="line">    sh.recvuntil(<span class="string">b&#x27;Token: &#x27;</span>)</span><br><span class="line">    cs.append(<span class="built_in">int</span>(sh.recvline().decode(),<span class="number">16</span>))</span><br><span class="line">m_e=solve_crt(cs,ns)</span><br><span class="line">m = <span class="built_in">int</span>(gmpy2.iroot(m_e, e)[<span class="number">0</span>])</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>
<h2 id="MyGame"><a href="#MyGame" class="headerlink" title="MyGame"></a>MyGame</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line">flag = os.getenv(<span class="string">&#x27;FLAG&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">menu</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;&#x27;&#x27;=---menu---=</span></span><br><span class="line"><span class="string">1. Guess</span></span><br><span class="line"><span class="string">2. Encrypt</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">n = p*q</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">randommsg</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(random.choices(string.ascii_lowercase+string.digits, k=<span class="number">30</span>))</span><br><span class="line"></span><br><span class="line">mymsg = randommsg()</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">guess</span>():</span><br><span class="line">    <span class="keyword">global</span> mymsg</span><br><span class="line">    msg = <span class="built_in">input</span>()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> msg == mymsg:</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(mymsg)</span><br><span class="line">        mymsg = randommsg()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>():</span><br><span class="line">    e = random.getrandbits(<span class="number">8</span>)</span><br><span class="line">    c = <span class="built_in">pow</span>(bytes_to_long(mymsg.encode()), e, n)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;Cipher_<span class="subst">&#123;e&#125;</span>: <span class="subst">&#123;c&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;n: <span class="subst">&#123;n&#125;</span>&#x27;</span>)</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        opt = <span class="built_in">int</span>(<span class="built_in">input</span>())</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> opt == <span class="number">1</span>:</span><br><span class="line">            guess()</span><br><span class="line">        <span class="keyword">elif</span> opt == <span class="number">2</span>:</span><br><span class="line">            encrypt()</span><br><span class="line"></span><br><span class="line">main()</span><br></pre></td></tr></table></figure>
<p>è¿™é¢˜é¢˜ç›®å¾ˆé•¿ï¼Œä¸è¿‡å¾—ç›Šäº<code>e = random.getrandbits(8)</code>ä¼šæœ‰æ¦‚ç‡ç”Ÿæˆå¾ˆå°çš„æ•°ï¼Œç›´æ¥å¼€æ–¹å°±èƒ½å¾—åˆ°mymsgç„¶åéªŒè¯å¾—åˆ°flagï¼š</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p=remote(<span class="string">&#x27;node1.anna.nssctf.cn&#x27;</span>,<span class="number">28512</span>)</span><br><span class="line"><span class="built_in">print</span>(p.recvline())</span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    p.sendline(<span class="string">&#x27;2&#x27;</span>.encode())</span><br><span class="line">    t=p.recvline()</span><br><span class="line">    <span class="built_in">print</span>(t[:<span class="number">15</span>])</span><br><span class="line">    <span class="keyword">if</span> <span class="string">b&#x27;Cipher_1:&#x27;</span> <span class="keyword">in</span> t :</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">b&#x27;Cipher_2:&#x27;</span> <span class="keyword">in</span> t:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">b&#x27;Cipher_3:&#x27;</span> <span class="keyword">in</span> t:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">b&#x27;Cipher_4:&#x27;</span> <span class="keyword">in</span> t:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">msg=long_to_bytes(gmpy2.iroot(<span class="built_in">int</span>(t[<span class="number">10</span>:]),<span class="built_in">int</span>(<span class="built_in">chr</span>(t[<span class="number">7</span>])))[<span class="number">0</span>])</span><br><span class="line"><span class="built_in">print</span>(msg)</span><br><span class="line">p.sendline(<span class="string">&#x27;1&#x27;</span>.encode())</span><br><span class="line">p.sendline(msg)</span><br><span class="line"><span class="built_in">print</span>(p.recvline())</span><br></pre></td></tr></table></figure>
<h2 id="ez-signin"><a href="#ez-signin" class="headerlink" title="ez_signin"></a>ez_signin</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line"><span class="keyword">assert</span> p &gt; q</span><br><span class="line">n = p*q</span><br><span class="line">e = <span class="number">65536</span></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">num1 = (<span class="built_in">pow</span>(p,e,n)-<span class="built_in">pow</span>(q,e,n)) % n</span><br><span class="line">num2 = <span class="built_in">pow</span>(p-q,e,n)</span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;num1=&quot;</span>,num1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;num2=&quot;</span>,num2)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n=&quot;</span>,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c=&quot;</span>,c)</span><br><span class="line"></span><br><span class="line">c= <span class="number">49140445537557319747370258521380832266628925480997870608481586932493417284728958741898158715141253481426256782862515069377084448131828373205132956168004394787405869498445767375566916390982148263164591421258539492316104936618465204360809734703249247155425048804311972229129144861794011029251351400008603964208</span></span><br><span class="line">n= <span class="number">91530815691867359702851809294843883210988261884502065659703236526417089749297194911652819322901902811672635037961607325344868895249369348890823963715451286330263722759397285433088118125072701539439159319690211982633007064884800262543109901388114825805923119356671940284021983884326245270988185032638715421361</span></span><br><span class="line">a0= <span class="number">9567173861275196858460021832302469701883011569848610630647973537343577185110893845356470627768583723955352277616717525865651072348955345569349493461591617</span></span><br><span class="line">a1= <span class="number">9567173861275196858460021793425744964971995864734881146246615079880405791684218529798175073376613011755369604379938176024666146578623561846054825791860481</span></span><br><span class="line">b0= <span class="number">62076258573599781640280492901494077016751499076309821274994840668372448434757031161585099060759223091642261784834895411252</span></span><br><span class="line">b1= <span class="number">86005590473247956807188326544447837958969250994225159304619548233594032409996812924660353546715287124965907562786740309700</span></span><br></pre></td></tr></table></figure>
<p>æ ¹æ®é¢˜ç›®æ„é€ å«æœ‰å…¬å› å­çš„è¡¨è¾¾å¼ï¼š</p>
<script type="math/tex; mode=display">
num_1+num_2\equiv 2p^e+...+kpq^{e-1}\equiv p(...)(\bmod n)</script><p>å’Œnæ±‚å…¬å› å­å¾—åˆ°å› å¼åˆ†è§£ï¼š</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">num1= <span class="number">79619421894029884638677851880473974285442927382245165370739056040759373646371770788157736026274332831561856119631720623514629268579816753416034541909837307091058466817126597057548180129822317731594823465494792051287463339171717641625476673408882440284031658532401976615208858603868261548868074622540386126768</span></span><br><span class="line">num2= <span class="number">91822828674172883164716888996174839666678823411077041843096256035477780510442004096659467175147094362970318180834969767217981486835289275533118063566355171073579551817984258735625793623211106430202288294682209882571948851233885979012287314493151872159735325013038543729799578632525474654819432094595256453214</span></span><br><span class="line">n= <span class="number">92875831742832378748895662989067752055771801344046318768656580407112306063908453067740280899972677871728194311476114821242068010156585531144035681426722516684584563008407855784146796246241361495649307382425970272912587311106136648975801842846127380231678957556486109520422978004986278328890117201062166628193</span></span><br><span class="line">c= <span class="number">71447307417287313144879136829692601205166497818416632261484978008166993137789557661514683724831221759059527356240537593120676746613230611929654083120275104860948647608613639712999291243106945047993160233126018269241066399012656713740126017505002345546448511642658499265913182268607507729813704374651035412796</span></span><br><span class="line">p=gmpy2.gcd(num1+num2,n)</span><br><span class="line">q=n//p</span><br><span class="line">e=<span class="number">65536</span></span><br></pre></td></tr></table></figure>
<p>è¿™é¢˜è¿˜æœ‰ä¸ªæ¯”è¾ƒå‘çš„åœ°æ–¹åœ¨eä¸Šï¼Œeä¸º2çš„16æ¬¡æ–¹ï¼Œè¿˜å¥½å‰ä¸¤å¤©åšçš„é¢˜é‡Œæœ‰ç”¨<strong>Tonelli-Shanksç®—æ³•</strong>æ±‚è§£eä¸º2çš„æ¬¡æ–¹é—®é¢˜ï¼Œé‚£é“é¢˜çš„nä¸ºè´¨æ•°ï¼Œè¿™é‡Œä¸å¤§å¥½ç”¨ï¼Œä¸è¿‡æ—¢ç„¶å·²ç»ç›´æ¥å› å¼åˆ†è§£å®Œäº†ï¼Œé‚£å°±ç›´æ¥ç”¨påšæ¨¡æ•°æ±‚è§£å¾—äº†ï¼š</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">num1= <span class="number">79619421894029884638677851880473974285442927382245165370739056040759373646371770788157736026274332831561856119631720623514629268579816753416034541909837307091058466817126597057548180129822317731594823465494792051287463339171717641625476673408882440284031658532401976615208858603868261548868074622540386126768</span></span><br><span class="line">num2= <span class="number">91822828674172883164716888996174839666678823411077041843096256035477780510442004096659467175147094362970318180834969767217981486835289275533118063566355171073579551817984258735625793623211106430202288294682209882571948851233885979012287314493151872159735325013038543729799578632525474654819432094595256453214</span></span><br><span class="line">n= <span class="number">92875831742832378748895662989067752055771801344046318768656580407112306063908453067740280899972677871728194311476114821242068010156585531144035681426722516684584563008407855784146796246241361495649307382425970272912587311106136648975801842846127380231678957556486109520422978004986278328890117201062166628193</span></span><br><span class="line">c= <span class="number">71447307417287313144879136829692601205166497818416632261484978008166993137789557661514683724831221759059527356240537593120676746613230611929654083120275104860948647608613639712999291243106945047993160233126018269241066399012656713740126017505002345546448511642658499265913182268607507729813704374651035412796</span></span><br><span class="line">p=gmpy2.gcd(num1+num2,n)</span><br><span class="line">e=<span class="number">65536</span></span><br><span class="line"></span><br><span class="line">n=p</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">legendre</span>(<span class="params">a, p</span>):<span class="comment">#å‹’è®©å¾·ç¬¦å·</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">pow</span>(a, (p - <span class="number">1</span>) // <span class="number">2</span>, p)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">tonelli</span>(<span class="params">n, p</span>):<span class="comment">#æ±‚nåœ¨æ¨¡pä¸‹å¹³æ–¹æ ¹</span></span><br><span class="line">    <span class="keyword">assert</span> legendre(n, p) == <span class="number">1</span></span><br><span class="line">    q = p - <span class="number">1</span></span><br><span class="line">    s = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> q % <span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">        q //= <span class="number">2</span></span><br><span class="line">        s += <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> s == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">pow</span>(n, (p + <span class="number">1</span>) // <span class="number">4</span>, p)</span><br><span class="line">    <span class="keyword">for</span> z <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, p):</span><br><span class="line">        <span class="keyword">if</span> p - <span class="number">1</span> == legendre(z, p):</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    c = <span class="built_in">pow</span>(z, q, p)</span><br><span class="line">    r = <span class="built_in">pow</span>(n, (q + <span class="number">1</span>) // <span class="number">2</span>, p)</span><br><span class="line">    t = <span class="built_in">pow</span>(n, q, p)</span><br><span class="line">    m = s</span><br><span class="line">    t2 = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> (t - <span class="number">1</span>) % p != <span class="number">0</span>:</span><br><span class="line">        t2 = (t * t) % p</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, m):</span><br><span class="line">            <span class="keyword">if</span> (t2 - <span class="number">1</span>) % p == <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            t2 = (t2 * t2) % p</span><br><span class="line">        b = <span class="built_in">pow</span>(c, <span class="number">1</span> &lt;&lt; (m - i - <span class="number">1</span>), p)</span><br><span class="line">        r = (r * b) % p</span><br><span class="line">        c = (b * b) % p</span><br><span class="line">        t = (t * c) % p</span><br><span class="line">        m = i</span><br><span class="line">    <span class="keyword">return</span> r</span><br><span class="line"></span><br><span class="line">count = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> e % <span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">    e = e // <span class="number">2</span></span><br><span class="line">    count += <span class="number">1</span></span><br><span class="line">d = gmpy2.invert(<span class="number">1</span>,n-<span class="number">1</span>)</span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(count):</span><br><span class="line">    m = tonelli(m, n)</span><br><span class="line">m = -m % n</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]).decode())</span><br></pre></td></tr></table></figure>
<h2 id="ez-fac"><a href="#ez-fac" class="headerlink" title="ez_fac"></a>ez_fac</h2><p>ä¸‹é¢æ˜¯å‰©ä¸‹ä¸¤é“æ²¡å‡ºçš„é¢˜ç›®ã€‚</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag,a0,a1,b0,b1</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">e = getPrime(<span class="number">128</span>)</span><br><span class="line">n = p*q</span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">pow</span>(a0,<span class="number">2</span>) + e * <span class="built_in">pow</span>(b0,<span class="number">2</span>) == n</span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">pow</span>(a1,<span class="number">2</span>) + e * <span class="built_in">pow</span>(b1,<span class="number">2</span>) == n</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c=&quot;</span>,c)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n=&quot;</span>,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;a0=&quot;</span>,a0)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;a1=&quot;</span>,a1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;b0=&quot;</span>,b0)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;b1=&quot;</span>,b1)</span><br></pre></td></tr></table></figure>
<p>è¿™é¢˜æ–‡çŒ®æ£€ç´¢èƒ½æ‰¾åˆ°è¿™ä¹ˆä¸ªå®šç†ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s2.loli.net/2023/04/08/gvxoLyEKeS3WkOM.png" alt=""></p>
<p>ç»™äº†å·²çŸ¥çš„æ•°èƒ½æ±‚å‡ºeï¼Œä¹Ÿèƒ½å¯¹å…¶è¿›è¡Œå› å¼åˆ†è§£ï¼š</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c= <span class="number">62194144015175943943855803977418397563269819928731209809196217501647944435916921321318208689570885053208681285165006338680066130685191282724431116319714224319810582802626632327166134936512407699703343679880875370820558819411160671694247759813313254748559859242895992131982108197054171637856584124517664717643</span></span><br><span class="line">n= <span class="number">99943274509913720142135216122189172155252982914602347927725454090959589551021883486383109456502386885984323593256577110633781683076806158798313301910944677156126217433591860014718178332010183335581498192962459730957969919416911334293034819918756657854875160945858491843863159358722797616289914287170788070113</span></span><br><span class="line">a0= <span class="number">9997163323158910968564455619055683563384377855734437604853384372535221152500103875749523067668673075458165333038276700710441246039726577724818647081592601</span></span><br><span class="line">a1= <span class="number">9997163323158910968564455201868948268399388529521602919595477259759197222629470595436905859514103739865816151018028333458856229441684399348916315665031001</span></span><br><span class="line">b0= <span class="number">19376653007294289996140050578995499724597175169840963112069668308300718878508042259593504819913431943552934079142053449356</span></span><br><span class="line">b1= <span class="number">207063812834149129185677532886004240022752343126800397828673085283869040653437389474190773570107170337460753519011212120156</span></span><br><span class="line"></span><br><span class="line">e=(n-a0**<span class="number">2</span>)//b0**<span class="number">2</span></span><br><span class="line">p=gmpy2.gcd(a0*b1-a1*b0,n)</span><br><span class="line">q=n//p</span><br><span class="line">phi=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d=gmpy2.invert(e,phi)</span><br><span class="line">m=<span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>
<h2 id="NTR"><a href="#NTR" class="headerlink" title="NTR"></a>NTR</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">init</span>():</span><br><span class="line">    p = getPrime(<span class="number">2048</span>)</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        x = getRandomNBitInteger(<span class="number">1024</span>)</span><br><span class="line">        y = getPrime(<span class="number">768</span>)</span><br><span class="line">        z = gmpy2.invert(x, p) * y % p</span><br><span class="line">        <span class="keyword">return</span> (p, x, y, z)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">cipher, p, z</span>):</span><br><span class="line">    message = bytes_to_long(cipher)</span><br><span class="line">    r = getRandomNBitInteger(<span class="number">1024</span>)</span><br><span class="line">    c = (r * z + message) % p</span><br><span class="line">    <span class="keyword">return</span> c</span><br><span class="line"></span><br><span class="line">p, x, y, z = init()</span><br><span class="line">c = encrypt(flag, p, z)</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;cipher.txt&quot;</span>, <span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(<span class="string">&quot;binz = &quot;</span> + <span class="built_in">str</span>(<span class="built_in">bin</span>(z)) + <span class="string">&quot;\n&quot;</span>)</span><br><span class="line">    f.write(<span class="string">&quot;binp = &quot;</span> + <span class="built_in">str</span>(<span class="built_in">bin</span>(p)) + <span class="string">&quot;\n&quot;</span>)</span><br><span class="line">    f.write(<span class="string">&quot;binc = &quot;</span> + <span class="built_in">str</span>(<span class="built_in">bin</span>(c)) + <span class="string">&quot;\n&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>è¿™é¢˜ä¸€æ—¶åŠä¼šæ²¡æ‰¾åˆ°wpï¼Œæ™šä¸Šçœ‹äº†ä¼šæ ¼å¯†ç ä¹‹åæç„¶å¤§æ‚Ÿåˆåšäº†ä¸€éå°±è§£å‡ºæ¥äº†ï¼Œæˆ‘ä¸€æƒ³è¿™ä¸éƒ½æ˜¯ä¸€æ ·çš„å—â€¦â€¦</p>
<script type="math/tex; mode=display">
z\equiv x^{-1}y(\bmod p)</script><script type="math/tex; mode=display">
c\equiv rz+m(\bmod p)</script><p>åŒ–ç®€ï¼š</p>
<script type="math/tex; mode=display">
m\equiv cx\bmod p\cdot x^{-1}(\bmod y)</script><p>åˆæœ‰ï¼š</p>
<script type="math/tex; mode=display">
zx+kp=y</script><p>æ„é€ $L=\begin{bmatrix}1 &amp; z\\0 &amp; p\end{bmatrix}$ï¼š</p>
<script type="math/tex; mode=display">
\begin{bmatrix}x&k\end{bmatrix}\cdot L=\begin{bmatrix}x&y\end{bmatrix}</script><p>ç›´æ¥LLLæ±‚è§£ï¼Œèˆå»è´Ÿå€¼ï¼š</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">z = <span class="built_in">int</span>(<span class="string">&#x27;1100111100010100101101000110111010110001111111010110111100111111000001001011011010001001010011010000110010100111110011010000011111011011000001101011011101011111111011111111000000001000110110111001111100000100101010101001011111001010110101111001110010010001100001101001001110010001011001011100110111101001011111001001010110100110101110011001001000111101000100000100011101110101101000000000000000010001110001101010111100010111010100110101100000101100110100000001111001101001101011110100000101101001001010100100101110011110100010001001111110011111110101010111111110011111110001000101111100010011111101001111000100111000110011110100010000001001000100110101110000101001001111111000010111101111001110011011011011111100100000011000000111001101000000111111111101001000110101100100011100001010010110001000001110010110100000100010110011010000011010110001101001101100010101001000110110111011100010000010110010000001110010101010101011011010011001011011011001111010101101001111001000101000100001101000110010100101101011100101000100110101010011101000011001111011110111000100111100010111000000011011100111000100001011110001101010001100100101001110000000011001110000010011110101100010000001011110011010011111001100010111010110101101111011001101001110000010010110001100010110011111001110111111001101100010011001111011010111011011001010011110101101110001101000101100111110100001011100100101110100011010110001100010000011110000001001111100000011000110000111101110101010111100101000110100001100101000011001001011111001100010011100111101100001110100101010100100111011011010110001010100101101010001101100110001011111001111111011011010111111101110000001011110001011001110111001011100100001000101101111101011100100010010011001001011010011011101111010101110101101010100101011000100101101100011010111001110001011001110001000101000011001001011000111101010111111000111100111111000110000000101011001011110101010010001111110000011100111011110001001100111011000010111001010011101011111001001011011011011110111010101110001000101000110101101010101100100110101101001011111011010000&#x27;</span>,<span class="number">2</span>)</span><br><span class="line">p = <span class="built_in">int</span>(<span class="string">&#x27;10010000100000001100010000110101101101001001001111010110100010000011010001101110011100101100111001111001100101100010010001101100001011011010111111101010010111110111101100011100110101101011111000000111001001010011101111001111010101010100001111110100111101110100101110110101111111001011100110110100111011001101100010001010100011101100100110110010111100101000111000110010101010000111101110111000011100101000101010010111110101011111100110000010101001001001111011110000010100101010000111101101101101001110001010110001101100101011101010001010010100110101110001010001000100101101011000110010100001111101100000111011010110100101111011011100010101111111000001100111111100101111011000000111100101111011100010100111111001110110111001101101110000011010011010010111000011101101001101001010111111000111110101011111110100010011010111101101100110011111010001011001000001100100101000001110111110111011011010011010000011101011001101001101100000110011101011101000000001101101110100000110101001010101010001000110101110001101110111011010101111101001111011110100000000101000001110100110001111101000010001001001000101110100100010101100000010111000010111100010011011011011101111110011100100010001011011010100111001101111100001110011110010110111010100011011101110010110101100111000011011001100110000001000101001111000111100000101110010000100000110000111001101010001011010001100001111010000101001100001010001011010011010110000000110110100011111110110011100010000101001001110111010001011010110001000110101011001111101110010100011101011101111011100110101110100110010111100010100001000110110100111100101011110010110100001011100100110101011100110011010110011011000011100011110101011001000111010101110111010101101101011001010101100100110110001010000001111001101100011101011000010100111011001010100100010110100110101111000000101000111110101010001100000101000101011110110011000111111101111100001110110011111110000101011001100000101011100000001010101100101101100001011010100100000011001010111001111111000111111100101011010011000101000001011010001101001011111101001101000111011001101&#x27;</span>,<span class="number">2</span>)</span><br><span class="line">c = <span class="built_in">int</span>(<span class="string">&#x27;111100101010010000001000000001110101001100100110110100010011100100000100001001001011111011001110110000000110110010100101101011100100001110101110101101000000101101111001011100110100101100111000110010100001001111111001110111111000101100100111001110000110101010011101010111101000100010100110110010100000011011001010011010001000010001101101010000101011000000001111001001000000111100011000001110001011111100111010011101010010101101111111110000100010001001010100100011100100000101111000101110100111101010100110010111011000111111111100001101100111000001000111001111010101011100101101111111110110110010011000000101011110100011101100010111111111111011100000000000100001010101111010011010111001010000100011001111110001111111110110100001000001001001010111111101101100111101000001111111100110100110111100101101110111001001001111101000111011011101111010101011000000001001010101110011000110110010110000010111000010000100111010001111110000100001111111000001111000101010100001000001101000101111101101111010101111111010001100001110000110000101100000011110010111000001001000001111101100010001100101001010010010011100001000110010110000001001110111111101100111101100100000011100110101001000110011100111110010111110001110110000101010111000011101001100010000100100000011001111010110100111111110110010011110011101010000010111001101101000011100001001010010011010000010110011001111000101010101100000100111010110110010011111101000001000000011010000100010011100010010001001101010011101000011010011110110011101010110111001000000110001000101011100011110010011000111011001000001100111101010010011100000100000010110000011010001010010101100110011110111101100101001001001011000001111110000111110100110110000111010100001110000110100110101111111101100011101100111100011101110001011011100010101010011000101010110011100100100000110011000011000011010110110011111011110101010111001000000110110111111011010100001100100000100011000000011011010111101010000110101111101110100000011001101101111011011101111110101001010001000111111001011101010010011110110111110011110011011101100101101000010&#x27;</span>,<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">L = matrix(ZZ, [[<span class="number">1</span>, z],[<span class="number">0</span>, p]])</span><br><span class="line">v = L.LLL()[<span class="number">1</span>]</span><br><span class="line">x,y=v[<span class="number">0</span>],v[<span class="number">1</span>]</span><br><span class="line">x_1=gmpy2.invert(x,y)</span><br><span class="line">m=c*x%p*x_1%y</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>
</article><div class="post-tools" id="post-tools"><div class="post-tools-left"><div class="share-link mobile"><div class="share-qrcode"><div class="share-button" title="ä½¿ç”¨æ‰‹æœºè®¿é—®è¿™ç¯‡æ–‡ç« "><i class="anzhiyufont anzhiyu-icon-qrcode"></i></div><div class="share-main"><div class="share-main-all"><div id="qrcode" title="http://example.com/2023/03/13/NSSCTF%E9%A2%98%E8%A7%A3%EF%BC%88%E4%B8%80%EF%BC%89/"></div><div class="reward-dec">ä½¿ç”¨æ‰‹æœºè®¿é—®è¿™ç¯‡æ–‡ç« </div></div></div></div></div><div class="share-link weibo"><a class="share-button" target="_blank" href="https://service.weibo.com/share/share.php?title=undefined&amp;url=http://example.com/2023/03/13/NSSCTF%E9%A2%98%E8%A7%A3%EF%BC%88%E4%B8%80%EF%BC%89/&amp;pic=undefined" rel="external nofollow noreferrer noopener"><i class="anzhiyufont anzhiyu-icon-weibo"></i></a></div><div class="share-link copyurl"><div class="share-button" id="post-share-url" title="å¤åˆ¶é“¾æ¥" onclick="rm.copyPageUrl()"><i class="anzhiyufont anzhiyu-icon-link"></i></div></div></div><div class="post-tools-right"><div class="tag_share"><div class="post-meta__box"><div class="post-meta__box__tag-list"><a class="post-meta__box__tags" href="/tags/RSA/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>RSA<span class="tagsPageCount">24</span></a></div></div></div></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2023/03/08/%E4%BA%94%E9%81%93%E9%A2%98/"><img class="prev-cover" src="https://s2.loli.net/2023/03/10/UeQbYJasjrqyXLM.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">ä¸Šä¸€ç¯‡</div><div class="prev_info">äº”é“é¢˜</div></div></a></div><div class="next-post pull-right"><a href="/2023/03/26/%E5%91%A8%E5%88%86%E4%BA%AB1%EF%BC%9AMT19937/"><img class="next-cover" src="https://s2.loli.net/2023/03/26/ONDCnTxKoJB1ka4.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">ä¸‹ä¸€ç¯‡</div><div class="next_info">å‘¨åˆ†äº«1ï¼šMT19937ç®—æ³•</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="anzhiyufont anzhiyu-icon-thumbs-up fa-fw" style="font-size: 1.5rem; margin-right: 4px"></i><span>ç›¸å…³æ¨è</span></div><div class="relatedPosts-list"><div><a href="/2022/11/27/CTFshow%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95%EF%BC%88%E4%B8%8A%EF%BC%89/" title="CTFshowåšé¢˜è®°å½•ï¼ˆä¸Šï¼‰"><img class="cover" src="https://s2.loli.net/2022/12/08/CbXMu7hqjTOzwpB.png" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2022-11-27</div><div class="title">CTFshowåšé¢˜è®°å½•ï¼ˆä¸Šï¼‰</div></div></a></div><div><a href="/2022/12/09/CTFshow%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95%EF%BC%88%E4%B8%8B%EF%BC%89/" title="CTFshowåšé¢˜è®°å½•ï¼ˆä¸‹ï¼‰"><img class="cover" src="https://s2.loli.net/2022/12/08/CbXMu7hqjTOzwpB.png" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2022-12-09</div><div class="title">CTFshowåšé¢˜è®°å½•ï¼ˆä¸‹ï¼‰</div></div></a></div><div><a href="/2023/01/03/CryptoHack%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%952/" title="CryptoHackå­¦ä¹ è®°å½•ï¼ˆäºŒï¼‰"><img class="cover" src="https://s2.loli.net/2023/01/03/saZ1bSM5WX6PmR4.png" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2023-01-03</div><div class="title">CryptoHackå­¦ä¹ è®°å½•ï¼ˆäºŒï¼‰</div></div></a></div><div><a href="/2023/05/14/LitCTF%E5%A4%8D%E7%8E%B0/" title="LitCTFå¤ç°"><img class="cover" src="https://s2.loli.net/2023/05/14/CtirxsS8YE7qhFA.png" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2023-05-14</div><div class="title">LitCTFå¤ç°</div></div></a></div><div><a href="/2022/12/29/RSA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" title="RSAå­¦ä¹ ç¬”è®°"><img class="cover" src="https://s2.loli.net/2022/12/29/3bxISilKj1aPFsc.png" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2022-12-29</div><div class="title">RSAå­¦ä¹ ç¬”è®°</div></div></a></div><div><a href="/2023/04/20/NSSCTF%E9%A2%98%E8%A7%A3%EF%BC%88%E4%BA%8C%EF%BC%89/" title="NSSCTFé¢˜è§£ï¼ˆäºŒï¼‰"><img class="cover" src="https://s2.loli.net/2023/04/20/KwuxEDmo3PNta9d.png" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2023-04-20</div><div class="title">NSSCTFé¢˜è§£ï¼ˆäºŒï¼‰</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="anzhiyufont anzhiyu-icon-comments"></i><span> è¯„è®º</span></div><div class="comment-randomInfo" style="display: none"><a onclick="anzhiyu.addRandomCommentInfo()" href="javascript:void(0)">åŒ¿åè¯„è®º</a></div><div class="comment-tips" id="comment-tips"><span>ä½ æ— éœ€åˆ é™¤ç©ºè¡Œï¼Œç›´æ¥è¯„è®ºä»¥è·å–æœ€ä½³å±•ç¤ºæ•ˆæœ</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div><div class="comment-barrage"></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-stream"></i><span>ç›®å½•</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#WEEK-1"><span class="toc-text">WEEK 1</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#SWPU-2020-happy"><span class="toc-text">[SWPU 2020]happy</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SWPUCTF-2021-%E6%96%B0%E7%94%9F%E8%B5%9B-crypto1"><span class="toc-text">[SWPUCTF 2021 æ–°ç”Ÿèµ›]crypto1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#RoarCTF-2019-RSA"><span class="toc-text">[RoarCTF 2019]RSA</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CISCN-2021%E5%88%9D%E8%B5%9B-rsa"><span class="toc-text">[CISCN 2021åˆèµ›]rsa</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%B9%A4%E5%9F%8E%E6%9D%AF-2021-BabyRSA"><span class="toc-text">[é¹¤åŸæ¯ 2021]BabyRSA</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%BB%91%E7%9B%BE%E6%9D%AF-2020-Factor"><span class="toc-text">[é»‘ç›¾æ¯ 2020]Factor</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B9%96%E6%B9%98%E6%9D%AF-2021-signin"><span class="toc-text">[æ¹–æ¹˜æ¯ 2021]signin</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%95%BF%E5%AE%89%E6%9D%AF-2021-checkin"><span class="toc-text">[é•¿å®‰æ¯ 2021]checkin</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#WEEK-2"><span class="toc-text">WEEK 2</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#CISCN-2022-%E8%A5%BF%E5%8D%97-rsa"><span class="toc-text">[CISCN 2022 è¥¿å—]rsa</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#HGAME-2022-week1-Easy-RSA"><span class="toc-text">[HGAME 2022 week1]Easy RSA</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BE%8A%E5%9F%8E%E6%9D%AF-2020-RRRRRRRSA"><span class="toc-text">[ç¾ŠåŸæ¯ 2020]RRRRRRRSA</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SWPUCTF-2021-%E6%96%B0%E7%94%9F%E8%B5%9B-crypto3"><span class="toc-text">[SWPUCTF 2021 æ–°ç”Ÿèµ›]crypto3</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#TSGCTF-2021-Beginner%E2%80%99s-Crypto-2021"><span class="toc-text">[TSGCTF 2021]Beginnerâ€™s Crypto 2021</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%95%BF%E5%9F%8E%E6%9D%AF-2022-%E6%94%BF%E4%BC%81%E7%BB%84-xor"><span class="toc-text">[é•¿åŸæ¯ 2022 æ”¿ä¼ç»„]xor</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BA%A2%E6%98%8E%E8%B0%B7CTF-2022-easy-ya"><span class="toc-text">[çº¢æ˜è°·CTF 2022]easy_ya</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#WEEK-3"><span class="toc-text">WEEK 3</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#zer0pts-2020-ROR"><span class="toc-text">[zer0pts 2020]ROR</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#HUBUCTF-2022-%E6%96%B0%E7%94%9F%E8%B5%9B-ezMath"><span class="toc-text">[HUBUCTF 2022 æ–°ç”Ÿèµ›]ezMath</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B9%BF%E4%B8%9C%E5%BC%BA%E7%BD%91%E6%9D%AF-2021-%E5%9B%A2%E9%98%9F%E7%BB%84-RSA-and-BASE"><span class="toc-text">[å¹¿ä¸œå¼ºç½‘æ¯ 2021 å›¢é˜Ÿç»„]RSA and BASE?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#GKCTF-2021-RRRRsa"><span class="toc-text">[GKCTF 2021]RRRRsa</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#WEEK-4"><span class="toc-text">WEEK 4</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#MTCTF-2021-hamburgerRSA"><span class="toc-text">[MTCTF 2021]hamburgerRSA</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%B9%8F%E5%9F%8E%E6%9D%AF-2022-babyrsa"><span class="toc-text">[é¹åŸæ¯ 2022]babyrsa</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BE%8A%E5%9F%8E%E6%9D%AF-2021-Easy-Rsa"><span class="toc-text">[ç¾ŠåŸæ¯ 2021]Easy_Rsa</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BC%BA%E7%BD%91%E6%9D%AF-2022-ASR"><span class="toc-text">[å¼ºç½‘æ¯ 2022]ASR</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#watevrCTF-2019-ECC-RSA"><span class="toc-text">[watevrCTF 2019]ECC-RSA</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BC%BA%E7%BD%91%E6%8B%9F%E6%80%81-2021-ONLYRSA"><span class="toc-text">[å¼ºç½‘æ‹Ÿæ€ 2021]ONLYRSA</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#NISACTF-2022-xor"><span class="toc-text">[NISACTF 2022]xor</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#NSSCTF-Round-11-Basic"><span class="toc-text">NSSCTF Round#11 Basic</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#ez-enc"><span class="toc-text">ez_enc</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MyMessage"><span class="toc-text">MyMessage</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MyGame"><span class="toc-text">MyGame</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ez-signin"><span class="toc-text">ez_signin</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ez-fac"><span class="toc-text">ez_fac</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#NTR"><span class="toc-text">NTR</span></a></li></ol></li></ol></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2022 - 2024 By Chemtrails</div><div class="footer_custom_text"><a href="https://beian.miit.gov.cn/#/Integrated/index" style="color:var(--anzhiyu-fontcolor)" target="_blank">é²ICPå¤‡2022041228å·</a></div></div></footer><div id="quit-box" onclick="anzhiyu.removeRewardMask()" style="display: none"></div></div><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><img class="loading-img nolazyload" src="https://ch3mtr4ils.cn/img/tit.png"/><div class="loading-image-dot"></div><div id="loading-percentage">0%</div></div></div><script>const loadingPercentage = document.getElementById("loading-percentage");
let loadingPercentageTimer = setInterval(function() {
  var progressBar = document.querySelector(".pace-progress");
  if (!progressBar) return
  var currentValue = progressBar.getAttribute("data-progress-text");
  if (currentValue !== loadingPercentage.textContent) {
    loadingPercentage.textContent = currentValue;
    if (currentValue === "100%") {
      clearInterval(loadingPercentageTimer);
    }
  }
}, 100);
const preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")
  }
}
window.addEventListener('load',()=> { preloader.endLoading() })

if (true) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><link rel="stylesheet" href="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/progress_bar/progress_bar.css"/><script async="async" src="https://npm.elemecdn.com/pace-js@1.2.4/pace.min.js" data-pace-options="{ &quot;restartOnRequestAfter&quot;:false,&quot;eventLag&quot;:false}"></script><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://ch3mtr4ils.cn/img/tit.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/" title="archive"><div class="headline">æ–‡ç« </div><div class="length-num">77</div></a><a href="/tags/" title="tag"><div class="headline">æ ‡ç­¾</div><div class="length-num">35</div></a><a href="/categories/" title="category"><div class="headline">åˆ†ç±»</div><div class="length-num">6</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page faa-parent animated-hover" href="javascript:void(0);"><span> æ–‡ç« </span></a><ul class="menus_item_child" style="left:-79px;"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> å½’æ¡£</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> åˆ†ç±»</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> æ ‡ç­¾</span></a></li></ul></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="javascript:void(0);"><span> å‹é“¾</span></a><ul class="menus_item_child" style="left:17px;"><li><a class="site-page child faa-parent animated-hover" href="/link/"><i class="anzhiyufont anzhiyu-icon-link faa-tada" style="font-size: 0.9em;"></i><span> å‹äººå¸</span></a></li></ul></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="javascript:void(0);"><span> å…³äº</span></a><ul class="menus_item_child" style="left:-31px;"><li><a class="site-page child faa-parent animated-hover" href="/essay/"><i class="anzhiyufont anzhiyu-icon-lightbulb faa-tada" style="font-size: 0.9em;"></i><span> é—²è¨€ç¢è¯­</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()"><i class="anzhiyufont anzhiyu-icon-shoe-prints1 faa-tada" style="font-size: 0.9em;"></i><span> éšä¾¿é€›é€›</span></a></li></ul></div></div></div></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="anzhiyufont anzhiyu-icon-book-open"></i></button><button id="translateLink" type="button" title="ç®€ç¹è½¬æ¢">ç¹</button><button id="darkmode" type="button" title="æµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬æ¢"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i></button><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="è®¾ç½®"><i class="anzhiyufont anzhiyu-icon-gear"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="anzhiyufont anzhiyu-icon-list-ul"></i></button><a id="to_comment" href="#post-comment" title="ç›´è¾¾è¯„è®º"><i class="anzhiyufont anzhiyu-icon-comments"></i></a><a id="switch_commentBarrage" href="javascript:anzhiyu.switchCommentBarrage();" title="å¼€å…³å¼¹å¹•"><i class="anzhiyufont anzhiyu-icon-danmu"></i></a><button id="center-console" type="button" title="ä¸­æ§å°"><i class="anzhiyufont anzhiyu-icon-fish"></i></button><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><div id="nav-music"><div id="nav-music-hoverTips" onclick="anzhiyu.musicToggle()">æ’­æ”¾éŸ³ä¹</div><div id="console-music-bg"></div><meting-js id="2987103132" server="netease" type="playlist" mutex="true" preload="none" theme="var(--anzhiyu-main)" data-lrctype="0" order="random"></meting-js></div><div id="console"><div class="close-btn" onclick="anzhiyu.hideConsole()" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-circle-xmark" style="font-size: 35px;"></i></div><div class="console-card-group-reward"><ul class="reward-all console-card"><li class="reward-item"><a href="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-weichat.png" target="_blank"><img class="post-qr-code-img" alt="wechat" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-weichat.png"/></a><div class="post-qr-code-desc">wechat</div></li><li class="reward-item"><a href="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-alipay.png" target="_blank"><img class="post-qr-code-img" alt="alipay" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-alipay.png"/></a><div class="post-qr-code-desc">alipay</div></li></ul></div><div class="console-card-group"><div class="console-card-group-left"><div class="console-card" id="card-newest-comments" onclick="anzhiyu.hideConsole()"><div class="card-content"><div class="author-content-item-tips">äº’åŠ¨</div><span class="author-content-item-title"> <span>æœ€æ–°è¯„è®º</span></span></div><div class="aside-list"><span>æ­£åœ¨åŠ è½½ä¸­...</span></div></div></div><div class="console-card-group-right"><div class="console-card tags" onclick="anzhiyu.hideConsole()"><div class="card-content"><div class="author-content-item-tips">å…´è¶£ç‚¹</div><span class="author-content-item-title">å¯»æ‰¾ä½ æ„Ÿå…´è¶£çš„é¢†åŸŸ</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/AES/" style="font-size: 1.22em; color: rgb(197, 157, 183)">AES<sup>3</sup></a><a href="/tags/DES/" style="font-size: 1.15em; color: rgb(31, 165, 47)">DES<sup>1</sup></a><a href="/tags/Diffie-Hellman/" style="font-size: 1.15em; color: rgb(139, 130, 192)">Diffie-Hellman<sup>1</sup></a><a href="/tags/ECC/" style="font-size: 1.38em; color: rgb(117, 123, 5)">ECC<sup>7</sup></a><a href="/tags/ElGamal/" style="font-size: 1.15em; color: rgb(59, 18, 68)">ElGamal<sup>1</sup></a><a href="/tags/HTML/" style="font-size: 1.15em; color: rgb(131, 121, 136)">HTML<sup>1</sup></a><a href="/tags/JS/" style="font-size: 1.15em; color: rgb(33, 14, 85)">JS<sup>1</sup></a><a href="/tags/JWT/" style="font-size: 1.15em; color: rgb(98, 166, 86)">JWT<sup>1</sup></a><a href="/tags/Java/" style="font-size: 1.19em; color: rgb(197, 1, 136)">Java<sup>2</sup></a><a href="/tags/RSA/" style="font-size: 1.45em; color: rgb(194, 6, 139)">RSA<sup>24</sup></a><a href="/tags/css/" style="font-size: 1.19em; color: rgb(157, 102, 128)">css<sup>2</sup></a><a href="/tags/git/" style="font-size: 1.15em; color: rgb(7, 105, 68)">git<sup>1</sup></a><a href="/tags/linux/" style="font-size: 1.15em; color: rgb(73, 85, 91)">linux<sup>1</sup></a><a href="/tags/paper/" style="font-size: 1.15em; color: rgb(32, 81, 140)">paper<sup>1</sup></a><a href="/tags/python/" style="font-size: 1.26em; color: rgb(17, 67, 6)">python<sup>4</sup></a><a href="/tags/%E5%8C%BA%E5%9D%97%E9%93%BE/" style="font-size: 1.19em; color: rgb(49, 25, 197)">åŒºå—é“¾<sup>2</sup></a><a href="/tags/%E5%8F%A4%E5%85%B8%E5%AF%86%E7%A0%81/" style="font-size: 1.3em; color: rgb(137, 73, 175)">å¤å…¸å¯†ç <sup>5</sup></a><a href="/tags/%E5%8F%AF%E4%BF%A1%E8%AE%A1%E7%AE%97/" style="font-size: 1.15em; color: rgb(175, 29, 39)">å¯ä¿¡è®¡ç®—<sup>1</sup></a><a href="/tags/%E5%93%88%E5%B8%8C%E5%87%BD%E6%95%B0/" style="font-size: 1.15em; color: rgb(110, 200, 50)">å“ˆå¸Œå‡½æ•°<sup>1</sup></a><a href="/tags/%E5%9B%BE%E7%89%87%E5%88%86%E6%9E%90/" style="font-size: 1.3em; color: rgb(35, 118, 82)">å›¾ç‰‡åˆ†æ<sup>5</sup></a><a href="/tags/%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99/" style="font-size: 1.3em; color: rgb(111, 149, 24)">å›¾ç‰‡éšå†™<sup>5</sup></a><a href="/tags/%E5%A4%9A%E9%A1%B9%E5%BC%8F/" style="font-size: 1.22em; color: rgb(35, 168, 67)">å¤šé¡¹å¼<sup>3</sup></a><a href="/tags/%E6%8A%BD%E8%B1%A1%E4%BB%A3%E6%95%B0/" style="font-size: 1.3em; color: rgb(91, 185, 69)">æŠ½è±¡ä»£æ•°<sup>5</sup></a><a href="/tags/%E6%95%B0%E8%AE%BA/" style="font-size: 1.3em; color: rgb(76, 3, 70)">æ•°è®º<sup>5</sup></a><a href="/tags/%E6%A0%88%E6%BA%A2%E5%87%BA/" style="font-size: 1.15em; color: rgb(50, 69, 51)">æ ˆæº¢å‡º<sup>1</sup></a><a href="/tags/%E6%A0%BC/" style="font-size: 1.41em; color: rgb(135, 151, 15)">æ ¼<sup>8</sup></a><a href="/tags/%E6%B1%87%E7%BC%96/" style="font-size: 1.19em; color: rgb(4, 67, 127)">æ±‡ç¼–<sup>2</sup></a><a href="/tags/%E6%B5%81%E5%AF%86%E7%A0%81/" style="font-size: 1.38em; color: rgb(49, 27, 107)">æµå¯†ç <sup>7</sup></a><a href="/tags/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/" style="font-size: 1.19em; color: rgb(99, 13, 160)">æµé‡åˆ†æ<sup>2</sup></a><a href="/tags/%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0/" style="font-size: 1.19em; color: rgb(25, 186, 109)">çº¿æ€§ä»£æ•°<sup>2</sup></a><a href="/tags/%E7%BC%96%E7%A0%81/" style="font-size: 1.34em; color: rgb(153, 188, 42)">ç¼–ç <sup>6</sup></a><a href="/tags/%E8%83%8C%E5%8C%85%E5%AF%86%E7%A0%81/" style="font-size: 1.15em; color: rgb(157, 136, 135)">èƒŒåŒ…å¯†ç <sup>1</sup></a><a href="/tags/%E9%80%86%E5%90%91/" style="font-size: 1.22em; color: rgb(124, 35, 30)">é€†å‘<sup>3</sup></a><a href="/tags/%E9%87%8F%E5%AD%90%E8%AE%A1%E7%AE%97/" style="font-size: 1.19em; color: rgb(139, 71, 110)">é‡å­è®¡ç®—<sup>2</sup></a><a href="/tags/%E9%9A%8F%E6%9C%BA%E6%95%B0/" style="font-size: 1.26em; color: rgb(9, 17, 18)">éšæœºæ•°<sup>4</sup></a></div></div><hr/></div></div><div class="console-card history" onclick="anzhiyu.hideConsole()"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-box-archiv"></i><span>æ–‡ç« </span></div><div class="card-archives"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-archive"></i><span>å½’æ¡£</span><a class="card-more-btn" href="/archives/" title="æŸ¥çœ‹æ›´å¤š">
    <i class="anzhiyufont anzhiyu-icon-angle-right"></i></a></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/04/"><span class="card-archive-list-date">å››æœˆ 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">5</span><span>ç¯‡</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/03/"><span class="card-archive-list-date">ä¸‰æœˆ 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">3</span><span>ç¯‡</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/02/"><span class="card-archive-list-date">äºŒæœˆ 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">4</span><span>ç¯‡</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/01/"><span class="card-archive-list-date">ä¸€æœˆ 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">5</span><span>ç¯‡</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/11/"><span class="card-archive-list-date">åä¸€æœˆ 2023</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">2</span><span>ç¯‡</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/10/"><span class="card-archive-list-date">åæœˆ 2023</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">4</span><span>ç¯‡</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/09/"><span class="card-archive-list-date">ä¹æœˆ 2023</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">6</span><span>ç¯‡</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/08/"><span class="card-archive-list-date">å…«æœˆ 2023</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">3</span><span>ç¯‡</span></div></a></li></ul></div><hr/></div></div></div><div class="button-group"><div class="console-btn-item"><a class="darkmode_switchbutton" onclick="rm.switchDarkMode()" title="æ˜¾ç¤ºæ¨¡å¼åˆ‡æ¢" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-moon"></i></a></div><div class="console-btn-item" id="consoleHideAside" onclick="anzhiyu.hideAsideBtn()" title="è¾¹æ æ˜¾ç¤ºæ§åˆ¶"><a class="asideSwitch"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></a></div><div class="console-btn-item on" id="consoleCommentBarrage" onclick="anzhiyu.switchCommentBarrage()" title="çƒ­è¯„å¼€å…³"><a class="commentBarrage"><i class="anzhiyufont anzhiyu-icon-message"></i></a></div><div class="console-btn-item" id="consoleMusic" onclick="anzhiyu.musicToggle()" title="éŸ³ä¹å¼€å…³"><a class="music-switch"><i class="anzhiyufont anzhiyu-icon-music"></i></a></div></div><div class="console-mask" onclick="anzhiyu.hideConsole()" href="javascript:void(0);"></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">æœç´¢</span><span id="loading-status"></span><button class="search-close-button"><i class="anzhiyufont anzhiyu-icon-xmark"></i></button></nav><div class="is-center" id="loading-database"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-pulse-icon"></i><span>  æ•°æ®åº“åŠ è½½ä¸­</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="æœç´¢æ–‡ç« " type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><div class="rightMenu-item" id="menu-backward"><i class="anzhiyufont anzhiyu-icon-arrow-left"></i></div><div class="rightMenu-item" id="menu-forward"><i class="anzhiyufont anzhiyu-icon-arrow-right"></i></div><div class="rightMenu-item" id="menu-refresh"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right" style="font-size: 1rem;"></i></div><div class="rightMenu-item" id="menu-top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class="rightMenu-item" id="menu-copytext"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>å¤åˆ¶é€‰ä¸­æ–‡æœ¬</span></div><div class="rightMenu-item" id="menu-pastetext"><i class="anzhiyufont anzhiyu-icon-paste"></i><span>ç²˜è´´æ–‡æœ¬</span></div><a class="rightMenu-item" id="menu-commenttext"><i class="anzhiyufont anzhiyu-icon-comment-medical"></i><span>å¼•ç”¨åˆ°è¯„è®º</span></a><div class="rightMenu-item" id="menu-newwindow"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>æ–°çª—å£æ‰“å¼€</span></div><div class="rightMenu-item" id="menu-copylink"><i class="anzhiyufont anzhiyu-icon-link"></i><span>å¤åˆ¶é“¾æ¥åœ°å€</span></div><div class="rightMenu-item" id="menu-copyimg"><i class="anzhiyufont anzhiyu-icon-images"></i><span>å¤åˆ¶æ­¤å›¾ç‰‡</span></div><div class="rightMenu-item" id="menu-downloadimg"><i class="anzhiyufont anzhiyu-icon-download"></i><span>ä¸‹è½½æ­¤å›¾ç‰‡</span></div><div class="rightMenu-item" id="menu-newwindowimg"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>æ–°çª—å£æ‰“å¼€å›¾ç‰‡</span></div><div class="rightMenu-item" id="menu-search"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>ç«™å†…æœç´¢</span></div><div class="rightMenu-item" id="menu-searchBaidu"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>ç™¾åº¦æœç´¢</span></div><div class="rightMenu-item" id="menu-music-toggle"><i class="anzhiyufont anzhiyu-icon-play"></i><span>æ’­æ”¾éŸ³ä¹</span></div><div class="rightMenu-item" id="menu-music-back"><i class="anzhiyufont anzhiyu-icon-backward"></i><span>åˆ‡æ¢åˆ°ä¸Šä¸€é¦–</span></div><div class="rightMenu-item" id="menu-music-forward"><i class="anzhiyufont anzhiyu-icon-forward"></i><span>åˆ‡æ¢åˆ°ä¸‹ä¸€é¦–</span></div><div class="rightMenu-item" id="menu-music-playlist" onclick="window.open(&quot;https://music.163.com/#/my/m/music/playlist?id=2987103132&quot;, &quot;_blank&quot;);" style="display: none;"><i class="anzhiyufont anzhiyu-icon-radio"></i><span>æŸ¥çœ‹æ‰€æœ‰æ­Œæ›²</span></div><div class="rightMenu-item" id="menu-music-copyMusicName"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>å¤åˆ¶æ­Œå</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" id="menu-randomPost"><i class="anzhiyufont anzhiyu-icon-shuffle"></i><span>éšä¾¿é€›é€›</span></a><a class="rightMenu-item menu-link" href="/categories/"><i class="anzhiyufont anzhiyu-icon-cube"></i><span>åšå®¢åˆ†ç±»</span></a><a class="rightMenu-item menu-link" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags"></i><span>æ–‡ç« æ ‡ç­¾</span></a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item" id="menu-copy" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>å¤åˆ¶åœ°å€</span></a><a class="rightMenu-item" id="menu-commentBarrage" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-message"></i><span class="menu-commentBarrage-text">å…³é—­çƒ­è¯„</span></a><a class="rightMenu-item" id="menu-darkmode" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span class="menu-darkmode-text">æ·±è‰²æ¨¡å¼</span></a><a class="rightMenu-item" id="menu-translate" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-language"></i><span>è½‰ç‚ºç¹é«”</span></a></div></div><div id="rightmenu-mask"></div><div id="he-plugin-simple"></div><script>var WIDGET = {
  "CONFIG": {
    "modules": "0124",
    "background": "2",
    "tmpColor": "FFFFFF",
    "tmpSize": "16",
    "cityColor": "FFFFFF",
    "citySize": "16",
    "aqiColor": "E8D87B",
    "aqiSize": "16",
    "weatherIconSize": "24",
    "alertIconSize": "18",
    "padding": "10px 10px 10px 10px",
    "shadow": "0",
    "language": "auto",
    "borderRadius": "20",
    "fixed": "true",
    "vertical": "top",
    "horizontal": "left",
    "left": "20",
    "top": "7.1",
    "key": "df245676fb434a0691ead1c63341cd94"
  }
}
</script><link rel="stylesheet" href="https://widget.qweather.net/simple/static/css/he-simple.css?v=1.4.0"/><script src="https://widget.qweather.net/simple/static/js/he-simple.js?v=1.4.0"></script><div><script src="https://npm.elemecdn.com/hexo-theme-anzhiyu@1.1.7/source/js/utils.js"></script><script src="https://npm.elemecdn.com/hexo-theme-anzhiyu@1.1.7/source/js/main.js"></script><script src="https://npm.elemecdn.com/hexo-theme-anzhiyu@1.1.7/source/js/tw_cn.js"></script><script src="https://npm.elemecdn.com/@fancyapps/ui@4.0.31/dist/fancybox.umd.js"></script><script src="https://npm.elemecdn.com/instant.page@5.1.1/instantpage.js" type="module"></script><script src="https://npm.elemecdn.com/vanilla-lazyload@17.3.1/dist/lazyload.iife.min.js"></script><script src="https://npm.elemecdn.com/node-snackbar@0.1.16/dist/snackbar.min.js"></script><canvas id="universe"></canvas><script async src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/dark/dark.js"></script><script>// æ¶ˆé™¤æ§åˆ¶å°æ‰“å°
var HoldLog = console.log;
console.log = function () {};
let now1 = new Date();
queueMicrotask(() => {
  console.log(1)
  const Log = function () {
    HoldLog.apply(console, arguments);
  }; //åœ¨æ¢å¤å‰è¾“å‡ºæ—¥å¿—
  const grt = new Date("11/4/2022 00:00:00"); //æ­¤å¤„ä¿®æ”¹ä½ çš„å»ºç«™æ—¶é—´æˆ–è€…ç½‘ç«™ä¸Šçº¿æ—¶é—´
  now1.setTime(now1.getTime() + 250);
  const days = (now1 - grt) / 1000 / 60 / 60 / 24;
  const dnum = Math.floor(days);
  const ascll = [
    `æ­£åœ¨çœ‹ç½‘ç«™çš„ä½ !`,
    `æˆ‘çš„ç½‘ç«™`,
    "å·²ä¸Šçº¿",
    dnum,
    "å¤©",
    "Â©2022 By Chemtrails",
  ];
  const ascll2 = [`HELLO`, `è°ƒç”¨å‰ç½®æ‘„åƒå¤´æ‹ç…§æˆåŠŸï¼Œè¯†åˆ«ä¸ºã€å°ç¬¨è›‹ã€‘.`, `ç…§ç‰‡æ•è·: `, `ğŸ¤ª`];

  setTimeout(
    Log.bind(
      console,
      `\n%c${ascll[0]} %c ${ascll[1]} %c ${ascll[2]} %c${ascll[3]}%c ${ascll[4]}%c ${ascll[5]}\n\n%c ${ascll[6]}\n`,
      "color:#3b70fc",
      "",
      "color:#3b70fc",
      "color:#3b70fc",
      "",
      "color:#3b70fc",
      ""
    )
  );
  setTimeout(
    Log.bind(
      console,
      `%c ${ascll2[0]} %c ${ascll2[1]} %c \n${ascll2[2]} %c\n${ascll2[3]}\n`,
      "color:white; background-color:#4fd953",
      "",
      "",
      'background:url("https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/tinggge.gif") no-repeat;font-size:450%'
    )
  );

  setTimeout(Log.bind(console, "%c WELCOME %c ä½ å¥½ï¼Œå°ç¬¨è›‹ï¼Œä½ å·²æ‰“å¼€æ§åˆ¶å°ã€‚", "color:white; background-color:#4f90d9", ""));
  setTimeout(Log.bind(console, "%c âš¡ Powered by Chemtrails %c ä½ æ­£åœ¨è®¿é—® Chemtrails çš„åšå®¢ã€‚", "color:white; background-color:#f0ad4e", ""));

});</script><script async src="/anzhiyu/random.js"></script><script src="https://npm.elemecdn.com/hexo-theme-anzhiyu@1.1.7/source/js/search/local-search.js"></script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [ ['$','$'], ["\\(","\\)"]],
      tags: 'ams'
    },
    chtml: {
      scale: 1.2
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, ''],
        insertScript: [200, () => {
          document.querySelectorAll('mjx-container:not\([display]\)').forEach(node => {
            const target = node.parentNode
            if (target.nodeName.toLowerCase() === 'li') {
              target.parentNode.classList.add('has-jax')
            } else {
              target.classList.add('has-jax')
            }
          });
        }, '', false]
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://npm.elemecdn.com/mathjax@3.2.2/es5/tex-mml-chtml.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typeset()
}</script><script>(()=>{
  const init = () => {
    twikoo.init(Object.assign({
      el: '#twikoo-wrap',
      envId: 'https://twikoo.ch3mtr4ils.cn/',
      region: '',
      onCommentLoaded: function () {
        anzhiyu.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      }
    }, null))
  }

  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: 'https://twikoo.ch3mtr4ils.cn/',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(function (res) {
      countELement.innerText = res[0].count
    }).catch(function (err) {
      console.error(err);
    });
  }

  const runFn = () => {
    init()
    
  }

  const loadTwikoo = () => {
    if (typeof twikoo === 'object') {
      setTimeout(runFn,0)
      return
    } 
    getScript('https://npm.elemecdn.com/twikoo@1.6.11/dist/twikoo.all.min.js').then(runFn)
  }
  if ('Twikoo' === 'Twikoo' || !false) {
    if (false) anzhiyu.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else loadTwikoo()
  } else {
    window.loadOtherComment = () => {
      loadTwikoo()
    }
  }
})()</script><input type="hidden" name="page-type" id="page-type" value="post"></div><script>window.addEventListener('load', () => {
  const changeContent = (content) => {
    if (content === '') return content

    content = content.replace(/<img.*?src="(.*?)"?[^\>]+>/ig, '[å›¾ç‰‡]') // replace image link
    content = content.replace(/<a[^>]+?href=["']?([^"']+)["']?[^>]*>([^<]+)<\/a>/gi, '[é“¾æ¥]') // replace url
    content = content.replace(/<pre><code>.*?<\/pre>/gi, '[ä»£ç ]') // replace code
    content = content.replace(/<[^>]+>/g,"") // remove html tag

    if (content.length > 150) {
      content = content.substring(0,150) + '...'
    }
    return content
  }

  const getComment = () => {
    const runTwikoo = () => {
      twikoo.getRecentComments({
        envId: 'https://twikoo.ch3mtr4ils.cn/',
        region: '',
        pageSize: 6,
        includeReply: true
      }).then(function (res) {
        const twikooArray = res.map(e => {
          return {
            'content': changeContent(e.comment),
            'avatar': e.avatar,
            'nick': e.nick,
            'url': e.url + '#' + e.id,
            'date': new Date(e.created).toISOString()
          }
        })

        saveToLocal.set('twikoo-newest-comments', JSON.stringify(twikooArray), 10/(60*24))
        generateHtml(twikooArray)
      }).catch(function (err) {
        const $dom = document.querySelector('#card-newest-comments .aside-list')
        $dom.innerHTML= "æ— æ³•è·å–è¯„è®ºï¼Œè¯·ç¡®è®¤ç›¸å…³é…ç½®æ˜¯å¦æ­£ç¡®"
      })
    }

    if (typeof twikoo === 'object') {
      runTwikoo()
    } else {
      getScript('https://npm.elemecdn.com/twikoo@1.6.11/dist/twikoo.all.min.js').then(runTwikoo)
    }
  }

  const generateHtml = array => {
    let result = ''

    if (array.length) {
      for (let i = 0; i < array.length; i++) {
        result += '<div class=\'aside-list-item\'>'

        if (true) {
          const name = 'data-lazy-src'
          result += `<a href='${array[i].url}' class='thumbnail'><img ${name}='${array[i].avatar}' alt='${array[i].nick}'><div class='name'><span>${array[i].nick}</span></div></a>`
        }
        
        result += `<div class='content'>
        <a class='comment' href='${array[i].url}' title='${array[i].content}'>${array[i].content}</a>
        <time datetime="${array[i].date}">${anzhiyu.diffDate(array[i].date, true)}</time></div>
        </div>`
      }
    } else {
      result += 'æ²¡æœ‰è¯„è®º'
    }

    let $dom = document.querySelector('#card-newest-comments .aside-list')
    $dom.innerHTML= result
    window.lazyLoadInstance && window.lazyLoadInstance.update()
    window.pjax && window.pjax.refresh($dom)
  }

  const newestCommentInit = () => {
    if (document.querySelector('#card-newest-comments .aside-list')) {
      const data = saveToLocal.get('twikoo-newest-comments')
      if (data) {
        generateHtml(JSON.parse(data))
      } else {
        getComment()
      }
    }
  }

  newestCommentInit()
  document.addEventListener('pjax:complete', newestCommentInit)
})</script><script async data-pjax src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.1/bubble/bubble.js"></script><script data-pjax src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/catalog-bar/catalog-bar.js"></script><script async data-pjax src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/categoryBar/categoryBar.js"></script><script async data-pjax src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/waterfall/waterfall.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/qrcodejs/1.0.0/qrcode.min.js"></script><script>// åˆå§‹åŒ–å‡½æ•°
let rm = {};

//ç¦æ­¢å›¾ç‰‡æ‹–æ‹½
let imgElements = document.getElementsByTagName("img");
for (let i = 0; i < imgElements.length; i++) {
  imgElements[i].addEventListener("dragstart", function (event) {
    event.preventDefault();
  });
}

// æ˜¾ç¤ºèœå•
rm.showRightMenu = function (isTrue, x = 0, y = 0) {
  console.info(x, y)
  let rightMenu = document.getElementById("rightMenu");
  rightMenu.style.top = x + "px";
  rightMenu.style.left = y + "px";
  if (isTrue) {
    rightMenu.style.display = "block";
    stopMaskScroll();
  } else {
    rightMenu.style.display = "none";
  }
};

// éšè—èœå•
rm.hideRightMenu = function () {
  rm.showRightMenu(false);
  let rightMenuMask = document.querySelector("#rightmenu-mask");
  rightMenuMask.style.display = "none";
};

// å°ºå¯¸
let rmWidth = document.getElementById("rightMenu").offsetWidth;
let rmHeight = document.getElementById("rightMenu").offsetHeight;

// é‡æ–°å®šä¹‰å°ºå¯¸
rm.reloadrmSize = function () {
  rightMenu.style.visibility = "hidden";
  rightMenu.style.display = "block";
  // è·å–å®½åº¦å’Œé«˜åº¦
  rmWidth = document.getElementById("rightMenu").offsetWidth;
  rmHeight = document.getElementById("rightMenu").offsetHeight;
  rightMenu.style.visibility = "visible";
};

// è·å–ç‚¹å‡»çš„href
let domhref = "";
let domImgSrc = "";
let globalEvent = null;

// ç›‘å¬å³é”®åˆå§‹åŒ–
window.oncontextmenu = function (event) {
  if (document.body.clientWidth > 768) {
    let pageX = event.clientX + 10; //åŠ 10æ˜¯ä¸ºäº†é˜²æ­¢æ˜¾ç¤ºæ—¶é¼ æ ‡é®åœ¨èœå•ä¸Š
    let pageY = event.clientY;

    //å…¶ä»–é¢å¤–èœå•
    const $rightMenuOther = document.querySelector(".rightMenuOther");
    const $rightMenuPlugin = document.querySelector(".rightMenuPlugin");
    const $rightMenuCopyText = document.querySelector("#menu-copytext");
    const $rightMenuPasteText = document.querySelector("#menu-pastetext");
    const $rightMenuCommentText = document.querySelector("#menu-commenttext");
    const $rightMenuNewWindow = document.querySelector("#menu-newwindow");
    const $rightMenuNewWindowImg = document.querySelector("#menu-newwindowimg");
    const $rightMenuCopyLink = document.querySelector("#menu-copylink");
    const $rightMenuCopyImg = document.querySelector("#menu-copyimg");
    const $rightMenuDownloadImg = document.querySelector("#menu-downloadimg");
    const $rightMenuSearch = document.querySelector("#menu-search");
    const $rightMenuSearchBaidu = document.querySelector("#menu-searchBaidu");
    const $rightMenuMusicToggle = document.querySelector("#menu-music-toggle");
    const $rightMenuMusicBack = document.querySelector("#menu-music-back");
    const $rightMenuMusicForward = document.querySelector("#menu-music-forward");
    const $rightMenuMusicPlaylist = document.querySelector("#menu-music-playlist");
    const $rightMenuMusicCopyMusicName = document.querySelector("#menu-music-copyMusicName");

    let href = event.target.href;
    let imgsrc = event.target.currentSrc;

    // åˆ¤æ–­æ¨¡å¼ æ‰©å±•æ¨¡å¼ä¸ºæœ‰äº‹ä»¶
    let pluginMode = false;
    $rightMenuOther.style.display = "block";
    globalEvent = event;

    // æ£€æŸ¥æ˜¯å¦éœ€è¦å¤åˆ¶ æ˜¯å¦æœ‰é€‰ä¸­æ–‡æœ¬
    if (selectTextNow && window.getSelection()) {
      pluginMode = true;
      $rightMenuCopyText.style.display = "block";
      $rightMenuCommentText.style.display = "block";
      $rightMenuSearch.style.display = "block";
      $rightMenuSearchBaidu.style.display = "block";
    } else {
      $rightMenuCopyText.style.display = "none";
      $rightMenuCommentText.style.display = "none";
      $rightMenuSearchBaidu.style.display = "none";
      $rightMenuSearch.style.display = "none";
    }

    //æ£€æŸ¥æ˜¯å¦å³é”®ç‚¹å‡»äº†é“¾æ¥aæ ‡ç­¾
    if (href) {
      pluginMode = true;
      $rightMenuNewWindow.style.display = "block";
      $rightMenuCopyLink.style.display = "block";
      domhref = href;
    } else {
      $rightMenuNewWindow.style.display = "none";
      $rightMenuCopyLink.style.display = "none";
    }

    //æ£€æŸ¥æ˜¯å¦éœ€è¦å¤åˆ¶å›¾ç‰‡
    if (imgsrc) {
      pluginMode = true;
      $rightMenuCopyImg.style.display = "block";
      $rightMenuDownloadImg.style.display = "block";
      $rightMenuNewWindowImg.style.display = "block";
      document.getElementById("rightMenu").style.width="12rem"
      domImgSrc = imgsrc;
    } else {
      $rightMenuCopyImg.style.display = "none";
      $rightMenuDownloadImg.style.display = "none";
      $rightMenuNewWindowImg.style.display = "none";
    }

    // åˆ¤æ–­æ˜¯å¦ä¸ºè¾“å…¥æ¡†
    if (event.target.tagName.toLowerCase() === "input" || event.target.tagName.toLowerCase() === "textarea") {
      pluginMode = true;
      $rightMenuPasteText.style.display = "block";
    } else {
      $rightMenuPasteText.style.display = "none";
    }
    const navMusicEl = document.querySelector("#nav-music");
    //åˆ¤æ–­æ˜¯å¦æ˜¯éŸ³ä¹
    if (navMusicEl && navMusicEl.contains(event.target)) {
      pluginMode = true;
      $rightMenuMusicToggle.style.display = "block";
      $rightMenuMusicBack.style.display = "block";
      $rightMenuMusicForward.style.display = "block";
      $rightMenuMusicPlaylist.style.display = "block";
      $rightMenuMusicCopyMusicName.style.display = "block";
    } else {
      $rightMenuMusicToggle.style.display = "none";
      $rightMenuMusicBack.style.display = "none";
      $rightMenuMusicForward.style.display = "none";
      $rightMenuMusicPlaylist.style.display = "none";
      $rightMenuMusicCopyMusicName.style.display = "none";
    }

    // å¦‚æœä¸æ˜¯æ‰©å±•æ¨¡å¼åˆ™éšè—æ‰©å±•æ¨¡å—
    if (pluginMode) {
      $rightMenuOther.style.display = "none";
      $rightMenuPlugin.style.display = "block";
    } else {
      $rightMenuPlugin.style.display = "none";
    }

    rm.reloadrmSize();

    // é¼ æ ‡é»˜è®¤æ˜¾ç¤ºåœ¨é¼ æ ‡å³ä¸‹æ–¹ï¼Œå½“é¼ æ ‡é å³æˆ–é ä¸‹æ—¶ï¼Œå°†èœå•æ˜¾ç¤ºåœ¨é¼ æ ‡å·¦æ–¹\ä¸Šæ–¹
    if (pageX + rmWidth > window.innerWidth) {
      pageX -= rmWidth + 10;
    }
    if (pageY + rmHeight > window.innerHeight) {
      pageY -= pageY + rmHeight - window.innerHeight;
    }

    rm.showRightMenu(true, pageY, pageX);
    document.getElementById("rightmenu-mask").style.display = "flex";
    return false;
  }
};

// ä¸‹è½½å›¾ç‰‡çŠ¶æ€
rm.downloadimging = false;

// å¤åˆ¶å›¾ç‰‡åˆ°å‰ªè´´æ¿
rm.writeClipImg = function (imgsrc) {
  console.log("æŒ‰ä¸‹å¤åˆ¶");
  rm.hideRightMenu();
  anzhiyu.snackbarShow("æ­£åœ¨ä¸‹è½½ä¸­ï¼Œè¯·ç¨å", false, 10000);
  if (rm.downloadimging == false) {
    rm.downloadimging = true;
    setTimeout(function () {
      copyImage(imgsrc);
      anzhiyu.snackbarShow("å¤åˆ¶æˆåŠŸï¼å›¾ç‰‡å·²æ·»åŠ ç›²æ°´å°ï¼Œè¯·éµå®ˆç‰ˆæƒåè®®");
      rm.downloadimging = false;
    }, "10000");
  }
};

function imageToBlob(imageURL) {
  const img = new Image();
  const c = document.createElement("canvas");
  const ctx = c.getContext("2d");
  img.crossOrigin = "";
  img.src = imageURL;
  return new Promise(resolve => {
    img.onload = function () {
      c.width = this.naturalWidth;
      c.height = this.naturalHeight;
      ctx.drawImage(this, 0, 0);
      c.toBlob(
        blob => {
          // here the image is a blob
          resolve(blob);
        },
        "image/png",
        0.75
      );
    };
  });
}

async function copyImage(imageURL) {
  const blob = await imageToBlob(imageURL);
  const item = new ClipboardItem({ "image/png": blob });
  navigator.clipboard.write([item]);
}

rm.switchDarkMode = function () {
  // Switch Between Light And Dark Mode
  const nowMode = document.documentElement.getAttribute("data-theme") === "dark" ? "dark" : "light";
  if (nowMode === "light") {
    activateDarkMode();
    saveToLocal.set("theme", "dark", 2);
    GLOBAL_CONFIG.Snackbar !== undefined && anzhiyu.snackbarShow(GLOBAL_CONFIG.Snackbar.day_to_night);
    document.querySelector(".menu-darkmode-text").textContent = "æµ…è‰²æ¨¡å¼";
  } else {
    activateLightMode();
    saveToLocal.set("theme", "light", 2);
    GLOBAL_CONFIG.Snackbar !== undefined && anzhiyu.snackbarShow(GLOBAL_CONFIG.Snackbar.night_to_day);
    document.querySelector(".menu-darkmode-text").textContent = "æ·±è‰²æ¨¡å¼";
  }
  // handle some cases
  typeof runMermaid === "function" && window.runMermaid();
  rm.hideRightMenu();
  anzhiyu.darkModeStatus();
};

rm.copyUrl = function (id) {
  const input = document.createElement("input"); // Create a new <input> element
  input.id = "copyVal"; // Set the id of the new element to "copyVal"
  document.body.appendChild(input); // Append the new element to the end of the <body> element
  
  const text = id;
  input.value = text;
  input.select();
  input.setSelectionRange(0, input.value.length);
  document.execCommand("copy");
  
  input.remove(); // Remove the <input> element from the DOM
};

function stopMaskScroll() {
  if (document.getElementById("rightmenu-mask")) {
    let xscroll = document.getElementById("rightmenu-mask");
    xscroll.addEventListener(
      "mousewheel",
      function (e) {
        //é˜»æ­¢æµè§ˆå™¨é»˜è®¤æ–¹æ³•
        rm.hideRightMenu();
        // e.preventDefault();
      },
      false
    );
  }
  if (document.getElementById("rightMenu")) {
    let xscroll = document.getElementById("rightMenu");
    xscroll.addEventListener(
      "mousewheel",
      function (e) {
        //é˜»æ­¢æµè§ˆå™¨é»˜è®¤æ–¹æ³•
        rm.hideRightMenu();
        // e.preventDefault();
      },
      false
    );
  }
}

rm.rightmenuCopyText = function (txt) {
  if (navigator.clipboard) {
    navigator.clipboard.writeText(txt);
  }
  rm.hideRightMenu();
};

rm.copyPageUrl = function () {
  var url = window.location.href;
  rm.copyUrl(url);
  anzhiyu.snackbarShow("å¤åˆ¶æœ¬é¡µé“¾æ¥åœ°å€æˆåŠŸ", false, 2000);
  rm.hideRightMenu();
};

rm.sharePage = function () {
  var content = window.location.href;
  rm.copyUrl(url);
  anzhiyu.snackbarShow("å¤åˆ¶æœ¬é¡µé“¾æ¥åœ°å€æˆåŠŸ", false, 2000);
  rm.hideRightMenu();
};

// å¤åˆ¶å½“å‰é€‰ä¸­æ–‡æœ¬
var selectTextNow = "";
document.onmouseup = document.ondblclick = selceText;

function selceText() {
  var txt;
  if (document.selection) {
    txt = document.selection.createRange().text;
  } else {
    txt = window.getSelection().toString();
  }
  selectTextNow = txt !== "" ? txt : "";
}

// è¯»å–å‰ªåˆ‡æ¿
rm.readClipboard = function () {
  if (navigator.clipboard) {
    navigator.clipboard.readText().then(clipText => rm.insertAtCaret(globalEvent.target, clipText));
  }
};

// ç²˜è´´æ–‡æœ¬åˆ°ç„¦ç‚¹
rm.insertAtCaret = function (elemt, value) {
  const startPos = elemt.selectionStart,
    endPos = elemt.selectionEnd;
  if (document.selection) {
    elemt.focus();
    var sel = document.selection.createRange();
    sel.text = value;
    elemt.focus();
  } else {
    if (startPos || startPos == "0") {
      var scrollTop = elemt.scrollTop;
      elemt.value = elemt.value.substring(0, startPos) + value + elemt.value.substring(endPos, elemt.value.length);
      elemt.focus();
      elemt.selectionStart = startPos + value.length;
      elemt.selectionEnd = startPos + value.length;
      elemt.scrollTop = scrollTop;
    } else {
      elemt.value += value;
      elemt.focus();
    }
  }
};

//ç²˜è´´æ–‡æœ¬
rm.pasteText = function () {
  const result = rm.readClipboard() || "";
  rm.hideRightMenu();
};

//å¼•ç”¨åˆ°è¯„è®º
rm.rightMenuCommentText = function (txt) {
  rm.hideRightMenu();
  const postCommentDom = document.getElementById("post-comment");
  var domTop = postCommentDom.offsetTop;
  window.scrollTo(0, domTop - 80);
  if (txt == "undefined" || txt == "null") txt = "å¥½æ£’ï¼";
  function setText() {
    setTimeout(() => {
      var input = document.getElementsByClassName("el-textarea__inner")[0];
      if (!input) setText();
      let evt = document.createEvent("HTMLEvents");
      evt.initEvent("input", true, true);
      let inputValue = replaceAll(txt, "\n", "\n> ");
      input.value = "> " + inputValue + "\n\n";
      input.dispatchEvent(evt);
      input.focus();
      input.setSelectionRange(-1, -1);
      if (document.getElementById("comment-tips")) {
        document.getElementById("comment-tips").classList.add("show");
      }
    }, 100);
  }
  setText();
};

//æ›¿æ¢æ‰€æœ‰å†…å®¹
function replaceAll(string, search, replace) {
  return string.split(search).join(replace);
}

// ç™¾åº¦æœç´¢
rm.searchBaidu = function () {
  anzhiyu.snackbarShow("å³å°†è·³è½¬åˆ°ç™¾åº¦æœç´¢", false, 2000);
  setTimeout(function () {
    window.open("https://www.baidu.com/s?wd=" + selectTextNow);
  }, "2000");
  rm.hideRightMenu();
};

//åˆ†äº«é“¾æ¥
rm.copyLink = function () {
  rm.rightmenuCopyText(domhref);
  anzhiyu.snackbarShow("å·²å¤åˆ¶é“¾æ¥åœ°å€");
};

function addRightMenuClickEvent() {
  // æ·»åŠ ç‚¹å‡»äº‹ä»¶
  document.getElementById("menu-backward").addEventListener("click", function () {
  window.history.back();
    rm.hideRightMenu();
  });

  document.getElementById("menu-forward").addEventListener("click", function () {
    window.history.forward();
    rm.hideRightMenu();
  });

  document.getElementById("menu-refresh").addEventListener("click", function () {
    window.location.reload();
  });

  document.getElementById("menu-top").addEventListener("click", function () {
    anzhiyu.scrollToDest(0, 500);
    rm.hideRightMenu();
  });

  const menuLinks = document.querySelectorAll(".menu-link");
  menuLinks.forEach(function (link) {
    link.addEventListener("click", rm.hideRightMenu);
  });

  document.getElementById("menu-darkmode").addEventListener("click", rm.switchDarkMode);

  document.getElementById("menu-home") && document.getElementById("menu-home").addEventListener("click", function () {
    window.location.href = window.location.origin;
  });

  document.getElementById("menu-randomPost").addEventListener("click", function () {
    toRandomPost();
  });

  document.getElementById("menu-commentBarrage").addEventListener("click", anzhiyu.switchCommentBarrage);

  document.getElementById("rightmenu-mask").addEventListener("click", rm.hideRightMenu);

  document.getElementById("rightmenu-mask").addEventListener("contextmenu", function (event) {
    rm.hideRightMenu();
    event.preventDefault(); // Prevent the default context menu from appearing
  });

  document.getElementById("menu-copy").addEventListener("click", rm.copyPageUrl);

  document.getElementById("menu-pastetext").addEventListener("click", rm.pasteText);

  document.getElementById("menu-copytext").addEventListener("click", function () {
    rm.rightmenuCopyText(selectTextNow);
    anzhiyu.snackbarShow("å¤åˆ¶æˆåŠŸï¼Œå¤åˆ¶å’Œè½¬è½½è¯·æ ‡æ³¨æœ¬æ–‡åœ°å€");
  });

  document.getElementById("menu-commenttext").addEventListener("click", function () {
    rm.rightMenuCommentText(selectTextNow);
  });

  document.getElementById("menu-newwindow").addEventListener("click", function () {
    window.open(domhref);
    rm.hideRightMenu();
  });

  document.getElementById("menu-copylink").addEventListener("click", rm.copyLink);

  document.getElementById("menu-downloadimg").addEventListener("click", function () {
    anzhiyu.downloadImage(domImgSrc, "anzhiyu");
  });

  document.getElementById("menu-newwindowimg").addEventListener("click", function () {
    window.open(domImgSrc);
    rm.hideRightMenu();
  });

  document.getElementById("menu-copyimg").addEventListener("click", function () {
    rm.writeClipImg(domImgSrc);
  });

  document.getElementById("menu-searchBaidu").addEventListener("click", rm.searchBaidu);

  //éŸ³ä¹
  document.getElementById("menu-music-toggle").addEventListener("click", anzhiyu.musicToggle);

  document.getElementById("menu-music-back").addEventListener("click", anzhiyu.musicSkipBack);

  document.getElementById("menu-music-forward").addEventListener("click", anzhiyu.musicSkipForward);

  document.getElementById("menu-music-copyMusicName").addEventListener("click", function () {
    rm.rightmenuCopyText(anzhiyu.musicGetName());
    anzhiyu.snackbarShow("å¤åˆ¶æ­Œæ›²åç§°æˆåŠŸ", false, 3000);
  });

}

addRightMenuClickEvent();</script><script data-pjax>var themeColorMeta = document.querySelector('meta[name="theme-color"]');
var pageHeaderEl = document.getElementById("page-header");
var navMusicEl = document.getElementById("nav-music");
var consoleEl = document.getElementById("console");
// å·²éšæœºçš„æ­Œæ›²
var selectRandomSong = [];
// éŸ³ä¹é»˜è®¤å£°éŸ³å¤§å°
var musicVolume = 0.8;
// æ˜¯å¦åˆ‡æ¢äº†å‘¨æ°ä¼¦éŸ³ä¹åˆ—è¡¨
var changeMusicListFlag = false;
// å½“å‰é»˜è®¤æ’­æ”¾åˆ—è¡¨
var defaultPlayMusicList = [];

document.getElementById("page-name").innerText = document.title.split(" | å®‰çŸ¥é±¼")[0];
anzhiyu.initIndexEssay();
anzhiyu.changeTimeInEssay();
anzhiyu.removeBodyPaceClass();
anzhiyu.qrcodeCreate();
anzhiyu.changeTimeInAlbumDetail();
anzhiyu.reflashEssayWaterFall();
anzhiyu.sayhi();
anzhiyu.stopImgRightDrag();
anzhiyu.addNavBackgroundInit();
anzhiyu.setValueToBodyType();

anzhiyu.getCustomPlayList();
anzhiyu.addEventListenerConsoleMusicList(false);</script><link rel="stylesheet" href="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.6/icon/ali_iconfont_css.css"><link rel="stylesheet" href="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/aplayer/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://npm.elemecdn.com/anzhiyu-blog-static@1.0.1/js/APlayer.min.js"></script><script src="https://npm.elemecdn.com/hexo-anzhiyu-music@1.0.1/assets/js/Meting2.min.js"></script><script src="https://npm.elemecdn.com/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["meta[property=\"og:image\"]","meta[property=\"og:title\"]","meta[property=\"og:url\"]","meta[property=\"og:type\"]","meta[property=\"og:site_name\"]","meta[property=\"og:description\"]","head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {
  // removeEventListener scroll 
  window.tocScrollFn && window.removeEventListener('scroll', window.tocScrollFn)
  window.scrollCollect && window.removeEventListener('scroll', scrollCollect)
  window.anzhiyuScrollFnToDo && window.removeEventListener('scroll', anzhiyuScrollFnToDo)

  document.getElementById('rightside').style.cssText = "opacity: ''; transform: ''"
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', (e) => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>